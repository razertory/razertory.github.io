---
layout: post
title:  "Paxos & Raft 以及我对技术的理解"
date:   2018-05-25 +0800
categories: jekyll update
---

# 前文

最近这段时间，阅读了很多关于这两个分布式协议的文章，包括最初的论文在内，多多少少对于设计一个拥有容错能力的分布式系统产生了比较大的兴趣。虽然在理解Paxos的时候自己也想了很多，在看到Raft协议之后自己又
打算回过头看之前做的数据库主从配置，曾经公司用了kafka做数据实时同步。总的来说，现在我想把这一类的东西称之为 --

## 协议
回过头看最熟悉的网络协议，为了让传输可靠，或者高效，或者安全，或者都兼顾。那么，实际上分布式协议，也就是为了满足在多副本，一致性，容错这三个场景下而设计出的。写这篇文章，最核心的一个想法是

> `How to design a protocol?`

拿到 `Paxos Made Simple`这个论文之前我就已经在很多地方看过相关的介绍和分析。不过为了有更好的理解，我还是愿意花足够的时间去研读源作者的论文，希望以此探究如何设计协议。

技术的学习，我觉得可以分成三层次：应用层、数学层、哲学层。

#### 应用层
一直觉得，技术本身就是为了业务而存在的。虽然一些脱离业务产生的技术在被有商业头脑的人拿去运作了之后，变得炙手可热（比如美剧《硅谷》中的那个压缩算法）。但我觉得，对于互联网人而言，满足需求，解决实际问题一直都是主流，这也是我们绝大多数人每天的工作。所以，paxos和raft本身就是为了解决某个场景 -- 分布式一致性需求而产生的。满足应用层的需求，解决实际的问题。

#### 数学层
原本在分层的时候，我打算用*算法层*来表现，但是发现，实际上算法层就是介于数学层和应用层之间的。为了解决某个实际问题想到了某种做法，进而抽象成算法。这个抽象好的算法需要被证明准确，需要被认可性能，所以数学的研究成为了算法的基础。用朴素一点的语句说就是*理论与实践结合*。


> 数学是利用符号语言研究数量、结构、变化以及空间等概念的一门学科，从某种角度看属于形式科学的一种。数学透过抽象化和逻辑推理的使用，由计数、计算、量度和对物体形状及运动的观察而产生。数学家们拓展这些概念，为了公式化新的猜想以及从选定的公理及定义中建立起严谨推导出的定理（[维基百科](https://zh.wikipedia.org/wiki/%E6%95%B0%E5%AD%A6)）。

#### 哲学层
最近这两年，有个叫做*Go*的编程语言在国内大热，很多大厂独角兽创业公司或多或少都用了这一门技术。而其中，go的设计哲学显得画龙点睛。虽然哲学层次过于抽象和晦涩，甚至其中没有逻辑可言。但不得不承认，具有领域突破意义的事物总会有哲学作为压轴。比方说国代的的八卦易经到后现代的量子力学，小到一段代码的编写，大到某个分布式系统的设计实现，学很多东西，只有当到达了哲学层的时候，才算是登堂入室了。

### 解决问题的应用层

先来两个游戏

### 『数学毁灭教』

包括你在内的一群计算机科学家被一帮邪恶的『数学毁灭教』的教徒们抓住了，各自分开关押，人数未知...[原地址](https://zhuanlan.zhihu.com/p/21250200)

### 『100灯泡』
说有 100 个囚犯分别关在 100 间牢房里。牢房外有一个空荡荡的房间，房间里有一个由开关控制的灯泡。初始时，灯是关着的。看守每次随便选择一名囚犯进入房间，但保证每个囚犯都会被选中无穷多次。如果在某一时刻，有囚犯成功断定出所有人都进过这个房间了，所有囚犯都能释放。游戏开始前，所有囚犯可以聚在一起商量对策，但在此之后它们唯一可用来交流的工具就只有那个灯泡。他们应该设计一个怎样的协议呢？...[原地址](http://www.matrix67.com/blog/archives/3618)


这两个题目难度不小而且最后的答案耐人寻味，很多人会想到不同的方式方法来解答。当然，这两道题最后能不能被解答并不影响后面的阅读，这里是为了给出设计分布式系统研究分布式算法所需要的一些场景。有了这些场景，即使编码经验不够，也能继续弄清楚后面的。

# 正文

## CAP理论回顾和强化

## Paxos的推导过程

## Raft的实质讲解
