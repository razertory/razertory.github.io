<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Razertory çš„æŠ€æœ¯åšå®¢</title>
  
  <subtitle>ä¸€æ›²è‚è‚ æ–­ï¼Œå¤©æ¶¯ä½•å¤„è§…çŸ¥éŸ³</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://razertory.me/"/>
  <updated>2020-04-18T08:54:30.936Z</updated>
  <id>https://razertory.me/</id>
  
  <author>
    <name>Razertory</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€ŒLinux å†…æ ¸ã€ç³»ç»Ÿè°ƒç”¨</title>
    <link href="https://razertory.me/2020/04/12/linux-kernel-system-call/"/>
    <id>https://razertory.me/2020/04/12/linux-kernel-system-call/</id>
    <published>2020-04-12T05:50:04.000Z</published>
    <updated>2020-04-18T08:54:30.936Z</updated>
    
    <content type="html"><![CDATA[<p>å†…æ ¸å†…å­˜ç©ºé—´åœ¨æ“ä½œç³»ç»Ÿä¸­æ˜¯å—ä¿æŠ¤çš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ™®é€šç¨‹åºæ‰§è¡Œåœ¨ç”¨æˆ·ç©ºé—´ã€‚å½“éœ€è¦ä¸å†…æ ¸é€šä¿¡çš„æ—¶å€™ï¼Œæ¯”å¦‚å†™æ–‡ä»¶åˆ°ç£ç›˜ï¼Œå°±éœ€è¦è¿›è¡Œ<strong>ç³»ç»Ÿè°ƒç”¨</strong>ã€‚</p><p>æœ‰è¶£çš„æ˜¯ï¼Œå†…æ ¸åŸç”Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨å¾ˆå°‘(å‚è€ƒ<a href="http://asm.sourceforge.net/syscall.html" target="_blank" rel="noopener">List of Linux/i386 system calls</a>)ã€‚å½“æˆ‘ä»¬éœ€è¦ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åœ¨è°ƒç”¨è°ƒç”¨çš„ä¸Šä¸€å±‚ APIã€‚è¿™ä¸€å±‚ API å°è£…äº†å„ç§ç³»ç»Ÿè°ƒç”¨ï¼ˆé€šå¸¸å°±æ˜¯æ“ä½œç³»ç»Ÿå†…ç½®çš„ C åº“ï¼‰ã€‚ç°é˜¶æ®µï¼Œè¿™ä¸€å±‚ API çš„æ ‡å‡†æ¥è‡ªäº IEEE ï¼Œåä¸º POSIXï¼ˆPortable Operating System Interfaceï¼‰ã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯ unix å€¡å¯¼çš„ <em>æä¾›æœºåˆ¶ï¼Œè€Œä¸æ˜¯æä¾›ç­–ç•¥</em>ã€‚æ„æ€æ˜¯æä¾›æœ‰é™çš„ï¼Œä½†å¯ä»¥å¾ˆå¥½ç»„åˆçš„å·¥å…·ã€æ–¹æ³•ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå®ç°å„ç§åŠŸèƒ½ã€‚</p><p>ä¾‹å¦‚ï¼Œ</p><p><code>get_pid()</code> åœ¨å†…æ ¸ä¸­çš„è¢«å®šä¹‰ä¸º <code>sys_getpid()</code><br><code>bar()</code> åœ¨å†…æ ¸ä¸­è¢«å®šä¹‰ä¸º <code>sys_bar()</code></p><p>ä¸€ä¸ªç”¨æˆ·ç©ºé—´çš„ç¨‹åºï¼Œè¦åšç³»ç»Ÿè°ƒç”¨ï¼Œå…·ä½“çš„è¿‡ç¨‹ä¸º</p><ul><li>é™·å…¥å†…æ ¸</li><li>ä¼ é€’ç³»ç»Ÿè°ƒç”¨ç¼–å·å’Œå‚æ•°</li><li>æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</li><li>å°†ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼å¸¦ç»™ç”¨æˆ·ç©ºé—´</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å†…æ ¸å†…å­˜ç©ºé—´åœ¨æ“ä½œç³»ç»Ÿä¸­æ˜¯å—ä¿æŠ¤çš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ™®é€šç¨‹åºæ‰§è¡Œåœ¨ç”¨æˆ·ç©ºé—´ã€‚å½“éœ€è¦ä¸å†…æ ¸é€šä¿¡çš„æ—¶å€™ï¼Œæ¯”å¦‚å†™æ–‡ä»¶åˆ°ç£ç›˜ï¼Œå°±éœ€è¦è¿›è¡Œ&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰è¶£çš„æ˜¯ï¼Œå†…æ ¸åŸç”Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨å¾ˆå°‘(å‚è€ƒ&lt;a href=&quot;http://asm.so
      
    
    </summary>
    
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="https://razertory.me/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒLinux å†…æ ¸ã€ä¸­æ–­</title>
    <link href="https://razertory.me/2020/04/12/linux-kernel-interrupt/"/>
    <id>https://razertory.me/2020/04/12/linux-kernel-interrupt/</id>
    <published>2020-04-12T05:50:04.000Z</published>
    <updated>2020-04-19T14:28:18.526Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸­æ–­ä¿¡å·"><a href="#ä¸­æ–­ä¿¡å·" class="headerlink" title="ä¸­æ–­ä¿¡å·"></a>ä¸­æ–­ä¿¡å·</h3><p>ä¸­æ–­æœºåˆ¶ï¼Œç®€å•è¯´å°±æ˜¯é”®ç›˜ã€é¼ æ ‡ã€ç£ç›˜ä¹‹ç±»çš„ç¡¬ä»¶ï¼Œåœ¨éœ€è¦çš„æ—¶å€™å‘å†…æ ¸å‘ä¿¡å·çš„ä¸€ç§æœºåˆ¶ã€‚æ¯”å¦‚æˆ‘æ­¤åˆ»æ­£åœ¨ç”¨é”®ç›˜æ‰“å­—ï¼Œå…¶å®å°±æ˜¯åœ¨å‘å‡ºç”µä¿¡å·ç»™ä¸€ä¸ªåå«ã€Œä¸­æ–­æ§åˆ¶å™¨ã€çš„ç‰©ç†èŠ¯ç‰‡ä¸­ï¼Œå†é€šè¿‡ä¸€ä¸ªå’Œå¤„ç†å™¨ç›´è¿çš„ç®¡çº¿ç»™å¤„ç†å™¨ã€‚å¤„ç†å™¨æ¥æ”¶åˆ°ä¹‹åï¼Œç›‘æµ‹åˆ°äº†æ˜¯ä¸­æ–­ä¿¡å·ï¼Œå°±ä¼šä¸­æ–­å½“å‰çš„å·¥ä½œå¤„ç†è¯¥ä¿¡å·è¿›è€Œå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œè®©æ“ä½œç³»ç»Ÿå¤„ç†è¿™ä¸ªä¿¡å·ã€‚ä¸åŒçš„ä¸­æ–­ä¿¡å·ï¼Œæœ‰çš„ç€å”¯ä¸€çš„ IRQ ç¼–å·ã€‚æ¯”å¦‚æ—¶é’Ÿ IRQ 0ï¼Œé”®ç›˜ IRQ 1ï¼Œæœ‰çš„æ˜¯åŠ¨æ€åˆ†é…çš„ï¼Œæ¯”å¦‚åœ¨ PCI æ€»çº¿ä¸Šçš„è®¾å¤‡ã€‚</p><h3 id="ä¸­æ–­å¤„ç†"><a href="#ä¸­æ–­å¤„ç†" class="headerlink" title="ä¸­æ–­å¤„ç†"></a>ä¸­æ–­å¤„ç†</h3><p>æ“ä½œç³»ç»Ÿå¤„ç†ä¸­æ–­çš„è¿‡ç¨‹ä¸€èˆ¬åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œå‘½åä¸ºã€Œä¸ŠåŠéƒ¨ï¼ˆtop halfï¼‰ã€å’Œã€Œä¸‹åŠéƒ¨ï¼ˆbottom halfï¼‰ã€ã€‚ä¸€èˆ¬ä¸ŠåŠéƒ¨(ä¸­æ–­å¤„ç†ç¨‹åº)æœ‰ä¸¥æ ¼æ—¶é™çš„æ“ä½œï¼Œæ¯”æ–¹è¯´å¿«é€Ÿåº”ç­”ã€‚è€Œæœ‰çš„å¯ä»¥å»¶åæ‰§è¡Œçš„æ“ä½œå°±äº¤ç»™äº†ä¸‹åŠéƒ¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ“ä½œç³»ç»Ÿå¤„ç†ç½‘å¡æ•°æ®åŒ…çš„æ—¶å€™ï¼Œä¼šåœ¨ä¸ŠåŠéƒ¨æŠŠç½‘ç»œæ•°æ®æ‹·è´åˆ°å†…å­˜ï¼Œä¸‹åŠéƒ¨åšæ•°æ®å¤„ç†çš„æ“ä½œã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fly1gdzeyef51dj217m0kmq9a.jpg" alt="image.png" title>                </div>                <div class="image-caption">image.png</div>            </figure><h3 id="ä¸‹åŠéƒ¨"><a href="#ä¸‹åŠéƒ¨" class="headerlink" title="ä¸‹åŠéƒ¨"></a>ä¸‹åŠéƒ¨</h3><p><strong>æ—¶é—´æ•æ„Ÿ</strong>ï¼Œ<strong>ç¡¬ä»¶ç›¸å…³</strong>æˆ–è€…<strong>ä¿è¯ä¸èƒ½ä¸­æ–­</strong>çš„ä»»åŠ¡ï¼Œé€šå¸¸ä¸€å®šæ˜¯åœ¨ä¸ŠåŠéƒ¨ï¼Œå¦åˆ™éƒ½åœ¨ä¸‹åŠéƒ¨ã€‚ä¸‹åŠéƒ¨çš„å®ç°æœºåˆ¶ï¼Œåœ¨ linux å†…æ ¸å‘å±•ä¸­ç»å†äº†å‡ ä¸ªç‰ˆæœ¬ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fly1gdzfdr63ytj212s0ak428.jpg" alt="tasklet åŸºäºè½¯ä¸­æ–­å®ç°" title>                </div>                <div class="image-caption">tasklet åŸºäºè½¯ä¸­æ–­å®ç°</div>            </figure><p>è½¯ä¸­æ–­æ˜¯ç¼–è¯‘æœŸé—´åˆ†é…çš„ï¼Œç”± softirq_action è¡¨ç¤ºã€‚å®šä¹‰åœ¨ <a href="https://github.com/torvalds/linux/blob/master/include/linux/interrupt.h" target="_blank" rel="noopener">linux/interrupt.h</a>ã€‚</p><p><a href="https://github.com/torvalds/linux/blob/master/kernel/softirq.c" target="_blank" rel="noopener">kernel/softirq.c</a> é‡Œé¢å®šä¹‰äº†ä¸€ä¸ªåŒ…å« 32 ä¸ªç»“æ„ä½“çš„æ•°ç»„ã€‚æ¯ä¸ªç»“æ„ä½“è¡¨ç¤ºä¸€ä¸ªè½¯ä¸­æ–­ï¼Œå› æ­¤è½¯ä¸­æ–­æœ€å¤šæœ‰ 32 ä¸ªã€‚ä¸è¿‡ç›®å‰è¿™ç”¨åˆ°äº† 9 ä¸ªã€‚å½“è½¯ä¸­æ–­å¼€å§‹å·¥ä½œçš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªåå« <code>void softirq_handler(struct softirq_action *)</code> çš„å‡½æ•°å»æ ‡è®°æ³¨å·²ç»å†Œçš„è½¯ä¸­æ–­ã€‚</p><p>ç­‰åˆ°åˆé€‚çš„æ—¶å€™ï¼Œè¯¥è½¯ä¸­æ–­å°±ä¼šæ‰§è¡Œï¼Œæ¯”å¦‚</p><ul><li>ä»ç¡¬ä»¶ä¸­æ–­ä»£ç è¿”å›çš„æ—¶å€™  </li><li>åœ¨ ksoftirqd å†…æ ¸çº¿ç¨‹ä¸­</li><li>åœ¨ä¸€äº›æ˜¾å¼æ‰§è¡Œã€æ˜¾å¼æ£€æŸ¥è½¯ä¸­æ–­çš„ç¨‹åºä¸­ï¼Œæ¯”å¦‚ç½‘ç»œç³»ç»Ÿä¸­</li></ul><p>tasklet æºè‡ªè½¯ä¸­æ–­ï¼Œæä¾›äº†åŠ¨æ€åˆ†é…çš„ç‰¹æ€§ï¼Œæœ‰ç€æ›´å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ä¸­æ–­ä¿¡å·&quot;&gt;&lt;a href=&quot;#ä¸­æ–­ä¿¡å·&quot; class=&quot;headerlink&quot; title=&quot;ä¸­æ–­ä¿¡å·&quot;&gt;&lt;/a&gt;ä¸­æ–­ä¿¡å·&lt;/h3&gt;&lt;p&gt;ä¸­æ–­æœºåˆ¶ï¼Œç®€å•è¯´å°±æ˜¯é”®ç›˜ã€é¼ æ ‡ã€ç£ç›˜ä¹‹ç±»çš„ç¡¬ä»¶ï¼Œåœ¨éœ€è¦çš„æ—¶å€™å‘å†…æ ¸å‘ä¿¡å·çš„ä¸€ç§æœºåˆ¶ã€‚æ¯”å¦‚æˆ‘æ­¤åˆ»æ­£åœ¨ç”¨é”®ç›˜æ‰“å­—ï¼Œå…¶å®å°±æ˜¯åœ¨å‘å‡º
      
    
    </summary>
    
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="https://razertory.me/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒLinux å†…æ ¸ã€è¿›ç¨‹ç®¡ç†</title>
    <link href="https://razertory.me/2020/04/11/linux-kernel-process/"/>
    <id>https://razertory.me/2020/04/11/linux-kernel-process/</id>
    <published>2020-04-11T10:15:42.000Z</published>
    <updated>2020-04-11T11:54:05.665Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h4><p>è¿›ç¨‹æ˜¯å¤„äºæ‰§è¡ŒæœŸçš„ç¨‹åºä»¥åŠç›¸å…³èµ„æºçš„æ€»ç§°ã€‚æ¯”å¦‚æ‰“å¼€çš„æ–‡ä»¶ã€æŒ‚èµ·çš„ä¿¡å·ã€å†…æ ¸å†…éƒ¨æ•°æ®ç­‰ç­‰ã€‚åœ¨ linux æºç ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ç»´æŠ¤åœ¨ task_struct <a href="https://github.com/torvalds/linux/blob/master/include/linux/sched.h#L632" target="_blank" rel="noopener">task_struct</a>çš„ç»“æ„ä½“ä¸­ã€‚è¿™é‡Œé¢åŒ…å«äº†è¿›ç¨‹çš„çŠ¶æ€(pidï¼Œè¿è¡ŒçŠ¶æ€)ã€ç›¸å…³èµ„æºã€ä»¥åŠç›¸å…³è¿›ç¨‹ï¼ˆå­è¿›ç¨‹ã€çˆ¶è¿›ç¨‹ï¼‰ä¿¡æ¯ã€‚å†…æ ¸ä¼šç»´æŠ¤ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹æŒ‡å‘å¯¹åº”çš„ task_structã€‚</p><h4 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h4><ul><li>TASK_RUNNING: å¯æ‰§è¡Œçš„ï¼›ç­‰å¾…æ‰§è¡Œçš„</li><li>TASK_INTERRUPTIBLE: å¯ä¸­æ–­çš„; æ¯”å¦‚è¢«é˜»å¡ã€æˆ–è€…åœ¨ sleep</li><li>TASK_UNINTERRUPTIBLE: ä¸å¯ä¸­æ–­çš„; å¯¹å¤–ç•Œçš„ä¿¡å·ä¸åšå‡ºå“åº”</li><li>EXIT_ZOMBIE: ä¸»åŠ¨é€€å‡ºï¼›è¿˜æ²¡æœ‰å®Œå…¨é‡Šæ”¾èµ„æº</li></ul><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fgy1gdq0dnlo0cg20fw09b0sw.gif" alt="è¿›ç¨‹çŠ¶æ€å›¾" title>                </div>                <div class="image-caption">è¿›ç¨‹çŠ¶æ€å›¾</div>            </figure><h4 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h4><p>åœ¨è¿›ç¨‹è¢« fork å‡ºæ¥ä¹‹å task_struct ä¼šæœ‰è‡ªå·±çš„ pid å’Œçˆ¶è¿›ç¨‹çš„ pidã€‚ä½†ä¸€äº›å¿…è¦çš„ç³»ç»Ÿèµ„æºå¹¶ä¸ä¼šæ‹·è´è¿‡æ¥ï¼Œè€Œæ˜¯å½“éœ€è¦å†™å…¥çš„æ—¶å€™å†åš(copy-on-write)ã€‚è¿›ç¨‹è°ƒç”¨ exit() ç»“æŸ, éƒ¨åˆ†èµ„æºä¼šé‡Šæ”¾ï¼ŒåŒæ—¶è°ƒç”¨ exit_notify() å‘çˆ¶è¿›ç¨‹å‘ä¿¡å·ã€‚è‹¥çˆ¶è¿›ç¨‹åŠæ—¶å“åº”ï¼Œæ­¤æ—¶é‡Šæ”¾æ‰€æœ‰çš„èµ„æºï¼›å¦åˆ™è®¤ä¸ºæ­¤æ—¶çš„è¿™ä¸ªè¿›ç¨‹æ˜¯åƒµå°¸è¿›ç¨‹ã€‚åŒç†ï¼Œå¦‚æœçˆ¶è¿›ç¨‹å…ˆäºå­è¿›ç¨‹é€€å‡ºï¼Œå­è¿›ç¨‹å°±ä¼šæˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å†…æ ¸ä¼šå°†è¿™ç±»è¿›ç¨‹å½’ç»™ pid ä¸º 1 çš„è¿›ç¨‹ã€‚</p><h4 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h4><p>çº¿ç¨‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ï¼ˆå¼ºè°ƒåªæ˜¯ linuxï¼‰åŒä¸€ä¸ªè¿›ç¨‹çš„ N ä¸ªçº¿ç¨‹åªæ˜¯ N ä¸ªå…±äº«åŒä¸€å—èµ„æºçš„<br>task_structã€‚æ¯”å¦‚è¿›ç¨‹åˆ›å»ºçš„æ—¶å€™ä¼šä¾èµ– clone æ–¹æ³•</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clone(SIGCHLD, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>è€Œçº¿ç¨‹çš„åˆ›å»ºå°±æ˜¯ä¼ é€’æ¥ä¸€äº›å‚æ•°æ¥æŒ‡æ˜è¢«å…±äº«çš„èµ„æºï¼Œè¿™ä¸ªè®¾è®¡ç°åœ¨çœ‹èµ·æ¥ä¹Ÿæ˜¯éå¸¸ä¼˜é›…çš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clone(CLONE_VM | CLONE_FS | CLONE_FILES | CLONE_SIGHAND, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;æ¦‚è§ˆ&quot;&gt;&lt;a href=&quot;#æ¦‚è§ˆ&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è§ˆ&quot;&gt;&lt;/a&gt;æ¦‚è§ˆ&lt;/h4&gt;&lt;p&gt;è¿›ç¨‹æ˜¯å¤„äºæ‰§è¡ŒæœŸçš„ç¨‹åºä»¥åŠç›¸å…³èµ„æºçš„æ€»ç§°ã€‚æ¯”å¦‚æ‰“å¼€çš„æ–‡ä»¶ã€æŒ‚èµ·çš„ä¿¡å·ã€å†…æ ¸å†…éƒ¨æ•°æ®ç­‰ç­‰ã€‚åœ¨ linux æºç ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ç»´æŠ¤åœ¨ t
      
    
    </summary>
    
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="https://razertory.me/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Scala å‡½æ•°å¼ç¼–ç¨‹è®¾è®¡</title>
    <link href="https://razertory.me/2020/02/20/functional-program-design-in-scala/"/>
    <id>https://razertory.me/2020/02/20/functional-program-design-in-scala/</id>
    <published>2020-02-20T15:53:05.000Z</published>
    <updated>2020-03-28T13:02:10.018Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è¿™ä¸ª 2020 å¹´åˆçš„ç‰¹æ®Šæ—¶æœŸã€‚</p><p>Scala æ˜¯ä¸€é—¨ç°ä»£åŒ–ï¼Œå¤šèŒƒå¼çš„ JVM è¯­è¨€ã€‚</p><p>ä¼ é€é—¨ï¼ˆå¯èƒ½éœ€è¦ğŸš€)</p><ul><li><a href="https://www.coursera.org/learn/progfun2" target="_blank" rel="noopener">Functional Program Design in Scala on Coursera</a></li><li><a href="https://www.coursera.org/account/accomplishments/certificate/BP5FRUVSFPN8" target="_blank" rel="noopener">æ²¡ä»€ä¹ˆç”¨çš„ certificate</a></li></ul><hr><h2 id="W1"><a href="#W1" class="headerlink" title="W1"></a>W1</h2><h3 id="case-class-å’Œæ¨¡å¼åŒ¹é…"><a href="#case-class-å’Œæ¨¡å¼åŒ¹é…" class="headerlink" title="case class å’Œæ¨¡å¼åŒ¹é…"></a>case class å’Œæ¨¡å¼åŒ¹é…</h3><p>ç”¨ Scala æ¥è¡¨ç¤º JSON å¯¹è±¡å¯ä»¥è¿™æ ·</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">JSON</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">class</span> <span class="title">JSeq</span> (<span class="params">elems: <span class="type">List</span>[<span class="type">JSON</span>]</span>) <span class="keyword">extends</span> <span class="title">JSON</span>  <span class="title">//</span> <span class="title">JSON</span> <span class="title">çš„æ•°ç»„</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">class</span> <span class="title">JObj</span> (<span class="params">bindings: <span class="type">Map</span>[<span class="type">String</span>, <span class="type">JSON</span>]</span>) <span class="keyword">extends</span> <span class="title">JSON</span> <span class="title">//</span> <span class="title">JSON</span> <span class="title">å¯¹è±¡</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">class</span> <span class="title">JNum</span> (<span class="params">num: <span class="type">Double</span></span>) <span class="keyword">extends</span> <span class="title">JSON</span> <span class="title">//</span> <span class="title">æ•°å­—ç±»å‹</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">class</span> <span class="title">JStr</span> (<span class="params">str: <span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">JSON</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">class</span> <span class="title">JBool</span>(<span class="params">b: <span class="type">Boolean</span></span>) <span class="keyword">extends</span> <span class="title">JSON</span></span></span><br><span class="line"><span class="class"><span class="title">case</span> <span class="title">object</span> <span class="title">JNull</span> <span class="keyword">extends</span> <span class="title">JSON</span> <span class="title">//</span> <span class="title">ç©º</span></span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"firstName"</span> : <span class="string">"John"</span>,</span><br><span class="line">    <span class="attr">"lastName"</span> : <span class="string">"Smith"</span>,</span><br><span class="line">    <span class="attr">"address"</span> : &#123;</span><br><span class="line">        <span class="attr">"streetAddress"</span> : <span class="string">"21 2 nd Street"</span>,</span><br><span class="line">        <span class="attr">"state"</span> : <span class="string">"NY"</span>,</span><br><span class="line">        <span class="attr">"postalCode"</span>: <span class="number">10021</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"phoneNumbers"</span>: [</span><br><span class="line">        &#123;<span class="attr">"type"</span> : <span class="string">"home"</span>,<span class="attr">"number "</span>: <span class="string">"212 555 -1234"</span>&#125; ,</span><br><span class="line">        &#123;<span class="attr">"type"</span> : <span class="string">"fax"</span>,<span class="attr">"number "</span>: <span class="string">"646 555 -4567"</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¡¨ç¤ºä¸º</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> data = <span class="type">JObj</span>(<span class="type">Map</span>(</span><br><span class="line">    <span class="string">"firstName"</span> -&gt; <span class="type">JStr</span>(<span class="string">"John"</span>),</span><br><span class="line">    <span class="string">"lastName"</span> -&gt; <span class="type">JStr</span>(<span class="string">"Smith"</span>),</span><br><span class="line">    <span class="string">"address"</span> -&gt; <span class="type">JObj</span>(<span class="type">Map</span>(</span><br><span class="line">    <span class="string">"streetAddress"</span> -&gt; <span class="type">JStr</span>(<span class="string">"21 2nd Street"</span>),</span><br><span class="line">    <span class="string">"state"</span> -&gt; <span class="type">JStr</span>(<span class="string">"NY"</span>),</span><br><span class="line">    <span class="string">"postalCode"</span> -&gt; <span class="type">JNum</span>(<span class="number">10021</span>)</span><br><span class="line">)),</span><br><span class="line"><span class="string">"phoneNumbers"</span> -&gt; <span class="type">JSeq</span>(<span class="type">List</span>(</span><br><span class="line">    <span class="type">JObj</span>(<span class="type">Map</span>(</span><br><span class="line">    <span class="string">"type"</span> -&gt; <span class="type">JStr</span>(<span class="string">"home"</span>), <span class="string">"number"</span> -&gt; <span class="type">JStr</span>(<span class="string">"212 555-1234"</span>)</span><br><span class="line">)),</span><br><span class="line"><span class="type">JObj</span>(<span class="type">Map</span>(</span><br><span class="line">    <span class="string">"type"</span> -&gt; <span class="type">JStr</span>(<span class="string">"fax"</span>), <span class="string">"number"</span> -&gt; <span class="type">JStr</span>(<span class="string">"646 555-4567"</span>)</span><br><span class="line">)) )) ))</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚è¯´æˆ‘è¦å®ç°ä¸€ä¸ªæ‰“å° JSON å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±å¯ä»¥</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span></span>(json: <span class="type">JSON</span>): <span class="type">String</span> = json <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">JSeq</span>(elems) =&gt;</span><br><span class="line">    <span class="string">"["</span> + (elems map show mkString <span class="string">", "</span>) + <span class="string">"]"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">JObj</span>(bindings) =&gt;</span><br><span class="line">    <span class="keyword">val</span> assocs = bindings map &#123;</span><br><span class="line">        <span class="keyword">case</span> (key, value) =&gt; <span class="string">"\""</span> + key + <span class="string">"\": "</span> + show(value)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">"&#123;"</span> + (assocs mkString <span class="string">", "</span>) + <span class="string">"&#125;"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">JNum</span>(num) =&gt; num.toString</span><br><span class="line">    <span class="keyword">case</span> <span class="type">JStr</span>(str) =&gt; '\<span class="string">"' + str + '\"'</span></span><br><span class="line"><span class="string">    case JBool(b) =&gt; b.toString</span></span><br><span class="line"><span class="string">    case JNull =&gt; "</span><span class="string">null"</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°çš„ show(data) å°±è¾“å‡º</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res1: <span class="type">String</span> = &#123;<span class="string">"firstName"</span>: <span class="string">"John"</span>, <span class="string">"lastName"</span>: <span class="string">"Smith"</span>, <span class="string">"address"</span>: &#123;<span class="string">"streetAddress"</span>: <span class="string">"21 2nd Street"</span>, <span class="string">"state"</span>: <span class="string">"NY"</span>, <span class="string">"postalCode"</span>: <span class="number">10021.0</span>&#125;, <span class="string">"phoneNumbers"</span>: [&#123;<span class="string">"type"</span>: <span class="string">"home"</span>, <span class="string">"number"</span>: <span class="string">"212 555-1234"</span>&#125;, &#123;<span class="string">"type"</span>: <span class="string">"fax"</span>, <span class="string">"number"</span>: <span class="string">"646 555-4567"</span>&#125;]&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ 6 è¡Œä»£ç é‡Œé¢ map ä¼ å…¥çš„å‡½æ•°æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨è¿™é‡Œ map å‡½æ•°çš„ç­¾åæ˜¯ <code>def map[B](f: (A) =&gt; B): List[B]</code><br>é‚£ä¹ˆç¬¬å…­è¡Œçš„ <code>f</code> å°±æ˜¯ <code>case (key, value) =&gt; &quot;\&quot;&quot; + key + &quot;\&quot;: &quot; + show(value)</code>ã€‚ è¿™ä¸ªå‡½æ•°å¦‚æœå•ç‹¬æ‹å‡ºæ¥ï¼Œå…¶å®å°±æ˜¯</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> f: (<span class="type">String</span>, <span class="type">JSON</span>) =&gt; <span class="type">String</span> = &#123; <span class="keyword">case</span> (key, value) =&gt; key + â€: â€ + value &#125; <span class="comment">// æ³¨æ„çœ‹ JObj å®šä¹‰</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ç”¨ case class æœ€æ–¹ä¾¿çš„åœ°æ–¹åœ¨äº<strong>æ¨¡å¼åŒ¹é…ä¸­çš„ decompose</strong></p><h3 id="å‡½æ•°å³å¯¹è±¡"><a href="#å‡½æ•°å³å¯¹è±¡" class="headerlink" title="å‡½æ•°å³å¯¹è±¡"></a>å‡½æ•°å³å¯¹è±¡</h3><p>ä»»ä½•æƒ…å†µä¸‹ï¼Œå‡½æ•° <code>A =&gt; B</code> å…¶å®å°±æ˜¯</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala.<span class="type">Function1</span>[<span class="type">A</span>, <span class="type">B</span>]</span><br></pre></td></tr></table></figure><p>çš„ç®€å†™ã€‚</p><h4 id="æ™®é€šå‡½æ•°"><a href="#æ™®é€šå‡½æ•°" class="headerlink" title="æ™®é€šå‡½æ•°"></a>æ™®é€šå‡½æ•°</h4><p>æ ¹æ® Function1 çš„å®šä¹‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Function1</span>[-<span class="type">A</span>, +<span class="type">R</span>] </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(x: <span class="type">A</span>): <span class="type">R</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œ</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> f1: <span class="type">Int</span> =&gt; <span class="type">Int</span> = (x: <span class="type">Int</span>) =&gt; x + <span class="number">1</span></span><br><span class="line"><span class="keyword">val</span> f2 = <span class="keyword">new</span> <span class="type">Function1</span>[<span class="type">Int</span>, <span class="type">Int</span>] &#123;<span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(x: <span class="type">Int</span>) = x + <span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure><p>f1 å’Œ f2 ç­‰ä»·ã€‚</p><h4 id="åå‡½æ•°"><a href="#åå‡½æ•°" class="headerlink" title="åå‡½æ•°"></a>åå‡½æ•°</h4><p>å¯¹äºåå‡½æ•° PartialFunction å®šä¹‰ä¸º</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">PartialFunction</span>[-<span class="type">A</span>, +<span class="type">R</span>] <span class="keyword">extends</span> <span class="title">Function1</span>[-<span class="type">A</span>, +<span class="type">R</span>] </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(x: <span class="type">A</span>): <span class="type">R</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isDefinedAt</span></span>(x: <span class="type">A</span>): <span class="type">Boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œ</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> f1: <span class="type">PartialFunction</span>[<span class="type">String</span>, <span class="type">String</span>] = &#123; <span class="keyword">case</span> <span class="string">"ping"</span> =&gt; <span class="string">"pong"</span> &#125;</span><br><span class="line"><span class="keyword">val</span> f2 = <span class="keyword">new</span> <span class="type">PartialFunction</span>[<span class="type">String</span>, <span class="type">String</span>] &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(x: <span class="type">String</span>) = x <span class="keyword">match</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"ping"</span> =&gt; <span class="string">"pong"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isDefinedAt</span></span>(x: <span class="type">String</span>) = x <span class="keyword">match</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"ping"</span> =&gt; <span class="literal">true</span></span><br><span class="line">        <span class="keyword">case</span> _ =&gt; <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>f1 å’Œ f2 ç­‰ä»·ã€‚</p><p>ps: ä»¥ä¸Šï¼Œã€Œç­‰ä»·ã€çš„æ„æ€æ˜¯ä¸¤ä¸ªå‡½æ•°åªè¦è¾“å…¥ç›¸åŒï¼Œè¾“å‡ºä¸€å®šç›¸åŒã€‚</p><h2 id="W2"><a href="#W2" class="headerlink" title="W2"></a>W2</h2><h3 id="LazyList"><a href="#LazyList" class="headerlink" title="LazyList"></a>LazyList</h3><p>ä¸‹é¢ä»£ç </p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span></span>(x: <span class="type">Int</span>): <span class="type">Boolean</span> = &#123;</span><br><span class="line">  println(x + <span class="string">" "</span>)</span><br><span class="line">  x % <span class="number">11</span> == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> v1 = (<span class="number">1</span> to <span class="number">100000</span>).filter(f)(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">val</span> v2 = (<span class="number">1</span> to <span class="number">100000</span>).to(<span class="type">LazyList</span>).filter(f)(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>v1 å’Œ v2 ç­‰ä»·ã€‚è®¡ç®— v1 çš„æ—¶å€™ä¼šæ‰“å° <code>1 2 3...9999 100000</code>, è€Œè®¡ç®— v2 çš„æ—¶å€™æ‰“å° <code>1 2 3 ... 21 22</code>ã€‚è¿™æ˜¯å› ä¸ºå¯¹äº v2ï¼Œ<code>(1 to 100000).to(LazyList)</code> äº§ç”Ÿçš„æ˜¯ <code>scala.collection.immutable.LazyList</code>ã€‚å…¶ä¸­å®˜æ–¹æ–‡æ¡£å¯¹å…¶æœ‰ä¸ªç®€å•çš„æè¿°</p><blockquote><p>This class implements an immutable linked list that evaluates elements in order and only when needed</p></blockquote><p>ä¹Ÿå°±æ˜¯å½“ LazyList é‡Œé¢çš„å…ƒç´ è¢«éœ€è¦çš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œæœ‰åºè®¡ç®—ï¼Œå¹¶ä¸”è®¡ç®—ä¼šç»ˆæ­¢çŸ¥é“æ‰€éœ€çš„å…ƒç´ è®¡ç®—ç»“æŸã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰ä¸Šè¿°çš„è¾“å‡ºäº†ã€‚</p><h3 id="æƒ°æ€§æ±‚å€¼-Lazy-Evaluation"><a href="#æƒ°æ€§æ±‚å€¼-Lazy-Evaluation" class="headerlink" title="æƒ°æ€§æ±‚å€¼ Lazy Evaluation"></a>æƒ°æ€§æ±‚å€¼ Lazy Evaluation</h3><p>åœ¨ Scala é‡Œé¢ï¼ŒLazy æ„å‘³ç€ä¸¤ç‚¹</p><ul><li><strong>å°½é‡å»¶åæ±‚å€¼è®¡ç®—</strong></li><li><strong>åªè®¡ç®—ä¸€æ¬¡</strong></li></ul><p>ä¾‹å¦‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expr</span> </span>= &#123;</span><br><span class="line">  <span class="keyword">val</span> x = &#123; print(â€xâ€); <span class="number">1</span> &#125;</span><br><span class="line">  <span class="keyword">lazy</span> <span class="keyword">val</span> y = &#123; print(â€yâ€); <span class="number">2</span> &#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">z</span> </span>= &#123; print(â€zâ€); <span class="number">3</span> &#125;</span><br><span class="line">  z + y + x + z + y + x <span class="comment">// last line</span></span><br><span class="line">&#125;</span><br><span class="line">expr</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¾“å‡ºä¸º <code>xzyz</code></p><h3 id="Infinite-Sequences"><a href="#Infinite-Sequences" class="headerlink" title="Infinite Sequences"></a>Infinite Sequences</h3><p>åˆ©ç”¨ LazyList çš„ç‰¹æ€§ï¼Œå¯ä»¥æ„é€ å‡ºæ— é™åºåˆ—ã€‚æ¯”å¦‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">from</span></span>(n: <span class="type">Int</span>): <span class="type">LazyList</span>[<span class="type">Int</span>] = n #:: from(n + <span class="number">1</span>) <span class="comment">// æ— é™åºåˆ—</span></span><br><span class="line">from: (n: <span class="type">Int</span>)<span class="type">LazyList</span>[<span class="type">Int</span>]</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> natures = from(<span class="number">0</span>) <span class="comment">// è‡ªç„¶æ•°</span></span><br><span class="line">natures: <span class="type">LazyList</span>[<span class="type">Int</span>] = <span class="type">LazyList</span>(&lt;not computed&gt;)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> hundreds = natures.filter(_ % <span class="number">100</span> == <span class="number">0</span>)</span><br><span class="line">hundreds: scala.collection.immutable.<span class="type">LazyList</span>[<span class="type">Int</span>] = <span class="type">LazyList</span>(&lt;not computed&gt;)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> fourHundred = hundreds(<span class="number">4</span>) <span class="comment">// è®¡ç®—</span></span><br><span class="line">fourHundred: <span class="type">Int</span> = <span class="number">400</span></span><br></pre></td></tr></table></figure><p><strong>åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•</strong></p><blockquote><p>åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•æ˜¯åˆ—å‡ºæ‰€æœ‰å°ç´ æ•°æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ï¼Œå…¶åå­—æ¥è‡ªäºå¤å¸Œè…Šæ•°å­¦å®¶åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ï¼Œå¹¶ä¸”è¢«æè¿°åœ¨å¦ä¸€ä½å¤å¸Œè…Šæ•°å­¦å®¶å°¼ç§‘é©¬åº“æ–¯æ‰€è‘—çš„ã€Šç®—æœ¯å…¥é—¨ã€‹ä¸­ã€‚-<a href="https://zh.wikipedia.org/wiki/%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></blockquote><p>ç”¨ LazyList å®ç°ä¼šéå¸¸ç®€å•ï¼Œ</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">from</span></span>(n: <span class="type">Int</span>): <span class="type">LazyList</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">  n #:: from(n + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sieve</span></span>(s: <span class="type">LazyList</span>[<span class="type">Int</span>]): <span class="type">LazyList</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">  s.head #:: sieve(s.tail.filter(_ % s.head != <span class="number">0</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primeNumber</span></span>(n: <span class="type">Int</span>): <span class="type">Int</span> = &#123;</span><br><span class="line">    sieve(from(<span class="number">2</span>))(n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> n = sieve(from(<span class="number">2</span>))(<span class="number">100</span>) <span class="comment">// è¾“å‡º 547</span></span><br></pre></td></tr></table></figure><h3 id="é¢˜ç›®ï¼šå€’æ°´é—®é¢˜"><a href="#é¢˜ç›®ï¼šå€’æ°´é—®é¢˜" class="headerlink" title="é¢˜ç›®ï¼šå€’æ°´é—®é¢˜"></a>é¢˜ç›®ï¼šå€’æ°´é—®é¢˜</h3><p>ç»™å‡ ä¸ªçŸ¥é“å®¹é‡ï¼Œä½†æ˜¯æ²¡æœ‰åˆ»åº¦çš„æ¯å­ï¼Œæœ‰ä¸ªå¯ä»¥å–ä¹‹ä¸å°½çš„æ°´æºç”¨æ¥ç»™æ¯å­è£…æ»¡æ°´å’Œå°†æ¯å­çš„æ°´å…¨éƒ¨å€’å‡ºã€‚æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ç››å‡ºç»™å®šå®¹é‡çš„æ°´ã€‚æˆ‘ä»¬èƒ½åšçš„æ“ä½œæœ‰ä¸‰ä¸ª</p><ul><li>empty æ¸…ç©º</li><li>fill æ”¾æ»¡æ°´</li><li>pour(a, b) æŠŠ a çš„æ°´å…¨éƒ¨å¾€ b å€’ç›´è‡³ b æ¯æ»¡äº†æˆ–è€… a æ¯æ²¡æ°´äº†</li></ul><p>ç°åœ¨éœ€è¦æ‰¾åˆ°å–å¾—å®¹é‡ä¸º N çš„æ°´æ—¶ï¼Œéœ€è¦çš„æ“ä½œã€‚</p><p>é™„ï¼š1. <a href="https://github.com/razertory/scala-code-lab/blob/master/src/main/scala/scalaschool/WaterPouring.scala" target="_blank" rel="noopener">Scala å®Œæ•´ä»£ç </a> 2. <a href="https://www.youtube.com/watch?v=q6M_pco_5Vo" target="_blank" rel="noopener">python è§£æ³•</a></p><h2 id="W3"><a href="#W3" class="headerlink" title="W3"></a>W3</h2><blockquote><p>ä¸‹é¢ä¼šç”¨ Scala è¿›è¡ŒåŠ æ³•å™¨æ¨¡æ‹Ÿã€‚å¯¹äºè®¡ç®—æœºä¸­ï¼Œä¸¤ä¸ªæ•°å¦‚ä½•ç›¸åŠ ï¼Œå¯ä»¥æå‰é˜…è¯» <a href="https://zh.wikipedia.org/wiki/%E5%8A%A0%E6%B3%95%E5%99%A8" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘-åŠ æ³•å™¨</a>ï¼Œæœ€å¥½èƒ½å¤Ÿåšä¸€ä¸‹ <a href="/2019/11/11/add-by-bit/">ä½è¿ç®—å®ç°åŠ æ³•</a>ã€‚</p></blockquote><p>é€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æœ€é‡è¦çš„ç‚¹åœ¨äºï¼šä¸¤ä¸ªä¸€ä½äºŒè¿›åˆ¶æ•°ç›¸åŠ ï¼Œå°†ä¼šäº§ç”Ÿä¸¤ä¸ªè¾“å‡ºï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯å½“å‰ä½ç›¸åŠ çš„å€¼ Sï¼Œå¦ä¸€ä¸ªæ˜¯ç›¸åŠ åçš„è¿›ä½ä¿¡æ¯ Cã€‚å…¶ä¸­ S å¯ä»¥ç”¨<em>å¼‚æˆ–é—¨</em>ï¼Œè¿›ä½å¯ä»¥ç”¨<em>ä¸é—¨</em>ã€‚ä¸¤ä¸ªåŠåŠ å™¨ç”¨<em>æˆ–</em>é—¨ç»„åˆä¸ºä¸€ä¸ªå…¨åŠ å™¨ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fgy1gc6mm6fcccj21fo0rgh3a.jpg" alt="å¼‚æˆ–çš„æ“ä½œé€šè¿‡ä¸‰ç§é—¨çš„ç»„åˆå®ç°" title>                </div>                <div class="image-caption">å¼‚æˆ–çš„æ“ä½œé€šè¿‡ä¸‰ç§é—¨çš„ç»„åˆå®ç°</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fgy1gc6mmvhps1j20tq0ja10b.jpg" alt="ä¸¤ä¸ªç”¨ä¸é—¨ç»„åˆçš„åŠåŠ å™¨æ„æˆä¸€ä¸ªå…¨åŠ å™¨" title>                </div>                <div class="image-caption">ä¸¤ä¸ªç”¨ä¸é—¨ç»„åˆçš„åŠåŠ å™¨æ„æˆä¸€ä¸ªå…¨åŠ å™¨</div>            </figure><p>æ ¹æ®ä¸Šå›¾ï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦å®ç°çš„æ˜¯</p><ul><li><p>ç”µçº¿ï¼šç”¨æ¥ä¼ å¯¼ä¿¡å·ï¼Œä¿¡å·å¯ä»¥ç”¨ boolean ç±»å‹è¡¨ç¤º 0 å’Œ 1</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wire</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> sigVal = <span class="literal">false</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">getSignal</span></span>: <span class="type">Boolean</span> = sigVal</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">setSignal</span></span>(s: <span class="type">Boolean</span>): <span class="type">Unit</span> =</span><br><span class="line">    <span class="keyword">if</span> (s != sigVal) &#123;</span><br><span class="line">        sigVal = s</span><br><span class="line">        actions foreach(_())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸é—¨ï¼šè¾“å…¥ä¸¤ä¸ªç”µä¿¡å·ï¼Œè¾“å‡º &amp; å¯¹åº”çš„ä¿¡å·</p></li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">andGate</span></span>(in1: <span class="type">Wire</span>, in2: <span class="type">Wire</span>, output: <span class="type">Wire</span>): <span class="type">Unit</span> = ???</span><br></pre></td></tr></table></figure><ul><li>æˆ–é—¨ï¼šè¾“å…¥ä¸¤ä¸ªç”µä¿¡å·ï¼Œè¾“å‡º | å¯¹åº”çš„ä¿¡å·</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">orGate</span></span>(in1: <span class="type">Wire</span>, in2: <span class="type">Wire</span>, output: <span class="type">Wire</span>): <span class="type">Unit</span> = ???</span><br></pre></td></tr></table></figure><ul><li>é€†å˜å™¨ï¼šè¾“å…¥ç”µä¿¡å·ï¼Œè¾“å‡º ! å¯¹åº”çš„ä¿¡å·</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverter</span></span>(in: <span class="type">Wire</span>, output: <span class="type">Wire</span>): <span class="type">Unit</span> = ???</span><br></pre></td></tr></table></figure><p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå®ç°å‡ºåŠåŠ å™¨å’Œå…¨åŠ å™¨</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">halfAdder</span></span>(a: <span class="type">Wire</span>, b: <span class="type">Wire</span>, s: <span class="type">Wire</span>, c: <span class="type">Wire</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">  <span class="keyword">val</span> d = <span class="keyword">new</span> <span class="type">Wire</span></span><br><span class="line">  <span class="keyword">val</span> e = <span class="keyword">new</span> <span class="type">Wire</span></span><br><span class="line">  orGate(a, b, d)</span><br><span class="line">  andGate(a, b, c)</span><br><span class="line">  inverter(c, e)</span><br><span class="line">  andGate(d, e, s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fullAdder</span></span>(a: <span class="type">Wire</span>, b: <span class="type">Wire</span>, cin: <span class="type">Wire</span>, sum: <span class="type">Wire</span>, cout: <span class="type">Wire</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">  <span class="keyword">val</span> s = <span class="keyword">new</span> <span class="type">Wire</span></span><br><span class="line">  <span class="keyword">val</span> c1 = <span class="keyword">new</span> <span class="type">Wire</span></span><br><span class="line">  <span class="keyword">val</span> c2 = <span class="keyword">new</span> <span class="type">Wire</span></span><br><span class="line">  halfAdder(b, cin, s, c1)</span><br><span class="line">  halfAdder(a, s, sum, c2)</span><br><span class="line">  orGate(c1, c2, cout)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°äº†å…¨åŠ å™¨åã€‚åŠ å…¥æ¨¡æ‹Ÿä¿¡å·çš„è¾“å…¥è¾“å‡ºå³å¯ï¼Œå®Œæ•´ä»£ç  <a href="https://github.com/razertory/scala-code-lab/blob/master/src/main/scala/scalaschool/DigitalCircuitSimulator.scala" target="_blank" rel="noopener">æ¨¡æ‹ŸåŠ æ³•å™¨</a></p><h2 id="W4"><a href="#W4" class="headerlink" title="W4"></a>W4</h2><h3 id="Functional-Reactive-Programming-FRP"><a href="#Functional-Reactive-Programming-FRP" class="headerlink" title="Functional Reactive Programming (FRP)"></a>Functional Reactive Programming (FRP)</h3><p>åœ¨ MVC æ¨¡å‹ä¸­ï¼ŒFRP å¯ä»¥è®© model åœ¨äº§ç”Ÿå˜åŒ–çš„åŒæ—¶ view è‡ªåŠ¨å˜åŒ–ã€‚è¿™æ ·çš„æ¨¡å‹ä¸€èˆ¬ä¹Ÿå°±æ˜¯ pub-sub æ¨¡å‹æˆ–è€…å«è§‚å¯Ÿè€…æ¨¡å‹ (observers)ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Subscriber1   subscribe     ___________</span><br><span class="line">Subscriber2  ------------&gt; |          |</span><br><span class="line">Subscriber3                |Publisher |</span><br><span class="line">Subscriber4  &lt;------------ |          |</span><br><span class="line">Subscriber5    publish     |__________|</span><br></pre></td></tr></table></figure><p>é€šç”¨çš„è¯´æ¯”å¦‚ <code>a = f(b)</code> é‡Œé¢ã€‚å½“ b åœ¨å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ a ä¹Ÿä¼šè·Ÿç€å˜ã€‚å®ç°è¿™ä¸€ç‚¹ï¼Œ<br>å¯ä»¥æŠŠã€Œå˜åŒ–ã€å½’åŒ–ä¸ºã€Œeventã€ï¼Œè€Œè‡ªåŠ¨æ£€æŸ¥è¿™äº›ã€Œeventã€çš„ä¸œè¥¿å«åš Signalã€‚åœ¨ Scala é‡Œé¢é€šå¸¸æŠŠè¿™æ ·çš„ Signal å®ç°ä¸ºä¸€ä¸ªç±»å‹ï¼Œé€šè¿‡ apply() ç»™å…¶èµ‹å€¼ã€‚æ¯”å¦‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> s = <span class="type">Signal</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">val</span> v = s() <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œä¸ºäº†ç»™ Signal å†æ¬¡èµ‹å€¼ï¼Œå¯ä»¥æ‰©å±•æ–°å¢ä¸€ä¸ª update æ–¹æ³•ã€‚æ¯”å¦‚ <code>s.update(5)</code>ï¼Œé¡ºå¸¦å¯ä»¥å†™æˆ <code>s() = 5</code>ã€‚è¿™æ ·çš„è¯ï¼Œå®ç°ä¸€ä¸ªæ‰©å±•äº† Signal åä¸º <code>Var</code> çš„ç±»å‹ï¼Œè®©å…¶æ‹¥æœ‰ <code>update</code> æ–¹æ³•ã€‚</p><p>åœ¨è¿™æ ·çš„æ¡ä»¶ä¸‹ï¼Œ</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// (1)</span></span><br><span class="line"><span class="keyword">val</span> num = <span class="type">Var</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">val</span> twice = <span class="type">Signal</span>(num() * <span class="number">2</span>)</span><br><span class="line">num() = <span class="number">2</span></span><br><span class="line"><span class="comment">// (2)</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="type">Var</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">val</span> twice = <span class="type">Signal</span>(num() * <span class="number">2</span>)</span><br><span class="line">num = <span class="type">Var</span>(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>(1) é‡Œé¢çš„ twice å˜ä¸º 4ï¼Œï¼ˆ2ï¼‰é‡Œé¢çš„ twice è¿˜æ˜¯ 2ã€‚ä¸Šè¿°ä½“ç°çš„ FRP é‡Œé¢ï¼Œnum æ˜¯ <em>publisher</em>ï¼Œtwice æ˜¯ <em>subscriber</em>ã€‚num äº§ç”Ÿäº† eventï¼Œtwice æ¥å—è¿™æ ·çš„ eventã€‚å¹¶ä¸”æ‰€æœ‰çš„å˜é‡æœ¬èº«éƒ½æ˜¯ <em>immutable</em>ã€‚</p><h3 id="å®ç°-FRP"><a href="#å®ç°-FRP" class="headerlink" title="å®ç° FRP"></a>å®ç° FRP</h3><h4 id="Var-å’Œ-Signal"><a href="#Var-å’Œ-Signal" class="headerlink" title="Var å’Œ Signal"></a>Var å’Œ Signal</h4><p>æˆ‘ä»¬çŸ¥é“ Signal å’Œ Var åº”è¯¥æ˜¯è¿™æ ·</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// signal</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Signal</span>[<span class="type">T</span>](<span class="params">expr: =&gt; <span class="type">T</span></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(): <span class="type">T</span> = ???</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Signal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>[<span class="type">T</span>](expr: =&gt; <span class="type">T</span>) = <span class="keyword">new</span> <span class="type">Signal</span>(expr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// var</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Var</span>[<span class="type">T</span>](<span class="params">expr: =&gt; <span class="type">T</span></span>) <span class="keyword">extends</span> <span class="title">Signal</span>[<span class="type">T</span>](<span class="params">expr</span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span></span>(expr: =&gt; <span class="type">T</span>): <span class="type">Unit</span> = ???</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Var</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>[<span class="type">T</span>](expr: =&gt; <span class="type">T</span>) = <span class="keyword">new</span> <span class="type">Var</span>(expr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç»´æŠ¤è®¢é˜…å…³ç³»"><a href="#ç»´æŠ¤è®¢é˜…å…³ç³»" class="headerlink" title="ç»´æŠ¤è®¢é˜…å…³ç³»"></a>ç»´æŠ¤è®¢é˜…å…³ç³»</h3><p>æœ‰äº†è¿™äº›æ–¹æ³•ï¼Œå°±å¯ä»¥åšåˆ°èµ‹å€¼å’Œå†æ¬¡èµ‹å€¼ã€‚è¿˜éœ€è¦çš„æ˜¯ï¼Œå½“ä¸€ä¸ª publisher äº§ç”Ÿäº† event çš„æ—¶å€™ï¼Œå¦‚ä½•è‡ªåŠ¨é€šçŸ¥åˆ°å¯¹åº”çš„ subscriberï¼Œå¹¶ä¸”è®©å…¶é‡æ–°è®¡ç®—ï¼ˆre-evaluateï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œs æ˜¯ Var ç±»å‹ï¼Œå¹¶ä¸”è¿›å…¥åˆ°äº†è¡¨è¾¾å¼ expr é‡Œï¼Œå½¢å¦‚ <code>expr s</code>ï¼Œé‚£ä¹ˆå½“è¡¨è¾¾å¼ <code>expr s</code>ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™äº†æŸä¸ª Signal å½¢å¦‚ <code>val t = Signal(expr s)</code> çš„æ—¶å€™ã€‚å°±éœ€è¦ç»™ s ç»´æŠ¤ä¸€ä¸ª subscriberã€‚åŒç†ï¼Œå½“æœ‰å¤šä¸ª subscribers çš„æ—¶å€™å°±ç»™ s ç»´æŠ¤ä¸€ä¸ª subscriber çš„é›†åˆã€‚æ¯”å¦‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// val set = Set()</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="type">Var</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘çš„æ¡ä»¶å°±æ˜¯ class Var çš„ apply æ–¹æ³•ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘ï¼šset += Signal(num() * 2)</span></span><br><span class="line"><span class="keyword">val</span> double = <span class="type">Signal</span>(num() * <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘ï¼šset += Signal(num() * 3)</span></span><br><span class="line"><span class="keyword">val</span> tiple = <span class="type">Signal</span>(num() * <span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>è§¦å‘çš„æ¡ä»¶è¾¾åˆ°äº†ï¼Œå¯æ˜¯å¦‚ä½•æŠŠ <code>Signal(num() * 3)</code> è¿™æ ·çš„å¯¹è±¡ä¼ é€’ç»™ num çš„ set ï¼Ÿ</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦åœ¨ Object Signal é‡Œé¢æ–°å¢ä¸€å—ç”¨äºç»´æŠ¤æ–¹æ³•è°ƒç”¨çš„æ•°æ®ç»“æ„ï¼Œæ²¡åšå°±æ˜¯ stack</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Signal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> caller = <span class="keyword">new</span> <span class="type">StackableVariable</span>[<span class="type">Signal</span>[_]](<span class="type">NoSignal</span>)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>[<span class="type">T</span>](expr: =&gt; <span class="type">T</span>) = <span class="keyword">new</span> <span class="type">Signal</span>(expr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>StackableVariable åœ¨å½“å‰çš„ä¸Šä¸‹æ–‡ä¸­å¤šä¸ª Signal/Object ä¼šå…±äº«ã€‚å½“è°ƒç”¨ class Signal çš„ apply() æ–¹æ³•çš„æ—¶å€™å°±å»è¿™é‡Œé¢æ‰¾åˆ°å½“å‰çš„è°ƒç”¨æ–¹ã€‚</p><h3 id="ç»´æŠ¤è°ƒç”¨æ ˆ"><a href="#ç»´æŠ¤è°ƒç”¨æ ˆ" class="headerlink" title="ç»´æŠ¤è°ƒç”¨æ ˆ"></a>ç»´æŠ¤è°ƒç”¨æ ˆ</h3><p>è°ƒç”¨æ ˆé‡Œé¢å­˜æ”¾æœ‰åºçš„ Signalã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸‹é¢æµ‹è¯•ä»£ç </p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">test(<span class="string">"multi subscribers"</span>) &#123;</span><br><span class="line">  <span class="keyword">val</span> publisher = <span class="type">Var</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">val</span> subscriber1 = <span class="type">Signal</span>(publisher() * <span class="number">20</span>) <span class="comment">// æ³¨æ„ scala çš„ call-by-name å’Œ call-by-valueã€‚è¿™é‡Œä¼ é€’çš„æ˜¯è¡¨è¾¾å¼</span></span><br><span class="line">  <span class="keyword">val</span> subscriber2 = <span class="type">Signal</span>(publisher() * <span class="number">30</span>)</span><br><span class="line">  <span class="keyword">val</span> subscriber3 = <span class="type">Signal</span>(publisher() * <span class="number">40</span>)</span><br><span class="line">  assert(subscriber1() == <span class="number">20</span>)</span><br><span class="line">  assert(subscriber2() == <span class="number">30</span>)</span><br><span class="line">  assert(subscriber3() == <span class="number">40</span>)</span><br><span class="line">  publisher() = <span class="number">2</span></span><br><span class="line">  assert(subscriber1() == <span class="number">40</span>)</span><br><span class="line">  assert(subscriber2() == <span class="number">60</span>)</span><br><span class="line">  assert(subscriber3() == <span class="number">80</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰è¡Œå¼€å§‹ï¼ŒåŒ…å«è¡¨è¾¾å¼çš„ Signal è¿›å…¥è°ƒç”¨æ ˆï¼Œå¹¶ä¸æ–­è¢«å¸¦å…¥ subscriber çš„é›†åˆã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StackableVariable</span>[<span class="type">T</span>](<span class="params">init: <span class="type">T</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> values: <span class="type">List</span>[<span class="type">T</span>] = <span class="type">List</span>(init)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">value</span></span>: <span class="type">T</span> = values.head</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">withValue</span></span>[<span class="type">R</span>](newValue: <span class="type">T</span>)(op: =&gt; <span class="type">R</span>): <span class="type">R</span> = &#123;</span><br><span class="line">    values = newValue :: values</span><br><span class="line">    <span class="keyword">try</span> op <span class="keyword">finally</span> values = values.tail</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/razertory/scala-code-lab/blob/master/src/main/scala/scalaschool/SubPub.scala" target="_blank" rel="noopener">å®Œæ•´ä»£ç </a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨è¿™ä¸ª 2020 å¹´åˆçš„ç‰¹æ®Šæ—¶æœŸã€‚&lt;/p&gt;
&lt;p&gt;Scala æ˜¯ä¸€é—¨ç°ä»£åŒ–ï¼Œå¤šèŒƒå¼çš„ JVM è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ é€é—¨ï¼ˆå¯èƒ½éœ€è¦ğŸš€)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.coursera.org/learn/progfun2&quot; targ
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>LRU ç¼“å­˜</title>
    <link href="https://razertory.me/2020/02/16/lru-cache/"/>
    <id>https://razertory.me/2020/02/16/lru-cache/</id>
    <published>2020-02-16T09:39:04.000Z</published>
    <updated>2020-03-28T13:02:10.018Z</updated>
    
    <content type="html"><![CDATA[<p>LRU çš„å…¨ç§°æ˜¯ Least recently usedï¼Œæ˜¯ç¼“å­˜æ›¿æ¢ç­–ç•¥çš„ä¸€ç§ã€‚ç”µè„‘å­˜å‚¨å™¨ç©ºé—´çš„å¤§å°å›ºå®šï¼Œæ— æ³•å®¹çº³æœåŠ¡å™¨ä¸Šæ‰€æœ‰çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å½“æœ‰æ–°çš„æ–‡ä»¶è¦è¢«ç½®æ¢å…¥ç¼“å­˜æ—¶ï¼Œå¿…é¡»æ ¹æ®ä¸€å®šçš„åŸåˆ™æ¥å–ä»£æ‰é€‚å½“çš„æ–‡ä»¶ã€‚æ­¤åŸåˆ™å³æ‰€è°“ç¼“å­˜æ›¿æ¢ç­–ç•¥ã€‚<br><a href="https://leetcode.com/problems/lru-cache/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><hr><p>å®ç° LRU ç¼“å­˜éœ€è¦ç”¨åˆ° kv ç±»å‹å’Œçº¿å‹çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥åšåˆ° O(1) çš„æŸ¥æ‰¾æ•ˆç‡å’Œå®ç°æ·˜æ±°æœºåˆ¶ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ HashMap å’Œä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚å…¶ä¸­ç”¨åŒå‘é“¾è¡¨çš„å¥½å¤„æ˜¯ï¼šå½“è¦åˆ é™¤çš„èŠ‚ç‚¹ä¸º node çš„æ—¶å€™ï¼Œé€šè¿‡ <code>node.pre</code> å’Œ <code>node.next</code> å¯ä»¥å¿«é€Ÿæ‰¾åˆ°å‰åèŠ‚ç‚¹ï¼Œä»è€Œåœ¨é“¾è¡¨ä¸­å»æ‰è¿™ä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">LinkNode</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> key;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    LinkNode prev;</span><br><span class="line">    LinkNode next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ–°å¢çš„ node åªä½œä¸º head</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(LinkNode node)</span> </span>&#123;</span><br><span class="line">    node.prev = head;</span><br><span class="line">    node.next = head.next;</span><br><span class="line"></span><br><span class="line">    head.next.prev = node;</span><br><span class="line">    head.next = node;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ prev å’Œ next å¿«é€Ÿåˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">removeNode</span><span class="params">(LinkNode node)</span></span>&#123;</span><br><span class="line">    LinkNode prev = node.prev;</span><br><span class="line">    LinkNode next = node.next;</span><br><span class="line"></span><br><span class="line">    prev.next = next;</span><br><span class="line">    next.prev = prev;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…ˆåˆ é™¤ï¼Œåæ–°å¢ä»è€ŒæŒ‡å‘å¤´éƒ¨</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">moveToHead</span><span class="params">(LinkNode node)</span></span>&#123;</span><br><span class="line">    removeNode(node);</span><br><span class="line">    addNode(node);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ·˜æ±°æœ«å°¾</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> LinkNode <span class="title">popTail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LinkNode res = tail.prev;</span><br><span class="line">    removeNode(res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> HashMap&lt;Integer, LinkNode&gt; cache =</span><br><span class="line">          <span class="keyword">new</span> HashMap&lt;Integer, LinkNode&gt;();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> capacity;</span><br><span class="line">  <span class="keyword">private</span> LinkNode head, tail;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">LRUCache</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line"></span><br><span class="line">    head = <span class="keyword">new</span> LinkNode();</span><br><span class="line">    tail = <span class="keyword">new</span> LinkNode();</span><br><span class="line"></span><br><span class="line">    head.next = tail;</span><br><span class="line">    tail.prev = head;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    LinkNode node = cache.get(key);</span><br><span class="line">    <span class="keyword">if</span> (node == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    moveToHead(node);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> node.value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">    LinkNode node = cache.get(key);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(node == <span class="keyword">null</span>) &#123;</span><br><span class="line">      LinkNode newNode = <span class="keyword">new</span> LinkNode();</span><br><span class="line">      newNode.key = key;</span><br><span class="line">      newNode.value = value;</span><br><span class="line"></span><br><span class="line">      cache.put(key, newNode);</span><br><span class="line">      addNode(newNode);</span><br><span class="line"></span><br><span class="line">      ++size;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(size &gt; capacity) &#123;</span><br><span class="line">        LinkNode tail = popTail();</span><br><span class="line">        cache.remove(tail.key);</span><br><span class="line">        --size;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      node.value = value;</span><br><span class="line">      moveToHead(node);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ç§æ›´ä¸ºä¼˜é›…çš„å®ç°æ˜¯è®©è¿™ä¸ªåŒå‘é“¾è¡¨æˆç¯çŠ¶ï¼Œåˆå§‹åŒ–ä¸º value éƒ½ä¸º -1ï¼Œå¤§å°ä¸º capacityã€‚æ¯å½“æœ‰ get å’Œ put æ“ä½œçš„æ—¶å€™å°±è°ƒæ•´ç¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> key, val;</span><br><span class="line">        Node next, pre;</span><br><span class="line">        Node(<span class="keyword">int</span> key, <span class="keyword">int</span> val, Node pre, Node next) &#123;</span><br><span class="line">            <span class="keyword">this</span>.key = key;</span><br><span class="line">            <span class="keyword">this</span>.val = val;</span><br><span class="line">            <span class="keyword">this</span>.pre = pre;</span><br><span class="line">            <span class="keyword">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Node head = <span class="keyword">new</span> Node(-<span class="number">1</span>, -<span class="number">1</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Integer, Node&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">move2Head</span><span class="params">(Node cur)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cur == head) &#123;</span><br><span class="line">            head = head.pre;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur.pre.next = cur.next;</span><br><span class="line">        cur.next.pre = cur.pre;</span><br><span class="line"></span><br><span class="line">        cur.next = head.next;</span><br><span class="line">        cur.next.pre = cur;</span><br><span class="line">        head.next = cur;</span><br><span class="line">        cur.pre = head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LRUCache(<span class="keyword">int</span> capacity)&#123;</span><br><span class="line">        Node cur = head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; capacity - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            cur.next = <span class="keyword">new</span> Node(-<span class="number">1</span>, -<span class="number">1</span>, cur, <span class="keyword">null</span>);</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        cur.next = head;</span><br><span class="line">        head.pre = cur;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!map.containsKey(key)) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        Node node = map.get(key);</span><br><span class="line">        move2Head(node);</span><br><span class="line">        <span class="keyword">return</span> node.val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(key)) &#123;</span><br><span class="line">            Node node = map.get(key);</span><br><span class="line">            node.val = val;</span><br><span class="line">            move2Head(node);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (head.val != -<span class="number">1</span>) map.remove(head.key);</span><br><span class="line">            head.key = key;</span><br><span class="line">            head.val = val;</span><br><span class="line">            map.put(key, head);</span><br><span class="line">            head = head.pre;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤–ï¼ŒJava ä¸­çš„ LinkedHashMap å¯ä»¥ç›´æ¥å®ç° LRU ç¼“å­˜ã€‚:)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;LRU çš„å…¨ç§°æ˜¯ Least recently usedï¼Œæ˜¯ç¼“å­˜æ›¿æ¢ç­–ç•¥çš„ä¸€ç§ã€‚ç”µè„‘å­˜å‚¨å™¨ç©ºé—´çš„å¤§å°å›ºå®šï¼Œæ— æ³•å®¹çº³æœåŠ¡å™¨ä¸Šæ‰€æœ‰çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å½“æœ‰æ–°çš„æ–‡ä»¶è¦è¢«ç½®æ¢å…¥ç¼“å­˜æ—¶ï¼Œå¿…é¡»æ ¹æ®ä¸€å®šçš„åŸåˆ™æ¥å–ä»£æ‰é€‚å½“çš„æ–‡ä»¶ã€‚æ­¤åŸåˆ™å³æ‰€è°“ç¼“å­˜æ›¿æ¢ç­–ç•¥ã€‚&lt;br&gt;&lt;a href=&quot;https://
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç¼–è¾‘è·ç¦»</title>
    <link href="https://razertory.me/2020/01/11/edit-distance/"/>
    <id>https://razertory.me/2020/01/11/edit-distance/</id>
    <published>2020-01-11T03:35:32.000Z</published>
    <updated>2020-03-28T13:02:10.016Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å‡ºä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œæ‰¾å‡ºæŠŠ word1 ç¼–è¾‘æˆ word2 çš„æœ€çŸ­ç¼–è¾‘è·ç¦»ã€‚ç»™å‡ºçš„å¯ç”¨ç¼–è¾‘æ“ä½œæœ‰ï¼š</p><ol><li>æ’å…¥ä¸€ä¸ªå­—ç¬¦ insert</li><li>åˆ é™¤ä¸€ä¸ªå­—ç¬¦ delete</li><li>æ›´æ–°ä¸€ä¸ªå­—ç¬¦ update</li></ol><blockquote><p>ç¼–è¾‘è·ç¦»æ˜¯é’ˆå¯¹äºŒä¸ªå­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚è‹±æ–‡å­—ï¼‰çš„å·®å¼‚ç¨‹åº¦çš„é‡åŒ–é‡æµ‹ï¼Œé‡æµ‹æ–¹å¼æ˜¯çœ‹è‡³å°‘éœ€è¦å¤šå°‘æ¬¡çš„å¤„ç†æ‰èƒ½å°†ä¸€ä¸ªå­—ç¬¦ä¸²å˜æˆå¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ç¼–è¾‘è·ç¦»å¯ä»¥ç”¨åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œä¾‹å¦‚æ‹¼å†™æ£€æŸ¥å¯ä»¥æ ¹æ®ä¸€ä¸ªæ‹¼é”™çš„å­—å’Œå…¶ä»–æ­£ç¡®çš„å­—çš„ç¼–è¾‘è·ç¦»ï¼Œåˆ¤æ–­å“ªä¸€ä¸ªï¼ˆæˆ–å“ªå‡ ä¸ªï¼‰æ˜¯æ¯”è¾ƒå¯èƒ½çš„å­—ã€‚DNAä¹Ÿå¯ä»¥è§†ä¸ºç”¨Aã€Cã€Gå’ŒTç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå› æ­¤ç¼–è¾‘è·ç¦»ä¹Ÿç”¨åœ¨ç”Ÿç‰©ä¿¡æ¯å­¦ä¸­ï¼Œåˆ¤æ–­äºŒä¸ªDNAçš„ç±»ä¼¼ç¨‹åº¦ã€‚Unix ä¸‹çš„ diff åŠ patch å³æ˜¯åˆ©ç”¨ç¼–è¾‘è·ç¦»æ¥è¿›è¡Œæ–‡æœ¬ç¼–è¾‘å¯¹æ¯”çš„ä¾‹å­ã€‚</p></blockquote><h2 id="ä¼ é€é—¨"><a href="#ä¼ é€é—¨" class="headerlink" title="ä¼ é€é—¨"></a><a href="https://leetcode.com/problems/edit-distance/" target="_blank" rel="noopener">ä¼ é€é—¨</a></h2><p>å¯¹äº â€œaâ€, â€œâ€, æ‰§è¡Œæ­¥éª¤ 1<br>å¯¹äº â€œâ€, â€œaâ€, æ‰§è¡Œæ­¥éª¤ 2<br>å¯¹äº â€œaâ€, â€œbâ€, æ‰§è¡Œæ­¥éª¤ 3</p><p>å‡è®¾å­—ç¬¦ä¸²ä¸² word1 å’Œ word2 çš„æœ€å°ç¼–è¾‘è·ç¦»æ˜¯ <code>d[i][j]</code> (i å’Œ j ä»£è¡¨ word1 å’Œ word2 çš„é•¿åº¦ - 1)ï¼Œå½“æˆ‘ä»¬ç»™ word1 å’Œ word2 éƒ½ append ä¸€ä¸ªç›¸åŒçš„å­—ç¬¦çš„æ—¶å€™ï¼Œè¿™ä¸ªç¼–è¾‘è·ç¦»ä¸å˜ã€‚å› æ­¤å¯ä»¥è®¤ä¸ºï¼Œæ­¤æ—¶çš„ <code>d[i+1][j+1] == d[i][j]</code>ã€‚å½“ append çš„å­—ç¬¦ä¸åŒçš„çš„æ—¶å€™ã€‚å°±æ˜¯æ‰¾åˆ°ä¹‹å‰çš„æœ€å°ç¼–è¾‘è·ç¦» + 1ï¼Œè¿™ä¸ªä¹‹å‰çš„æœ€å°ç¼–è¾‘è·ç¦»å¯èƒ½æ˜¯ <code>d[i][j]</code>ã€<code>d[i][j+1]</code>ã€æˆ–è€… <code>d[i+1][j]</code>ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/large/a67b702fgy1gasiec3bhgj204q0710sl.jpg" alt="Edit-Distance.png" title>                </div>                <div class="image-caption">Edit-Distance.png</div>            </figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(String word1, String word2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (word1 == <span class="keyword">null</span> || word2 == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> m = word1.length() + <span class="number">1</span>, n = word2.length() + <span class="number">1</span>; <span class="comment">//å¤šçš„ä¸€è¡Œç•™ç»™ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span>[][] d = <span class="keyword">new</span> <span class="keyword">int</span>[m][n];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            d[i][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">            d[<span class="number">0</span>][j] = j;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (word1.charAt(i-<span class="number">1</span>) == word2.charAt(j-<span class="number">1</span>))</span><br><span class="line">                    d[i][j] = d[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    d[i][j] = min(d[i-<span class="number">1</span>][j-<span class="number">1</span>], d[i][j-<span class="number">1</span>], d[i-<span class="number">1</span>][j]) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> d[m-<span class="number">1</span>][n-<span class="number">1</span>];</span><br><span class="line">                </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.min(a, Math.min(b, c));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç»™å‡ºä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œæ‰¾å‡ºæŠŠ word1 ç¼–è¾‘æˆ word2 çš„æœ€çŸ­ç¼–è¾‘è·ç¦»ã€‚ç»™å‡ºçš„å¯ç”¨ç¼–è¾‘æ“ä½œæœ‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ’å…¥ä¸€ä¸ªå­—ç¬¦ insert&lt;/li&gt;
&lt;li&gt;åˆ é™¤ä¸€ä¸ªå­—ç¬¦ delete&lt;/li&gt;
&lt;li&gt;æ›´æ–°ä¸€ä¸ªå­—ç¬¦ update&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>äºŒç»´æ•°ç»„ä¸­å’Œæœ€å°è·¯å¾„</title>
    <link href="https://razertory.me/2020/01/11/minimum-path-sum/"/>
    <id>https://razertory.me/2020/01/11/minimum-path-sum/</id>
    <published>2020-01-11T02:38:44.000Z</published>
    <updated>2020-03-28T13:02:10.017Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸€ä¸ª m * n å¤§çš„éè´Ÿç»„æ•´æ•°ç»„æˆçš„äºŒç»´æ•°ç»„ä¸­ï¼Œæ‰¾åˆ°ä¸€æ¡ä» left-top åˆ° right-bottom çš„å’Œæœ€å°çš„è·¯å¾„ã€‚è¾“å‡ºè¿™ä¸ªè·¯å¾„çš„å€¼ã€‚<a href="https://leetcode.com/problems/minimum-path-sum/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><hr><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  [<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">1</span>,<span class="number">5</span>,<span class="number">1</span>],</span><br><span class="line">  [<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>åœ¨è¿™æ ·ä¸€ä¸ªçŸ©é˜µä¸­ï¼Œä» <code>m[0][0]</code> åˆ° <code>m[2][2]</code> çš„æœ€çŸ­è·¯å¾„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ <code>m[0][0]</code> åˆ° <code>m[1][2]</code> çš„æœ€çŸ­è·¯å¾„ (1-&gt;3-&gt;1-&gt;1) ä»¥åŠ <code>m[2][1]</code> çš„æœ€çŸ­è·¯å¾„ä¸­å–åˆ°çš„æœ€å°å€¼ (1-&gt;1-&gt;4-&gt;2) åŠ ä¸Š <code>m[2][2]</code> å–åˆ°çš„æœ€å°å€¼ 1-&gt;3-&gt;1-&gt;1-&gt;1ã€‚å› æ­¤å¯ä»¥å¾—åˆ°å…³ç³»å¼ </p><p><code>dp[m][n] = min(dp[m-1][n], dp[m][n-1]) + g[m][n]</code></p><p>åˆ©ç”¨è¿™ä¸ªå…³ç³»å¼ï¼Œå¤„ç†å¥½ mï¼Œn ä¸º 0 çš„è¾¹ç•Œæƒ…å†µå³å¯å¾—å‡ºæœ€çŸ­è·¯å¾„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="comment">// dp[m][n] = min(dp[m-1][n], dp[m][n-1]) + g[m][n] </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minPathSum</span><span class="params">(<span class="keyword">int</span>[][] g)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (g == <span class="keyword">null</span> || g[<span class="number">0</span>] == <span class="keyword">null</span>)  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> h = g.length, w = g[<span class="number">0</span>].length;</span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[h][w];</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = g[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; h; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; w; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span> &amp;&amp; j == <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">                    dp[i][j] = dp[i][j-<span class="number">1</span>] + g[i][j];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (j == <span class="number">0</span>)</span><br><span class="line">                    dp[i][j] = dp[i-<span class="number">1</span>][j] + g[i][j];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = Math.min(dp[i-<span class="number">1</span>][j], dp[i][j-<span class="number">1</span>]) + g[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[h-<span class="number">1</span>][w-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ä¸€ä¸ª m * n å¤§çš„éè´Ÿç»„æ•´æ•°ç»„æˆçš„äºŒç»´æ•°ç»„ä¸­ï¼Œæ‰¾åˆ°ä¸€æ¡ä» left-top åˆ° right-bottom çš„å’Œæœ€å°çš„è·¯å¾„ã€‚è¾“å‡ºè¿™ä¸ªè·¯å¾„çš„å€¼ã€‚&lt;a href=&quot;https://leetcode.com/problems/minimum-path-sum/&quot; target
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æœ€é•¿å›æ–‡å­ä¸²</title>
    <link href="https://razertory.me/2020/01/11/longest-palindromic-substring/"/>
    <id>https://razertory.me/2020/01/11/longest-palindromic-substring/</id>
    <published>2020-01-11T02:00:36.000Z</published>
    <updated>2020-03-28T13:02:10.017Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿çš„å›æ–‡ä¸²ã€‚<a href="https://leetcode.com/problems/longest-palindromic-substring/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><hr><p>å›æ–‡ä¸²æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§æ˜¯ aabb ç±»å‹ï¼Œå¦ä¸€ç§æ˜¯ aacbb ç±»å‹ã€‚å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²åšæ˜¯å¦æ˜¯å›æ–‡çš„æ—¶å€™å¯ä»¥å®ç°ä¸€ä¸ª expand å‡½æ•°ç”¨ä½œåˆ¤æ–­<code>int expand(String s, int lelf, int right)</code> å½“ s[left] == s[right] ä¸” left å’Œ right æ²¡æœ‰åˆ°è¾¾å­—ç¬¦ä¸²è¾¹ç•Œçš„æ—¶å€™è®¡ç®—é•¿åº¦å³ <code>right - left + 1</code>ã€‚</p><p>å®ç°äº† expand ä¹‹åï¼Œå¯¹äºä»»æ„å­—ç¬¦ä¸²å¯ä»¥ç¡®è®¤ï¼š</p><ol><li>å­—ç¬¦ä¸²é•¿åº¦ä¸º 1 çš„æ—¶å€™ï¼Œæœ¬èº«å°±æ˜¯å›æ–‡ä¸²</li><li>å­—ç¬¦ä¸²é•¿åº¦ä¸º 2 çš„æ—¶å€™ï¼Œåˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¯´æ˜æœ¬èº«æ˜¯ï¼Œå¦åˆ™å’Œ 1 ä¸€è‡´</li><li>å­—ç¬¦ä¸²é•¿åº¦ä¸º n çš„æ—¶å€™ï¼Œåœ¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œä»å·¦åˆ°å³æ‰«ææ‰¾åˆ°æœ€å¤§å€¼ <code>max (expand(s, i, i), expand(s, i, i + 1))</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">longestPalindrome</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> start = <span class="number">0</span>, max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> len1 = expand(s, i, i);</span><br><span class="line">            <span class="keyword">int</span> len2 = expand(s, i, i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">int</span> len = Math.max(len1, len2);</span><br><span class="line">            <span class="keyword">if</span> (len &gt; max) &#123;</span><br><span class="line">                start = i - (len-<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">                max = len;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.substring(start, start + max);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">expand</span><span class="params">(String s, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(left &gt;= <span class="number">0</span> &amp;&amp; right &lt; s.length() &amp;&amp; s.charAt(left) == s.charAt(right))&#123;</span><br><span class="line">            left--;</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> right - left - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç»™ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿çš„å›æ–‡ä¸²ã€‚&lt;a href=&quot;https://leetcode.com/problems/longest-palindromic-substring/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ä¼ é€é—¨&lt;/a&gt;&lt;/p&gt;
&lt;hr
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æŠ¢åŠ«æˆ¿å­</title>
    <link href="https://razertory.me/2020/01/11/house-robber/"/>
    <id>https://razertory.me/2020/01/11/house-robber/</id>
    <published>2020-01-11T01:33:19.000Z</published>
    <updated>2020-03-28T13:02:10.017Z</updated>
    
    <content type="html"><![CDATA[<p>ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å°å·ï¼Œè®¡åˆ’å·çªƒæ²¿è¡—çš„æˆ¿å±‹ã€‚æ¯é—´æˆ¿å†…éƒ½è—æœ‰ä¸€å®šçš„ç°é‡‘ï¼Œå½±å“ä½ å·çªƒçš„å”¯ä¸€åˆ¶çº¦å› ç´ å°±æ˜¯ç›¸é‚»çš„æˆ¿å±‹è£…æœ‰ç›¸äº’è¿é€šçš„é˜²ç›—ç³»ç»Ÿï¼Œå¦‚æœä¸¤é—´ç›¸é‚»çš„æˆ¿å±‹åœ¨åŒä¸€æ™šä¸Šè¢«å°å·é—¯å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦ã€‚<br>ç»™å®šä¸€ä¸ªä»£è¡¨æ¯ä¸ªæˆ¿å±‹å­˜æ”¾é‡‘é¢çš„éè´Ÿæ•´æ•°æ•°ç»„ï¼Œè®¡ç®—ä½ åœ¨ä¸è§¦åŠ¨è­¦æŠ¥è£…ç½®çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ã€‚</p><p><a href="https://leetcode.com/problems/house-robber/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><hr><p>å‡è®¾æˆ¿å­å®šä¹‰ä¸º <code>house[i]</code></p><p>æˆ¿å±‹æ•°é‡æ˜¯ 1 çš„æ—¶å€™ï¼Œå°å·åªèƒ½å·è¿™ä¸€å®¶ <code>house[0]</code>ã€‚</p><p>æˆ¿å±‹æ•°é‡æ˜¯ 2 çš„æ—¶å€™ï¼Œå°å·ä»ç°æœ‰çš„é€‰ä¸€ä¸ªå¤šçš„ï¼Œä¹Ÿå°±æ˜¯ <code>max(house[0], house[1])</code></p><p>æˆ¿å±‹æ•°é‡æ˜¯ 3 çš„æ—¶å€™ï¼Œå°å·çš„é€‰æ‹©ä¸º <code>max(house[0] + house[2], house[1])</code></p><p>å¦‚æœæˆ‘ä»¬çŸ¥é“æˆ¿å±‹æ•°é‡ä¸º i - 1 çš„æ—¶å€™ï¼Œå°å·çš„æœ€ä½³é€‰æ‹©æ˜¯ <code>d[i-1]</code>ï¼Œé‚£ä¹ˆå½“å†å¢åŠ ä¸€ä¸ªæˆ¿å±‹ï¼Œå³æˆ¿å±‹æ•°é‡ä¸º i çš„æ—¶å€™ã€‚ä¾æ®é¢˜æ„å¯ä»¥æ¨å¯¼å‡º</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d[i] = max(house[i] + d[i-<span class="number">2</span>], d[i-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>ç¿»è¯‘æˆä»£ç å°±æ˜¯ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span>[] d = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) d[i] = nums[i];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">1</span>) d[i] = Math.max(nums[i], nums[i-<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">else</span> d[i] = Math.max(d[i-<span class="number">2</span>] + nums[i], d[i-<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> d[nums.length - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å°å·ï¼Œè®¡åˆ’å·çªƒæ²¿è¡—çš„æˆ¿å±‹ã€‚æ¯é—´æˆ¿å†…éƒ½è—æœ‰ä¸€å®šçš„ç°é‡‘ï¼Œå½±å“ä½ å·çªƒçš„å”¯ä¸€åˆ¶çº¦å› ç´ å°±æ˜¯ç›¸é‚»çš„æˆ¿å±‹è£…æœ‰ç›¸äº’è¿é€šçš„é˜²ç›—ç³»ç»Ÿï¼Œå¦‚æœä¸¤é—´ç›¸é‚»çš„æˆ¿å±‹åœ¨åŒä¸€æ™šä¸Šè¢«å°å·é—¯å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦ã€‚&lt;br&gt;ç»™å®šä¸€ä¸ªä»£è¡¨æ¯ä¸ªæˆ¿å±‹å­˜æ”¾é‡‘é¢çš„éè´Ÿæ•´æ•°æ•°ç»„ï¼Œè®¡ç®—ä½ åœ¨ä¸è§¦åŠ¨è­¦æŠ¥è£…ç½®çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå·
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ä¹°å–è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</title>
    <link href="https://razertory.me/2020/01/09/max-stock-profit/"/>
    <id>https://razertory.me/2020/01/09/max-stock-profit/</id>
    <published>2020-01-09T05:02:03.000Z</published>
    <updated>2020-03-28T13:02:10.016Z</updated>
    
    <content type="html"><![CDATA[<p>å‡è®¾æŠŠæŸè‚¡ç¥¨çš„ä»·æ ¼æŒ‰ç…§æ—¶é—´å…ˆåé¡ºåºå­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œè¯·é—®ä¹°å– ä¸€æ¬¡ è¯¥è‚¡ç¥¨å¯èƒ½è·å¾—çš„åˆ©æ¶¦æ˜¯å¤šå°‘ï¼Ÿ</p><p>ä¾‹å¦‚ä¸€åªè‚¡ç¥¨åœ¨æŸäº›æ—¶é—´èŠ‚ç‚¹çš„ä»·æ ¼ä¸º [9, 11, 8, 5, 7, 12, 16, 14]ã€‚</p><p>å¦‚æœæˆ‘ä»¬èƒ½åœ¨ä»·æ ¼ä¸º 5 çš„æ—¶å€™ä¹°å…¥å¹¶åœ¨ä»·æ ¼ä¸º 16 æ—¶å–å‡ºï¼Œåˆ™èƒ½æ”¶è·æœ€å¤§çš„åˆ©æ¶¦ 11ã€‚<br><a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><hr><p>è‚¡ç¥¨æœ€å¤§åˆ©æ¶¦ï¼Œå…¶å®å°±æ˜¯ä¸ªä»å¤´åˆ°å°¾ä¸€ç›´æ›´æ–°æœ€å¤§åˆ©æ¶¦ã€‚æœ€å¤§åˆ©æ¶¦ = Math.max(å‰é¢çš„æœ€å¤§åˆ©æ¶¦ï¼Œå½“å‰è‚¡ç¥¨ä»·æ ¼ - å‰é¢æœ€ä½ä»·æ ¼)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> min = nums[<span class="number">0</span>], maxProfit = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        min = Math.min(min, nums[i]);</span><br><span class="line">        maxProfit = Math.max(maxProfit, nums[i] - min);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxProfit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å‡è®¾æŠŠæŸè‚¡ç¥¨çš„ä»·æ ¼æŒ‰ç…§æ—¶é—´å…ˆåé¡ºåºå­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œè¯·é—®ä¹°å– ä¸€æ¬¡ è¯¥è‚¡ç¥¨å¯èƒ½è·å¾—çš„åˆ©æ¶¦æ˜¯å¤šå°‘ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ä¸€åªè‚¡ç¥¨åœ¨æŸäº›æ—¶é—´èŠ‚ç‚¹çš„ä»·æ ¼ä¸º [9, 11, 8, 5, 7, 12, 16, 14]ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬èƒ½åœ¨ä»·æ ¼ä¸º 5 çš„æ—¶å€™ä¹°å…¥å¹¶åœ¨ä»·æ ¼ä¸º 16 æ—¶å–
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>2020 æ–°å¹´å¿«ä¹</title>
    <link href="https://razertory.me/2020/01/01/happy-new-year-2020/"/>
    <id>https://razertory.me/2020/01/01/happy-new-year-2020/</id>
    <published>2020-01-01T04:25:41.000Z</published>
    <updated>2020-03-28T13:02:10.016Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨æ˜¯ 2020 å¹´çš„ä¸€æœˆä¸€æ—¥ï¼Œå’Œæ™®é€šæ”¾å‡çš„æ—¥å¸¸ä¸€æ ·ï¼š1. KFCï¼Œ2.ç”µè„‘ï¼Œ 3.çœ‹ä¹¦/ç¼–ç¨‹ã€‚å’Œä¹‹å‰ä¸ä¸€æ ·çš„æ˜¯ï¼Œå’–å•¡ç‚¹çš„æ˜¯åŠ å†°çš„ç¾å¼ã€‚å›æƒ³èµ·è¿‡å»çš„ä¸€å¹´ï¼Œä¸åœ¨åŠå…¬å®¤çš„æ—¶å€™ï¼Œæˆ‘é€šå¸¸ä¹Ÿä¼šå»æ‰¾ä¸€ä¸ªåœ°æ–¹å­¦ä¹ ï¼Œå¸¸åšçš„äº‹æƒ…æœ‰</p><ul><li>åˆ·è¯¾ã€‚MIT 6.824ã€SICP é‚£ç§</li><li>åˆ· OJã€‚é€šå¸¸æ˜¯ Leetcode æˆ–è€… codewarsï¼Œå…¶ä¸­åœ¨ leetcode ä¸Šæ‰“äº†ä¸€æ®µæ—¶é—´çš„å‘¨èµ›</li><li>çœ‹ä¹¦ã€‚é€šå¸¸éƒ½æ˜¯è®¡ç®—æœºç›¸å…³çš„ä¹¦ç±ï¼Œæœ€è¿‘çœ‹çš„æ˜¯ FP ç›¸å…³</li><li>å†™åšå®¢ã€‚å’Œç°åœ¨ä¸€æ ·</li></ul><p>è¿™äº›äº‹æƒ…éƒ½æ˜¯æˆ‘æ¢ä¸ªäººå–œæ¬¢åšçš„ï¼Œä½†æ˜¯å¯¹å¤–å´æœ‰ä¼˜å…ˆçº§ã€‚æ¯”å¦‚è¯´å¦‚æœæˆ‘æœ€è¿‘è¦å‚åŠ é¢è¯•ï¼Œæˆ‘å¯èƒ½ä¼šèŠ±æ›´å¤šçš„æ—¶é—´åœ¨åˆ· OJï¼›å¦‚æœæˆ‘æœ€è¿‘è¦ç”¨ä¸€é—¨æ–°è¯­è¨€/æ¡†æ¶ï¼Œæˆ‘å¯èƒ½ä¼šé€‰æ‹©çœ‹ä¹¦ï¼›å¦‚æœæˆ‘æœ€è¿‘æ—¶é—´æ¯”è¾ƒå……è£•ä¸”æ²¡æœ‰å¤–éƒ¨çš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä¼šåƒç°åœ¨ä¸€æ ·å†™åšå®¢æˆ–è€…ç”¨ä¸€æ®µè¿ç»­ä¸”è¶³å¤Ÿé•¿çš„æ—¶é—´æ¥åˆ·è¯¾ç¨‹ã€‚</p><p>è¿™ä¹ˆåšæ—¢æ»¡è¶³äº†è‡ªå·±çš„å–œå¥½ï¼Œä¹Ÿèƒ½å¤Ÿæ ¹æ®å¤–éƒ¨çš„çŠ¶æ€åŠè°ƒæ•´ã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘è¶Šæ¥è¶Šè§‰å¾—è‡ªå·±å³å°†æˆä¸ºé‚£ç§å¾ˆæ ‡å‡†çš„ã€ŒèŒåœºç å†œã€ã€‚å¿«é€Ÿå®Œæˆå¤–éƒ¨çš„éœ€æ±‚ï¼Œç»™å›¢é˜Ÿå¸¦æ¥ä»·å€¼ï¼Œå¿«é€Ÿå­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯ï¼Œå¿«é€Ÿè¡¥å¿æŠ€æœ¯å€ºã€‚ä½†æ˜¯æˆ‘è‡ªå·±ä¹Ÿä¸å¾—ä¸æ‰¿è®¤ï¼Œå› ä¸ºè¿™ç§ç­–ç•¥ï¼Œæˆ‘åˆ°ç›®å‰æ²¡æœ‰é‚£ç§èƒ½åšåˆ° top çš„äº‹æƒ…ã€‚é¦–å…ˆè§£é‡Šä¸€ä¸‹åšåˆ° topï¼šæ¯”å¦‚è¯´åˆ· OJï¼Œæˆ‘å¯ä»¥é€šè¿‡å‘¨èµ›æˆ–è€…è‡ªå·±çš„ç§¯åˆ†æ’åæ¥åˆ¤æ–­ï¼Œæˆ–è€…æˆ‘å¯ä»¥å»ç»™æŸä¸ªçŸ¥åå¼€æºçš„æ¡†æ¶åšè´¡çŒ®ï¼Œé€šè¿‡ contributors æ’åæ¥çœ‹è‡ªå·±åšçš„ç¨‹åº¦ã€‚åšåˆ° top æœ‰æ—¶å€™ä¸ä»…ä»…æ˜¯å› ä¸ºè‡ªå·±å¤šå¤šå°‘å°‘æœ‰ã€Œè¿½åé€åˆ©ã€çš„æƒ…ç»“ï¼Œæ›´å› ä¸ºæˆ‘åšæŒè®¤ä¸ºï¼Œå¦‚æœå–œæ¬¢åšä¸€ä»¶äº‹æƒ…ï¼Œè‚¯å®šæœ‰æŠŠäº‹æƒ…åšå¥½çš„æ„æ„¿ï¼Œé‚£ä¹ˆåªè¦ä¸æ–­åšæŒåšè‡ªç„¶å°±ä¼šåšåˆ° topã€‚</p><p>å‰æ®µæ—¶é—´çš„ä¸€ä¸ªå‘¨æœ«ï¼Œæˆ‘å»äº†ä¸€å®¶æ‘Šé¥¼åº—ï¼Œæ‹ä¸‹äº†ä¸€è¡Œå­—</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/mw690/a67b702fgy1gagzjtfpp5j20u01407fd.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>å¦‚æœè¯´ï¼Œä¸€ä¸ªäººå¯ä»¥ä¸€è¾ˆå­ä¸“æ³¨äºä¸€ä»¶äº‹æƒ…ä¸Šï¼Œå¹¶ä¸”ä¸ä¼šè¢«åˆ«çš„äº‹æƒ…æ‰€å¹²æ‰°æˆ–è€…è¯±æƒ‘åº”è¯¥æ˜¯éå¸¸å€¼å¾—ç¾¡æ…•çš„ã€‚å¯æ˜¯å¦‚æœç”¨èµ„æœ¬å®¶çš„çœ¼å…‰å»çœ‹å¾…è¿™ä¸ªï¼Œè‚¯å®šä¼šè®©äººè§‰å¾—è¿™ä¸ªäººåªçŸ¥é“æ‰“å·¥(è¿™é‡Œä¸æŠŠæ‰“å·¥åšè´¬ä¹‰)ã€‚æˆ‘è®°å¾—åœ¨ã€Œæ³°å›§ã€ç”µå½±é‡Œé¢æœ‰ä¸ªå¯¹ç™½</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/mw690/a67b702fgy1gah030l1rhj20rs0doq4n.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://ww1.sinaimg.cn/mw690/a67b702fgy1gah03e89o2j20rt0dt40p.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>èµ„æœ¬å®¶çƒ­çˆ±ã€ŒæŒ£é’±ã€æœ¬èº«è¿™ä»¶äº‹æƒ…ï¼Œæ‰€ä»¥ä¼šç”¨ç»è¥ã€æ‰©å¼ çš„çœ¼å…‰å»çœ‹å¾…åšè‘±æ²¹é¥¼ã€‚è‘±æ²¹é¥¼å°å“¥è¯´ç§˜æ–¹å°±æ˜¯è¦è‡ªå·±äº²è‡ªåšï¼Œæ–°é²œå‡ºç‚‰ï¼Œè¿™æ˜¯çƒ­çˆ±åšè‘±æ²¹é¥¼äººçš„çœ¼å…‰ã€‚ä¸è¿‡è¿™ä¸ªä¸–ç•Œå°±æ˜¯éœ€è¦è¿™ä¸¤ç§äººã€‚</p><p>å¦‚æœæŠŠã€Œåšè‘±æ²¹é¥¼ã€æ¢æˆã€Œå†™ä»£ç ã€ï¼Œè¿™ä¸ªå¯¹ç™½äº§ç”Ÿçš„æ•ˆæœåº”è¯¥æ˜¯ç±»ä¼¼çš„ã€‚</p><p>æˆ‘æƒ³è¯´ä¸è®ºæ˜¯ä¸ºäº†æ›´é«˜çš„è–ªæ°´ä¸æ–­å­¦ä¹ ï¼Œè¿˜æ˜¯å› ä¸ºçƒ­çˆ±ç¼–ç¨‹æœ¬èº«ä¸æ–­å­¦ä¹ ï¼Œè¿™ä¸¤è€…åº”è¯¥æ˜¯éƒ½è¢«è®¤å¯çš„ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸¤ç§åŠ¨æœºåº”è¯¥æ˜¯éƒ½å­˜åœ¨çš„ï¼Œæˆ–è€…è¯´äººæœ¬èº«å°±æ˜¯è¿™æ ·çš„ï¼Œæ—¢å¸Œæœ›åšçš„äº‹æƒ…æ˜¯è‡ªå·±å–œæ¬¢çš„ï¼Œä¹Ÿå¸Œæœ›åšçš„äº‹æƒ…èƒ½ç»™è‡ªå·±å¸¦æ¥æ›´å¤šæ”¶å…¥ã€‚</p><p>2020å¹´ï¼Œæˆ‘ä»¬æ˜¯é‡æ€§å’Œæ–‡æ˜å…±å­˜çš„ã€‚</p><p>æ–°å¹´å¿«ä¹ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç°åœ¨æ˜¯ 2020 å¹´çš„ä¸€æœˆä¸€æ—¥ï¼Œå’Œæ™®é€šæ”¾å‡çš„æ—¥å¸¸ä¸€æ ·ï¼š1. KFCï¼Œ2.ç”µè„‘ï¼Œ 3.çœ‹ä¹¦/ç¼–ç¨‹ã€‚å’Œä¹‹å‰ä¸ä¸€æ ·çš„æ˜¯ï¼Œå’–å•¡ç‚¹çš„æ˜¯åŠ å†°çš„ç¾å¼ã€‚å›æƒ³èµ·è¿‡å»çš„ä¸€å¹´ï¼Œä¸åœ¨åŠå…¬å®¤çš„æ—¶å€™ï¼Œæˆ‘é€šå¸¸ä¹Ÿä¼šå»æ‰¾ä¸€ä¸ªåœ°æ–¹å­¦ä¹ ï¼Œå¸¸åšçš„äº‹æƒ…æœ‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ·è¯¾ã€‚MIT 6.824ã€SICP
      
    
    </summary>
    
    
      <category term="æ€è€ƒ" scheme="https://razertory.me/tags/%E6%80%9D%E8%80%83/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰åºæ•°ç»„è½¬åŒ–ä¸ºå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰</title>
    <link href="https://razertory.me/2019/12/12/sorted-arr-to-bst/"/>
    <id>https://razertory.me/2019/12/12/sorted-arr-to-bst/</id>
    <published>2019-12-12T13:41:57.000Z</published>
    <updated>2020-03-28T13:02:10.016Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ å‡åºæ’åˆ—ï¼Œè¯•å°†è¯¥æ•°ç»„è½¬æ¢ä¸ºä¸€æ£µå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆBalanced Binary Search Treeï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">TreeNode <span class="title">convertToBST</span><span class="params">(ArrayList&lt;Integer&gt; arr)</span></span></span><br></pre></td></tr></table></figure><p>æ ¹æ® BST çš„å®šä¹‰ <em>äºŒå‰æ’åºæ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹å’Œæ¬¡ä¼˜äºŒå‰æ ‘ç±»ä¼¼ï¼Œé€šå¸¸é‡‡å–äºŒå‰é“¾è¡¨ä½œä¸ºäºŒå‰æ’åºæ ‘çš„å­˜å‚¨ç»“æ„ã€‚ä¸­åºéå†äºŒå‰æ’åºæ ‘å¯å¾—åˆ°ä¸€ä¸ªå…³é”®å­—çš„æœ‰åºåºåˆ—ï¼Œä¸€ä¸ªæ— åºåºåˆ—å¯ä»¥é€šè¿‡æ„é€ ä¸€æ£µäºŒå‰æ’åºæ ‘å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ„é€ æ ‘çš„è¿‡ç¨‹å³ä¸ºå¯¹æ— åºåºåˆ—è¿›è¡Œæ’åºçš„è¿‡ç¨‹ã€‚æ¯æ¬¡æ’å…¥çš„æ–°çš„ç»“ç‚¹éƒ½æ˜¯äºŒå‰æ’åºæ ‘ä¸Šæ–°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸å¿…ç§»åŠ¨å…¶å®ƒç»“ç‚¹ï¼Œåªéœ€æ”¹åŠ¨æŸä¸ªç»“ç‚¹çš„æŒ‡é’ˆï¼Œç”±ç©ºå˜ä¸ºéç©ºå³å¯ã€‚æœç´¢,æ’å…¥,åˆ é™¤çš„å¤æ‚åº¦ç­‰äºæ ‘é«˜ï¼ŒO(log(n)).</em> å¯ä»¥å¯¹å…¶è¿›è¡Œåä¸­åºçš„éå†ã€‚ä¹Ÿå°±æ˜¯ ä¸­-å·¦-å³ çš„ä¸€ä¸ªé€†å‘è¿‡ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">TreeNode <span class="title">convertToBST</span><span class="params">(ArrayList&lt;Integer&gt; arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arr == <span class="keyword">null</span> || arr.length == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> convert(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">TreeNode <span class="title">convert</span><span class="params">(ArrayList&lt;Integer&gt; arr, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (start &gt; end) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = start + (end - start) / <span class="number">2</span>;</span><br><span class="line">    TreeNode node = <span class="keyword">new</span> TreeNode(arr[mid]);</span><br><span class="line">    node.left = convert(arr, start, mid - <span class="number">1</span>);</span><br><span class="line">    node.right = convert(arr, mid + <span class="number">1</span>, end);</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç»™å®šä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ å‡åºæ’åˆ—ï¼Œè¯•å°†è¯¥æ•°ç»„è½¬æ¢ä¸ºä¸€æ£µå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆBalanced Binary Search Treeï¼‰ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>é«˜çº§ç±»å‹</title>
    <link href="https://razertory.me/2019/12/01/scala-school-advanced-types/"/>
    <id>https://razertory.me/2019/12/01/scala-school-advanced-types/</id>
    <published>2019-12-01T03:20:54.000Z</published>
    <updated>2020-05-04T07:02:15.759Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è§†ç•Œï¼ˆView-Bound-â€œç±»å‹ç±»â€ï¼‰"><a href="#è§†ç•Œï¼ˆView-Bound-â€œç±»å‹ç±»â€ï¼‰" class="headerlink" title="è§†ç•Œï¼ˆView Bound â€œç±»å‹ç±»â€ï¼‰"></a>è§†ç•Œï¼ˆView Bound â€œç±»å‹ç±»â€ï¼‰</h3><p>æœ‰æ—¶å€™ï¼Œä½ å¹¶ä¸éœ€è¦æŒ‡å®šä¸€ä¸ªç±»å‹æ˜¯ç­‰/å­/è¶…äºå¦ä¸€ä¸ªç±»ï¼Œä½ å¯ä»¥é€šè¿‡è½¬æ¢è¿™ä¸ªç±»æ¥ä¼ªè£…è¿™ç§å…³è”å…³ç³»ã€‚ä¸€ä¸ªè§†ç•ŒæŒ‡å®šä¸€ä¸ªç±»å‹å¯ä»¥è¢«â€œçœ‹ä½œæ˜¯â€å¦ä¸€ä¸ªç±»å‹ã€‚è¿™å¯¹å¯¹è±¡çš„åªè¯»æ“ä½œæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p><p>éšå¼ (<code>implicit</code>) å‡½æ•°å…è®¸ç±»å‹è‡ªåŠ¨è½¬æ¢ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¦‚æœéšå¼å‡½æ•°æœ‰åŠ©äºæ»¡è¶³ç±»å‹æ¨æ–­æ—¶ï¼Œéšå¼å‡½æ•°å¯ä»¥æŒ‰éœ€åœ°åº”ç”¨ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">strToInt</span></span>(x: <span class="type">String</span>) = x.toInt</span><br><span class="line">strToInt: (x: <span class="type">String</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="string">"123"</span></span><br><span class="line">res0: java.lang.<span class="type">String</span> = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> y: <span class="type">Int</span> = <span class="string">"123"</span></span><br><span class="line">y: <span class="type">Int</span> = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">scala&gt; math.max(<span class="string">"123"</span>, <span class="number">111</span>)</span><br><span class="line">res1: <span class="type">Int</span> = <span class="number">123</span></span><br></pre></td></tr></table></figure><p>è§†ç•Œï¼Œå°±åƒç±»å‹è¾¹ç•Œï¼Œè¦æ±‚å­˜åœ¨ä¸€ä¸ªèƒ½å¤Ÿå°†æŸç±»å‹è½¬æ¢ä¸ºæŒ‡å®šç±»å‹çš„å‡½æ•°ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>&lt;%</code> æŒ‡å®šç±»å‹é™åˆ¶ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Container</span>[<span class="type">A</span> &lt;% <span class="type">Int</span>] </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">addIt</span></span>(x: <span class="type">A</span>) = <span class="number">123</span> + x &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Container</span></span></span><br><span class="line"><span class="class"><span class="title">è¿™æ˜¯è¯´</span> <span class="title">A</span> <span class="title">å¿…é¡»â€œå¯è¢«è§†ä½œâ€</span> <span class="title">Int</span> <span class="title">ã€‚è®©æˆ‘ä»¬è¯•è¯•ã€‚</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> (<span class="params">new <span class="type">Container</span>[<span class="type">String</span>]</span>).<span class="title">addIt</span>(<span class="params">"123"</span>)</span></span><br><span class="line"><span class="class"><span class="title">res11</span></span>: <span class="type">Int</span> = <span class="number">246</span></span><br><span class="line"></span><br><span class="line">scala&gt; (<span class="keyword">new</span> <span class="type">Container</span>[<span class="type">Int</span>]).addIt(<span class="number">123</span>) </span><br><span class="line">res12: <span class="type">Int</span> = <span class="number">246</span></span><br><span class="line"></span><br><span class="line">scala&gt; (<span class="keyword">new</span> <span class="type">Container</span>[<span class="type">Float</span>]).addIt(<span class="number">123.2</span>F)</span><br><span class="line">&lt;console&gt;:<span class="number">8</span>: error: could not find <span class="keyword">implicit</span> value <span class="keyword">for</span> evidence parameter of <span class="class"><span class="keyword">type</span> (<span class="params"><span class="type">Float</span></span>) <span class="title">=&gt;</span> <span class="title">Int</span></span></span><br><span class="line"><span class="class">       (<span class="params">new <span class="type">Container</span>[<span class="type">Float</span>]</span>).<span class="title">addIt</span>(<span class="params">123.2</span>)</span></span><br><span class="line"><span class="class">        <span class="title">^</span></span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼Œæ–°ç‰ˆæœ¬çš„ Scala å¯èƒ½ä¼šæç¤ºï¼š  view bounds are deprecated; use an implicit parameter instead.</p></blockquote><h3 id="å…¶ä»–ç±»å‹é™åˆ¶"><a href="#å…¶ä»–ç±»å‹é™åˆ¶" class="headerlink" title="å…¶ä»–ç±»å‹é™åˆ¶"></a>å…¶ä»–ç±»å‹é™åˆ¶</h3><p>æ–¹æ³•å¯ä»¥é€šè¿‡éšå¼å‚æ•°æ‰§è¡Œæ›´å¤æ‚çš„ç±»å‹é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒList æ”¯æŒå¯¹æ•°å­—å†…å®¹æ‰§è¡Œ sumï¼Œä½†å¯¹å…¶ä»–å†…å®¹å´ä¸è¡Œã€‚å¯æ˜¯ Scala çš„æ•°å­—ç±»å‹å¹¶ä¸éƒ½å…±äº«ä¸€ä¸ªè¶…ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ <code>T &lt;: Number</code>ã€‚ç›¸åï¼Œè¦ä½¿ä¹‹èƒ½å·¥ä½œï¼ŒScala çš„ math åº“å¯¹é€‚å½“çš„ç±»å‹ T å®šä¹‰äº†ä¸€ä¸ªéšå«çš„ <code>Numeric[T]</code>ã€‚ ç„¶ååœ¨ List å®šä¹‰ä¸­ä½¿ç”¨å®ƒï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum[<span class="type">B</span> &gt;: <span class="type">A</span>](<span class="keyword">implicit</span> num: <span class="type">Numeric</span>[<span class="type">B</span>]): <span class="type">B</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è°ƒç”¨ List(1,2).sum()ï¼Œä½ å¹¶ä¸éœ€è¦ä¼ å…¥ä¸€ä¸ª num å‚æ•°ï¼›å®ƒæ˜¯éšå¼è®¾ç½®çš„ã€‚ä½†å¦‚æœä½ è°ƒç”¨ List(â€œwhoopâ€).sum()ï¼Œå®ƒä¼šæŠ±æ€¨æ— æ³•è®¾ç½® numã€‚</p><p>åœ¨æ²¡æœ‰è®¾å®šé™Œç”Ÿçš„å¯¹è±¡ä¸º Numeric çš„æ—¶å€™ï¼Œæ–¹æ³•å¯èƒ½ä¼šè¦æ±‚æŸç§ç‰¹å®šç±»å‹çš„â€œè¯æ®â€ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹<code>ç±»å‹-å…³ç³»è¿ç®—ç¬¦</code>ï¼š</p><ul><li>A <code>=:=</code> B    A å¿…é¡»å’Œ B ç›¸ç­‰</li><li>A <code>&lt;:&lt;</code> B    A å¿…é¡»æ˜¯ B çš„å­ç±»</li><li>A <code>&lt;%&lt;</code> B    A å¿…é¡»å¯ä»¥è¢«çœ‹åšæ˜¯ B</li></ul><p>ï¼ˆå¦‚æœä½ åœ¨å°è¯•ä½¿ç”¨ <code>&lt;:&lt;</code> æˆ–è€… <code>&lt;%&lt;</code> çš„æ—¶å€™å‡ºé”™äº†ï¼Œé‚£è¯·æ³¨æ„è¿™äº›ç¬¦å·åœ¨ Scala 2.10 ä¸­è¢«ç§»é™¤äº†ã€‚Scala School é‡Œçš„ä¾‹å­ä»…èƒ½åœ¨ Scala 2.9.x ä¸‹æ­£å¸¸å·¥ä½œã€‚ä½ å¯ä»¥ä½¿ç”¨æ–°ç‰ˆæœ¬çš„ Scalaï¼Œä½†å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ã€‚ï¼‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Container</span>[<span class="type">A</span>](<span class="params">value: <span class="type">A</span></span>) </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">addIt</span></span>(<span class="keyword">implicit</span> evidence: <span class="type">A</span> =:= <span class="type">Int</span>) = <span class="number">123</span> + value &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Container</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> (<span class="params">new <span class="type">Container</span>(123</span>)).<span class="title">addIt</span></span></span><br><span class="line"><span class="class"><span class="title">res11</span></span>: <span class="type">Int</span> = <span class="number">246</span></span><br><span class="line"></span><br><span class="line">scala&gt; (<span class="keyword">new</span> <span class="type">Container</span>(<span class="string">"123"</span>)).addIt</span><br><span class="line">&lt;console&gt;:<span class="number">10</span>: error: could not find <span class="keyword">implicit</span> value <span class="keyword">for</span> parameter evidence: =:=[java.lang.<span class="type">String</span>,<span class="type">Int</span>]</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼åœ°ï¼Œæ ¹æ®ä¹‹å‰çš„éšå¼è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥å°†çº¦æŸæ”¾æ¾ä¸ºå¯è§†æ€§ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Container</span>[<span class="type">A</span>](<span class="params">value: <span class="type">A</span></span>) </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">addIt</span></span>(<span class="keyword">implicit</span> evidence: <span class="type">A</span> &lt;%&lt; <span class="type">Int</span>) = <span class="number">123</span> + value &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Container</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> (<span class="params">new <span class="type">Container</span>("123"</span>)).<span class="title">addIt</span></span></span><br><span class="line"><span class="class"><span class="title">res15</span></span>: <span class="type">Int</span> = <span class="number">246</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è§†å›¾ (View) è¿›è¡Œæ³›å‹ç¼–ç¨‹<br>åœ¨ Scala æ ‡å‡†åº“ä¸­ï¼Œè§†å›¾ä¸»è¦ç”¨äºå®ç°é›†åˆçš„é€šç”¨å‡½æ•°ã€‚ä¾‹å¦‚ <code>min</code> å‡½æ•°ï¼ˆåœ¨ <code>Seq[]</code> ä¸Šï¼‰å°±ä½¿ç”¨äº†è¿™ç§æŠ€æœ¯ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">min</span></span>[<span class="type">B</span> &gt;: <span class="type">A</span>](<span class="keyword">implicit</span> cmp: <span class="type">Ordering</span>[<span class="type">B</span>]): <span class="type">A</span> = &#123;</span><br><span class="line">  <span class="keyword">if</span> (isEmpty)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">UnsupportedOperationException</span>(<span class="string">"empty.min"</span>)</span><br><span class="line"></span><br><span class="line">  reduceLeft((x, y) =&gt; <span class="keyword">if</span> (cmp.lteq(x, y)) x <span class="keyword">else</span> y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼š</p><p>é›†åˆä¸­çš„å…ƒç´ ä¸å¿…å®ç° Ordered traitï¼Œä½† Ordered çš„ä½¿ç”¨ä»ç„¶å¯ä»¥æ‰§è¡Œé™æ€ç±»å‹æ£€æŸ¥ã€‚<br>æ— éœ€ä»»ä½•é¢å¤–çš„åº“æ”¯æŒï¼Œä½ ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„æ’åºï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).min</span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>).min(<span class="keyword">new</span> <span class="type">Ordering</span>[<span class="type">Int</span>] &#123; <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>) = b compare a &#125;)</span><br><span class="line">res3: <span class="type">Int</span> = <span class="number">4</span></span><br></pre></td></tr></table></figure><p>ä½œä¸ºæ—æ³¨ï¼Œæ ‡å‡†åº“ä¸­æœ‰è§†å›¾æ¥å°† Ordered è½¬æ¢ä¸º <code>Ordering</code>ï¼ˆåä¹‹äº¦ç„¶ï¼‰ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">LowPriorityOrderingImplicits</span> </span>&#123;</span><br><span class="line">  <span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">ordered</span></span>[<span class="type">A</span> &lt;: <span class="type">Ordered</span>[<span class="type">A</span>]]: <span class="type">Ordering</span>[<span class="type">A</span>] = <span class="keyword">new</span> <span class="type">Ordering</span>[<span class="type">A</span>] &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(x: <span class="type">A</span>, y: <span class="type">A</span>) = x.compare(y)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸Šä¸‹æ–‡è¾¹ç•Œå’Œ-implicitly"><a href="#ä¸Šä¸‹æ–‡è¾¹ç•Œå’Œ-implicitly" class="headerlink" title="ä¸Šä¸‹æ–‡è¾¹ç•Œå’Œ implicitly[]"></a>ä¸Šä¸‹æ–‡è¾¹ç•Œå’Œ implicitly[]</h3><p>Scala 2.8 å¼•å…¥äº†ä¸€ç§ä¸²è”å’Œè®¿é—®éšå¼å‚æ•°çš„ç®€å•è®°æ³•ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>[<span class="type">A</span>](<span class="keyword">implicit</span> x: <span class="type">Ordered</span>[<span class="type">A</span>]) &#123;&#125;</span><br><span class="line">foo: [<span class="type">A</span>](<span class="keyword">implicit</span> x: <span class="type">Ordered</span>[<span class="type">A</span>])<span class="type">Unit</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>[<span class="type">A</span> : <span class="type">Ordered</span>] &#123;&#125;                        </span><br><span class="line">foo: [<span class="type">A</span>](<span class="keyword">implicit</span> evidence$<span class="number">1</span>: <span class="type">Ordered</span>[<span class="type">A</span>])<span class="type">Unit</span></span><br></pre></td></tr></table></figure><p>éšå¼å€¼å¯ä»¥é€šè¿‡ <code>implicitly</code> è¢«è®¿é—®</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; implicitly[<span class="type">Ordering</span>[<span class="type">Int</span>]]</span><br><span class="line">res37: <span class="type">Ordering</span>[<span class="type">Int</span>] = scala.math.<span class="type">Ordering</span>$<span class="type">Int</span>$@<span class="number">3</span>a9291cf</span><br></pre></td></tr></table></figure><p>ç›¸ç»“åˆåå¾€å¾€ä¼šä½¿ç”¨æ›´å°‘çš„ä»£ç ï¼Œå°¤å…¶æ˜¯ä¸²è”è§†å›¾çš„æ—¶å€™ã€‚</p><h3 id="é«˜é˜¶å¤šæ€æ€§ç±»å‹å’Œç‰¹è®¾å¤šæ€æ€§"><a href="#é«˜é˜¶å¤šæ€æ€§ç±»å‹å’Œç‰¹è®¾å¤šæ€æ€§" class="headerlink" title="é«˜é˜¶å¤šæ€æ€§ç±»å‹å’Œç‰¹è®¾å¤šæ€æ€§"></a>é«˜é˜¶å¤šæ€æ€§ç±»å‹å’Œç‰¹è®¾å¤šæ€æ€§</h3><p>Scala å¯ä»¥å¯¹â€œé«˜é˜¶â€çš„ç±»å‹è¿›è¡ŒæŠ½è±¡ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ éœ€è¦ç”¨å‡ ç§ç±»å‹çš„å®¹å™¨å¤„ç†å‡ ç§ç±»å‹çš„æ•°æ®ã€‚ä½ å¯èƒ½å®šä¹‰äº†ä¸€ä¸ª Container çš„æ¥å£ï¼Œå®ƒå¯ä»¥è¢«å®ç°ä¸ºå‡ ç§ç±»å‹çš„å®¹å™¨ï¼šOptionã€List ç­‰ã€‚ä½ è¦å®šä¹‰å¯ä»¥ä½¿ç”¨è¿™äº›å®¹å™¨é‡Œçš„å€¼çš„æ¥å£ï¼Œä½†ä¸æƒ³ç¡®å®šå€¼çš„ç±»å‹ã€‚</p><p>è¿™ç±»ä¼¼äºå‡½æ•°æŸ¯é‡ŒåŒ–ã€‚ä¾‹å¦‚ï¼Œå°½ç®¡â€œä¸€å…ƒç±»å‹â€æœ‰ç±»ä¼¼ List[A] çš„æ„é€ å™¨ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ»¡è¶³ä¸€ä¸ªâ€œçº§åˆ«â€çš„ç±»å‹å˜é‡æ¥äº§ç”Ÿä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼ˆå°±åƒä¸€ä¸ªæ²¡æœ‰æŸ¯é‡ŒåŒ–çš„å‡½æ•°éœ€è¦åªæä¾›ä¸€ä¸ªå‚æ•°åˆ—è¡¨æ¥è¢«è°ƒç”¨ï¼‰ï¼Œæ›´é«˜é˜¶çš„ç±»å‹éœ€è¦æ›´å¤šã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">trait</span> <span class="title">Container</span>[<span class="type">M</span>[_]] </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>[<span class="type">A</span>](x: <span class="type">A</span>): <span class="type">M</span>[<span class="type">A</span>]; <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>[<span class="type">A</span>](m: <span class="type">M</span>[<span class="type">A</span>]): <span class="type">A</span> &#125;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> container = <span class="keyword">new</span> <span class="type">Container</span>[<span class="type">List</span>] &#123; <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>[<span class="type">A</span>](x: <span class="type">A</span>) = <span class="type">List</span>(x); <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>[<span class="type">A</span>](m: <span class="type">List</span>[<span class="type">A</span>]) = m.head &#125;</span><br><span class="line">container: java.lang.<span class="type">Object</span> <span class="keyword">with</span> <span class="type">Container</span>[<span class="type">List</span>] = $anon$<span class="number">1</span>@<span class="number">7</span>c8e3f75</span><br><span class="line"></span><br><span class="line">scala&gt; container.put(<span class="string">"hey"</span>)</span><br><span class="line">res24: <span class="type">List</span>[java.lang.<span class="type">String</span>] = <span class="type">List</span>(hey)</span><br><span class="line"></span><br><span class="line">scala&gt; container.put(<span class="number">123</span>)</span><br><span class="line">res25: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">123</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<em>Container</em> æ˜¯å‚æ•°åŒ–ç±»å‹çš„å¤šæ€ï¼ˆâ€œå®¹å™¨ç±»å‹â€ï¼‰ã€‚</p><p>å¦‚æœæˆ‘ä»¬ç»“åˆéšå¼è½¬æ¢ implicits ä½¿ç”¨å®¹å™¨ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°â€œç‰¹è®¾çš„â€å¤šæ€æ€§ï¼šå³å¯¹å®¹å™¨å†™æ³›å‹å‡½æ•°çš„èƒ½åŠ›ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">trait</span> <span class="title">Container</span>[<span class="type">M</span>[_]] </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>[<span class="type">A</span>](x: <span class="type">A</span>): <span class="type">M</span>[<span class="type">A</span>]; <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>[<span class="type">A</span>](m: <span class="type">M</span>[<span class="type">A</span>]): <span class="type">A</span> &#125;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">implicit</span> <span class="keyword">val</span> listContainer = <span class="keyword">new</span> <span class="type">Container</span>[<span class="type">List</span>] &#123; <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>[<span class="type">A</span>](x: <span class="type">A</span>) = <span class="type">List</span>(x); <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>[<span class="type">A</span>](m: <span class="type">List</span>[<span class="type">A</span>]) = m.head &#125;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">implicit</span> <span class="keyword">val</span> optionContainer = <span class="keyword">new</span> <span class="type">Container</span>[<span class="type">Some</span>] &#123; <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>[<span class="type">A</span>](x: <span class="type">A</span>) = <span class="type">Some</span>(x); <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>[<span class="type">A</span>](m: <span class="type">Some</span>[<span class="type">A</span>]) = m.get &#125;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">tupleize</span></span>[<span class="type">M</span>[_]: <span class="type">Container</span>, <span class="type">A</span>, <span class="type">B</span>](fst: <span class="type">M</span>[<span class="type">A</span>], snd: <span class="type">M</span>[<span class="type">B</span>]) = &#123;</span><br><span class="line">     | <span class="keyword">val</span> c = implicitly[<span class="type">Container</span>[<span class="type">M</span>]]                             </span><br><span class="line">     | c.put(c.get(fst), c.get(snd))</span><br><span class="line">     | &#125;</span><br><span class="line">tupleize: [<span class="type">M</span>[_],<span class="type">A</span>,<span class="type">B</span>](fst: <span class="type">M</span>[<span class="type">A</span>],snd: <span class="type">M</span>[<span class="type">B</span>])(<span class="keyword">implicit</span> evidence$<span class="number">1</span>: <span class="type">Container</span>[<span class="type">M</span>])<span class="type">M</span>[(<span class="type">A</span>, <span class="type">B</span>)]</span><br><span class="line"></span><br><span class="line">scala&gt; tupleize(<span class="type">Some</span>(<span class="number">1</span>), <span class="type">Some</span>(<span class="number">2</span>))</span><br><span class="line">res33: <span class="type">Some</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">Some</span>((<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">scala&gt; tupleize(<span class="type">List</span>(<span class="number">1</span>), <span class="type">List</span>(<span class="number">2</span>))</span><br><span class="line">res34: <span class="type">List</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = <span class="type">List</span>((<span class="number">1</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure><h3 id="F-ç•Œå¤šæ€æ€§"><a href="#F-ç•Œå¤šæ€æ€§" class="headerlink" title="F-ç•Œå¤šæ€æ€§"></a>F-ç•Œå¤šæ€æ€§</h3><p>é€šå¸¸æœ‰å¿…è¦æ¥è®¿é—®ä¸€ä¸ªæ³›å‹ trait çš„å…·ä½“å­ç±»ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä½ æœ‰ä¸€äº›æ³›å‹ traitï¼Œä½†éœ€è¦å¯ä»¥ä¸å®ƒçš„æŸä¸€å­ç±»è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Container</span> <span class="keyword">extends</span> <span class="title">Ordered</span>[<span class="type">Container</span>]</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å­ç±»å¿…é¡»å®ç° <code>compare</code> æ–¹æ³•</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">Container</span>): <span class="type">Int</span></span><br></pre></td></tr></table></figure><p>ä½†æˆ‘ä»¬ä¸èƒ½è®¿é—®å…·ä½“å­ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyContainer</span> <span class="keyword">extends</span> <span class="title">Container</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">MyContainer</span>): <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬å¯¹ Container æŒ‡å®šäº† Ordered ç‰¹è´¨ï¼Œè€Œä¸æ˜¯å¯¹ç‰¹å®šå­ç±»å‹æŒ‡å®šçš„ã€‚</p><p>ä¸€ä¸ªå¯é€‰çš„è§£å†³æ–¹æ¡ˆæ˜¯å°† Container å‚æ•°åŒ–ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½åœ¨å­ç±»ä¸­è®¿é—®å…¶å­ç±»å‹ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Container</span>[<span class="type">A</span>] <span class="keyword">extends</span> <span class="title">Ordered</span>[<span class="type">A</span>]</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å­ç±»å¯ä»¥è¿™æ ·åšï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyContainer</span> <span class="keyword">extends</span> <span class="title">Container</span>[<span class="type">MyContainer</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">MyContainer</span>): <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†é—®é¢˜åœ¨äº A ç±»å‹æ²¡æœ‰è¢«ä»»ä½•ä¸œè¥¿çº¦æŸï¼Œè¿™å¯¼è‡´ä½ å¯èƒ½ä¼šåšç±»ä¼¼è¿™æ ·çš„äº‹æƒ…ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyContainer</span> <span class="keyword">extends</span> <span class="title">Container</span>[<span class="type">String</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">String</span>): <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è°ƒå’Œè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ”¹ç”¨ F-ç•Œçš„å¤šæ€æ€§ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Container</span>[<span class="type">A</span> &lt;: <span class="type">Container</span>[<span class="type">A</span>]] <span class="keyword">extends</span> <span class="title">Ordered</span>[<span class="type">A</span>]</span></span><br></pre></td></tr></table></figure><p>å¥‡æ€ªçš„ç±»å‹ï¼ä½†æ³¨æ„ç°åœ¨å¦‚ä½•ç”¨ A ä½œä¸º Ordered çš„ç±»å‹å‚æ•°ï¼Œè€Œ A æœ¬èº«å°±æ˜¯ Container[A]</p><p>æ‰€ä»¥ï¼Œç°åœ¨</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyContainer</span> <span class="keyword">extends</span> <span class="title">Container</span>[<span class="type">MyContainer</span>] </span>&#123; </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">MyContainer</span>) = <span class="number">0</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»–ä»¬æ˜¯æœ‰åºçš„äº†ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="type">List</span>(<span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>)</span><br><span class="line">res3: <span class="type">List</span>[<span class="type">MyContainer</span>] = <span class="type">List</span>(<span class="type">MyContainer</span>@<span class="number">30</span>f02a6d, <span class="type">MyContainer</span>@<span class="number">67717334</span>, <span class="type">MyContainer</span>@<span class="number">49428</span>ffa)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="type">List</span>(<span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>).min</span><br><span class="line">res4: <span class="type">MyContainer</span> = <span class="type">MyContainer</span>@<span class="number">33</span>dfeb30</span><br></pre></td></tr></table></figure><p>é‰´äºä»–ä»¬éƒ½æ˜¯ Container[_] çš„å­ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¦ä¸€ä¸ªå­ç±»å¹¶åˆ›å»º Container[_] çš„ä¸€ä¸ªæ··åˆåˆ—è¡¨ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">YourContainer</span> <span class="keyword">extends</span> <span class="title">Container</span>[<span class="type">YourContainer</span>] </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">YourContainer</span>) = <span class="number">0</span> &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">YourContainer</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">List</span>(<span class="params">new <span class="type">MyContainer</span>, new <span class="type">MyContainer</span>, new <span class="type">MyContainer</span>, new <span class="type">YourContainer</span></span>)                   </span></span><br><span class="line"><span class="class"><span class="title">res2</span></span>: <span class="type">List</span>[<span class="type">Container</span>[_ &gt;: <span class="type">YourContainer</span> <span class="keyword">with</span> <span class="type">MyContainer</span> &lt;: <span class="type">Container</span>[_ &gt;: <span class="type">YourContainer</span> <span class="keyword">with</span> <span class="type">MyContainer</span> &lt;: <span class="type">ScalaObject</span>]]] </span><br><span class="line">  = <span class="type">List</span>(<span class="type">MyContainer</span>@<span class="number">3</span>be5d207, <span class="type">MyContainer</span>@<span class="number">6</span>d3fe849, <span class="type">MyContainer</span>@<span class="number">7</span>eab48a7, <span class="type">YourContainer</span>@<span class="number">1</span>f2f0ce9)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ç°åœ¨ç»“æœç±»å‹æ˜¯ç”± YourContainer with MyContainer ç±»å‹ç¡®å®šçš„ä¸‹ç•Œã€‚è¿™æ˜¯ç±»å‹æ¨æ–­å™¨çš„å·¥ä½œã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™ç§ç±»å‹ç”šè‡³ä¸éœ€è¦æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå®ƒä»…ä»…å¯¹åˆ—è¡¨çš„ç»Ÿä¸€ç±»å‹æä¾›äº†ä¸€ä¸ªé€»è¾‘ä¸Šæœ€ä¼˜çš„ä¸‹ç•Œã€‚å¦‚æœç°åœ¨æˆ‘ä»¬å°è¯•ä½¿ç”¨ Ordered ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">MyContainer</span>, <span class="keyword">new</span> <span class="type">YourContainer</span>).min</span><br><span class="line">&lt;console&gt;:<span class="number">9</span>: error: could not find <span class="keyword">implicit</span> value <span class="keyword">for</span> parameter cmp:</span><br><span class="line">  <span class="type">Ordering</span>[<span class="type">Container</span>[_ &gt;: <span class="type">YourContainer</span> <span class="keyword">with</span> <span class="type">MyContainer</span> &lt;: <span class="type">Container</span>[_ &gt;: <span class="type">YourContainer</span> <span class="keyword">with</span> <span class="type">MyContainer</span> &lt;: <span class="type">ScalaObject</span>]]]</span><br></pre></td></tr></table></figure><p>å¯¹ç»Ÿä¸€çš„ç±»å‹ Ordered[] ä¸å­˜åœ¨äº†ã€‚å¤ªç³Ÿç³•äº†ã€‚</p><h3 id="ç»“æ„ç±»å‹"><a href="#ç»“æ„ç±»å‹" class="headerlink" title="ç»“æ„ç±»å‹"></a>ç»“æ„ç±»å‹</h3><p>Scala æ”¯æŒç»“æ„ç±»å‹ï¼ˆ<code>structural types</code>ï¼‰ â€” ç±»å‹éœ€æ±‚ç”±æ¥å£ç»“æ„è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ç”±å…·ä½“çš„ç±»å‹è¡¨ç¤ºã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(x: &#123; <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>: <span class="type">Int</span> &#125;) = <span class="number">123</span> + x.get</span><br><span class="line">foo: (x: <span class="type">AnyRef</span>&#123;<span class="function"><span class="keyword">def</span> <span class="title">get</span></span>: <span class="type">Int</span>&#125;)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">scala&gt; foo(<span class="keyword">new</span> &#123; <span class="function"><span class="keyword">def</span> <span class="title">get</span> </span>= <span class="number">10</span> &#125;)                 </span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">133</span></span><br></pre></td></tr></table></figure><p>è¿™å¯èƒ½åœ¨å¾ˆå¤šåœºæ™¯éƒ½æ˜¯ç›¸å½“ä¸é”™çš„ï¼Œä½†è¿™ä¸ªå®ç°ä¸­ä½¿ç”¨äº†åå°„ï¼Œæ‰€ä»¥è¦<code>æ³¨æ„æ€§èƒ½</code>ï¼</p><h3 id="æŠ½è±¡ç±»å‹æˆå‘˜"><a href="#æŠ½è±¡ç±»å‹æˆå‘˜" class="headerlink" title="æŠ½è±¡ç±»å‹æˆå‘˜"></a>æŠ½è±¡ç±»å‹æˆå‘˜</h3><p>åœ¨ç‰¹è´¨ä¸­ï¼Œä½ å¯ä»¥è®©ç±»å‹æˆå‘˜ä¿æŒæŠ½è±¡ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">trait</span> <span class="title">Foo</span> </span>&#123; <span class="class"><span class="keyword">type</span> <span class="title">A</span></span>; <span class="keyword">val</span> x: <span class="type">A</span>; <span class="function"><span class="keyword">def</span> <span class="title">getX</span></span>: <span class="type">A</span> = x &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">trait</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> (<span class="params">new <span class="type">Foo</span> &#123; type <span class="type">A</span> = <span class="type">Int</span>; val x = 123 &#125;</span>).<span class="title">getX</span>   </span></span><br><span class="line"><span class="class"><span class="title">res3</span></span>: <span class="type">Int</span> = <span class="number">123</span></span><br><span class="line"></span><br><span class="line">scala&gt; (<span class="keyword">new</span> <span class="type">Foo</span> &#123; <span class="class"><span class="keyword">type</span> <span class="title">A</span> </span>= <span class="type">String</span>; <span class="keyword">val</span> x = <span class="string">"hey"</span> &#125;).getX</span><br><span class="line">res4: java.lang.<span class="type">String</span> = hey</span><br></pre></td></tr></table></figure><p>åœ¨åš<code>ä¾èµ–æ³¨å…¥</code>ç­‰æƒ…å†µä¸‹ï¼Œè¿™å¾€å¾€æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æŠ€å·§ã€‚</p><p>ä½ å¯ä»¥ä½¿ç”¨ hash æ“ä½œç¬¦æ¥å¼•ç”¨ä¸€ä¸ªæŠ½è±¡ç±»å‹çš„å˜é‡ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">trait</span> <span class="title">Foo</span>[<span class="type">M</span>[_]] </span>&#123; <span class="class"><span class="keyword">type</span> <span class="title">t</span>[<span class="type">A</span>] </span>= <span class="type">M</span>[<span class="type">A</span>] &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">trait</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">x</span></span>: <span class="type">Foo</span>[<span class="type">List</span>]#t[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>)</span><br><span class="line">x: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="ç±»å‹æ“¦é™¤å’Œæ¸…å•"><a href="#ç±»å‹æ“¦é™¤å’Œæ¸…å•" class="headerlink" title="ç±»å‹æ“¦é™¤å’Œæ¸…å•"></a>ç±»å‹æ“¦é™¤å’Œæ¸…å•</h3><p>æ­£å¦‚æˆ‘ä»¬æ‰€çŸ¥é“çš„ï¼Œç±»å‹ä¿¡æ¯åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå› ä¸ºæ“¦é™¤è€Œä¸¢å¤±ã€‚ Scala æä¾›äº†æ¸…å•ï¼ˆ<code>Manifests</code>ï¼‰åŠŸèƒ½ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿé€‰æ‹©æ€§åœ°æ¢å¤ç±»å‹ä¿¡æ¯ã€‚æ¸…å•ä½œä¸ºä¸€ä¸ªéšå¼çš„å€¼è¢«æä¾›ï¼Œå®ƒç”±ç¼–è¯‘å™¨æ ¹æ®éœ€è¦ç”Ÿæˆã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">MakeFoo</span>[<span class="type">A</span>](<span class="params">implicit manifest: <span class="type">Manifest</span>[<span class="type">A</span>]</span>) </span>&#123; <span class="function"><span class="keyword">def</span> <span class="title">make</span></span>: <span class="type">A</span> = manifest.erasure.newInstance.asInstanceOf[<span class="type">A</span>] &#125;</span><br><span class="line"></span><br><span class="line">scala&gt; (<span class="keyword">new</span> <span class="type">MakeFoo</span>[<span class="type">String</span>]).make</span><br><span class="line">res10: <span class="type">String</span> = <span class="string">""</span></span><br></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹åˆ†æï¼šFinagle"><a href="#æ¡ˆä¾‹åˆ†æï¼šFinagle" class="headerlink" title="æ¡ˆä¾‹åˆ†æï¼šFinagle"></a>æ¡ˆä¾‹åˆ†æï¼šFinagle</h3><p>å‚è§ï¼š<a href="https://github.com/twitter/finagle" target="_blank" rel="noopener">https://github.com/twitter/finagle</a></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Service</span>[-<span class="type">Req</span>, +<span class="type">Rep</span>] <span class="keyword">extends</span> (<span class="params"><span class="type">Req</span> =&gt; <span class="type">Future</span>[<span class="type">Rep</span>]</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">trait</span> <span class="title">Filter</span>[-<span class="type">ReqIn</span>, +<span class="type">RepOut</span>, +<span class="type">ReqOut</span>, -<span class="type">RepIn</span>]</span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> (<span class="params">(<span class="type">ReqIn</span>, <span class="type">Service</span>[<span class="type">ReqOut</span>, <span class="type">RepIn</span>]</span>) <span class="title">=&gt;</span> <span class="title">Future</span>[<span class="type">RepOut</span>])</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">andThen</span></span>[<span class="type">Req2</span>, <span class="type">Rep2</span>](next: <span class="type">Filter</span>[<span class="type">ReqOut</span>, <span class="type">RepIn</span>, <span class="type">Req2</span>, <span class="type">Rep2</span>]) =</span><br><span class="line">    <span class="keyword">new</span> <span class="type">Filter</span>[<span class="type">ReqIn</span>, <span class="type">RepOut</span>, <span class="type">Req2</span>, <span class="type">Rep2</span>] &#123;</span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(request: <span class="type">ReqIn</span>, service: <span class="type">Service</span>[<span class="type">Req2</span>, <span class="type">Rep2</span>]) = &#123;</span><br><span class="line">        <span class="type">Filter</span>.<span class="keyword">this</span>.apply(request, <span class="keyword">new</span> <span class="type">Service</span>[<span class="type">ReqOut</span>, <span class="type">RepIn</span>] &#123;</span><br><span class="line">          <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(request: <span class="type">ReqOut</span>): <span class="type">Future</span>[<span class="type">RepIn</span>] = next(request, service)</span><br><span class="line">          <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">release</span></span>() = service.release()</span><br><span class="line">          <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">isAvailable</span> </span>= service.isAvailable</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">andThen</span></span>(service: <span class="type">Service</span>[<span class="type">ReqOut</span>, <span class="type">RepIn</span>]) = <span class="keyword">new</span> <span class="type">Service</span>[<span class="type">ReqIn</span>, <span class="type">RepOut</span>] &#123;</span><br><span class="line">    <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">val</span> refcounted = <span class="keyword">new</span> <span class="type">RefcountedService</span>(service)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(request: <span class="type">ReqIn</span>) = <span class="type">Filter</span>.<span class="keyword">this</span>.apply(request, refcounted)</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">release</span></span>() = refcounted.release()</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">isAvailable</span> </span>= refcounted.isAvailable</span><br><span class="line">  &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæœåŠ¡å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨å¯¹è¯·æ±‚è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">RequestWithCredentials</span> <span class="keyword">extends</span> <span class="title">Request</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">credentials</span></span>: <span class="type">Credentials</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CredentialsFilter</span>(<span class="params">credentialsParser: <span class="type">CredentialsParser</span></span>)</span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">Filter</span>[<span class="type">Request</span>, <span class="type">Response</span>, <span class="type">RequestWithCredentials</span>, <span class="type">Response</span>]</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(request: <span class="type">Request</span>, service: <span class="type">Service</span>[<span class="type">RequestWithCredentials</span>, <span class="type">Response</span>]): <span class="type">Future</span>[<span class="type">Response</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> requestWithCredentials = <span class="keyword">new</span> <span class="type">RequestWrapper</span> <span class="keyword">with</span> <span class="type">RequestWithCredentials</span> &#123;</span><br><span class="line">      <span class="keyword">val</span> underlying = request</span><br><span class="line">      <span class="keyword">val</span> credentials = credentialsParser(request) getOrElse <span class="type">NullCredentials</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    service(requestWithCredentials)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åº•å±‚æœåŠ¡æ˜¯å¦‚ä½•éœ€è¦å¯¹è¯·æ±‚è¿›è¡Œèº«ä»½éªŒè¯çš„ï¼Œè€Œä¸”è¿˜æ˜¯é™æ€éªŒè¯ã€‚å› æ­¤ï¼Œè¿‡æ»¤å™¨å¯ä»¥è¢«çœ‹ä½œæ˜¯æœåŠ¡è½¬æ¢å™¨ã€‚</p><p>è®¸å¤šè¿‡æ»¤å™¨å¯ä»¥è¢«ç»„åˆåœ¨ä¸€èµ·ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> upFilter =</span><br><span class="line">  logTransaction     andThen</span><br><span class="line">  handleExceptions   andThen</span><br><span class="line">  extractCredentials andThen</span><br><span class="line">  homeUser           andThen</span><br><span class="line">  authenticate       andThen</span><br><span class="line">  route</span><br></pre></td></tr></table></figure><p>äº«ç”¨å®‰å…¨çš„ç±»å‹å§ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;è§†ç•Œï¼ˆView-Bound-â€œç±»å‹ç±»â€ï¼‰&quot;&gt;&lt;a href=&quot;#è§†ç•Œï¼ˆView-Bound-â€œç±»å‹ç±»â€ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;è§†ç•Œï¼ˆView Bound â€œç±»å‹ç±»â€ï¼‰&quot;&gt;&lt;/a&gt;è§†ç•Œï¼ˆView Bound â€œç±»å‹ç±»â€ï¼‰&lt;/h3&gt;&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ç±»å‹å’Œå¤šæ€åŸºç¡€</title>
    <link href="https://razertory.me/2019/12/01/scala-school-type-basics/"/>
    <id>https://razertory.me/2019/12/01/scala-school-type-basics/</id>
    <published>2019-12-01T02:47:32.000Z</published>
    <updated>2020-05-04T07:03:04.626Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ</h4><blockquote><p>æŒ‰ Pierce çš„è¯è®²ï¼šâ€œç±»å‹ç³»ç»Ÿæ˜¯ä¸€ä¸ªè¯­æ³•æ–¹æ³•ï¼Œå®ƒä»¬æ ¹æ®ç¨‹åºè®¡ç®—çš„å€¼çš„ç§ç±»å¯¹ç¨‹åºçŸ­è¯­è¿›è¡Œåˆ†ç±»ï¼Œé€šè¿‡åˆ†ç±»ç»“æœé”™è¯¯è¡Œä¸ºè¿›è¡Œè‡ªåŠ¨æ£€æŸ¥ã€‚â€ å¦å¤–ï¼Œç¬”è€…æ¨èé˜…è¯» <a href="https://www.zhihu.com/question/23434097" target="_blank" rel="noopener">ç¼–ç¨‹è¯­è¨€çš„ç±»å‹ç³»ç»Ÿä¸ºä½•å¦‚æ­¤é‡è¦ï¼Ÿ</a></p></blockquote><p>ç±»å‹å…è®¸ä½ è¡¨ç¤ºå‡½æ•°çš„å®šä¹‰åŸŸå’Œå€¼åŸŸã€‚ä¾‹å¦‚ï¼Œä»æ•°å­¦è§’åº¦çœ‹è¿™ä¸ªå®šä¹‰ï¼š</p><p><code>f: R -&gt; N</code> // å®ƒå‘Šè¯‰æˆ‘ä»¬å‡½æ•° f æ˜¯ä»å®æ•°é›†åˆ°è‡ªç„¶æ•°é›†çš„æ˜ å°„ã€‚</p><p>æŠ½è±¡åœ°è¯´ï¼Œè¿™å°±æ˜¯<em>å…·ä½“</em>ç±»å‹çš„å‡†ç¡®å®šä¹‰ã€‚ç±»å‹ç³»ç»Ÿç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›æ›´å¼ºå¤§çš„æ–¹å¼æ¥è¡¨è¾¾è¿™äº›é›†åˆã€‚é‰´äºè¿™äº›æ³¨é‡Šï¼Œç¼–è¯‘å™¨å¯ä»¥<em>é™æ€åœ°</em>ï¼ˆåœ¨ç¼–è¯‘æ—¶ï¼‰éªŒè¯ç¨‹åºæ˜¯<em>åˆç†</em>çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå€¼ï¼ˆåœ¨è¿è¡Œæ—¶ï¼‰ä¸ç¬¦åˆç¨‹åºè§„å®šçš„çº¦æŸï¼Œç¼–è¯‘å°†å¤±è´¥ã€‚ä¸€èˆ¬è¯´æ¥ï¼Œç±»å‹æ£€æŸ¥åªèƒ½ä¿è¯<em>ä¸åˆç†</em>çš„ç¨‹åºä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å®ƒä¸èƒ½ä¿è¯æ¯ä¸€ä¸ªåˆç†çš„ç¨‹åºéƒ½<em>å¯ä»¥</em>ç¼–è¯‘é€šè¿‡ã€‚</p><p>éšç€ç±»å‹ç³»ç»Ÿè¡¨è¾¾èƒ½åŠ›çš„æé«˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿäº§æ›´å¯é çš„ä»£ç ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿåœ¨æˆ‘ä»¬è¿è¡Œç¨‹åºä¹‹å‰éªŒè¯ç¨‹åºçš„ä¸å˜æ€§ï¼ˆå½“ç„¶æ˜¯å‘ç°ç±»å‹æœ¬èº«çš„æ¨¡å‹ bugï¼ï¼‰ã€‚å­¦æœ¯ç•Œä¸€ç›´å¾ˆåŠªåŠ›åœ°æé«˜ç±»å‹ç³»ç»Ÿçš„è¡¨ç°åŠ›ï¼ŒåŒ…æ‹¬å€¼ä¾èµ–ï¼ˆvalue-dependentï¼‰ç±»å‹ï¼</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰€æœ‰çš„ç±»å‹ä¿¡æ¯ä¼šåœ¨ç¼–è¯‘æ—¶è¢«åˆ å»ï¼Œå› ä¸ºå®ƒå·²ä¸å†éœ€è¦ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<code>ç±»å‹æ“¦é™¤</code>ã€‚</p><h4 id="Scala-ä¸­çš„ç±»å‹"><a href="#Scala-ä¸­çš„ç±»å‹" class="headerlink" title="Scala ä¸­çš„ç±»å‹"></a>Scala ä¸­çš„ç±»å‹</h4><p>Scala å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿæ‹¥æœ‰éå¸¸ä¸°å¯Œçš„è¡¨ç°åŠ›ã€‚å…¶ä¸»è¦ç‰¹æ€§æœ‰ï¼š</p><ul><li><strong>å‚æ•°åŒ–å¤šæ€æ€§ (parametric polymorphism )</strong>ï¼Œç²—ç•¥åœ°è¯´ï¼Œå°±æ˜¯æ³›å‹ç¼–ç¨‹</li><li><strong>å±€éƒ¨ç±»å‹æ¨æ–­</strong>ï¼Œç²—ç•¥åœ°è¯´ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆä½ ä¸éœ€è¦è¿™æ ·å†™ä»£ç  val i: Int = 12: Int</li><li>*<em>å­˜åœ¨é‡åŒ– (existential quantification) *</em>ç²—ç•¥åœ°è¯´ï¼Œä¸ºä¸€äº›æ²¡æœ‰åç§°çš„ç±»å‹è¿›è¡Œå®šä¹‰</li><li>*<em>è§†å›¾ (views) *</em>ç²—ç•¥åœ°è¯´ï¼Œå°±æ˜¯å°†ä¸€ç§ç±»å‹çš„å€¼â€œå¼ºåˆ¶è½¬æ¢â€ä¸ºå¦ä¸€ç§ç±»å‹</li></ul><h4 id="å‚æ•°åŒ–å¤šæ€æ€§"><a href="#å‚æ•°åŒ–å¤šæ€æ€§" class="headerlink" title="å‚æ•°åŒ–å¤šæ€æ€§"></a>å‚æ•°åŒ–å¤šæ€æ€§</h4><p>å¤šæ€æ€§æ˜¯åœ¨ä¸å½±å“é™æ€ç±»å‹ä¸°å¯Œæ€§çš„å‰æä¸‹ï¼Œç”¨æ¥ï¼ˆç»™ä¸åŒç±»å‹çš„å€¼ï¼‰ç¼–å†™é€šç”¨ä»£ç çš„ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ²¡æœ‰å‚æ•°åŒ–å¤šæ€æ€§ï¼Œä¸€ä¸ªé€šç”¨çš„åˆ—è¡¨æ•°æ®ç»“æ„æ€»æ˜¯çœ‹èµ·æ¥åƒè¿™æ ·ï¼ˆäº‹å®ä¸Šï¼Œå®ƒçœ‹èµ·æ¥å¾ˆåƒä½¿ç”¨æ³›å‹å‰çš„ Javaï¼‰ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="number">2</span> :: <span class="number">1</span> :: <span class="string">"bar"</span> :: <span class="string">"foo"</span> :: <span class="type">Nil</span></span><br><span class="line">res5: <span class="type">List</span>[<span class="type">Any</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">1</span>, bar, foo)</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æ— æ³•æ¢å¤å…¶ä¸­æˆå‘˜çš„ä»»ä½•ç±»å‹ä¿¡æ¯ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; res5.head</span><br><span class="line">res6: <span class="type">Any</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†ä¼šé€€åŒ–ä¸ºä¸€ç³»åˆ—ç±»å‹è½¬æ¢ï¼ˆâ€œasInstanceOf[]â€ï¼‰ï¼Œå¹¶ä¸”ä¼šç¼ºä¹ç±»å‹å®‰å…¨çš„ä¿éšœï¼ˆå› ä¸ºè¿™äº›éƒ½æ˜¯åŠ¨æ€çš„ï¼‰ã€‚</p><p>å¤šæ€æ€§æ˜¯é€šè¿‡æŒ‡å®š<em>ç±»å‹å˜é‡</em>å®ç°çš„ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">drop1</span></span>[<span class="type">A</span>](l: <span class="type">List</span>[<span class="type">A</span>]) = l.tail</span><br><span class="line">drop1: [<span class="type">A</span>](l: <span class="type">List</span>[<span class="type">A</span>])<span class="type">List</span>[<span class="type">A</span>]</span><br><span class="line"></span><br><span class="line">scala&gt; drop1(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">res1: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h4 id="Scala-æœ‰-rank-1-å¤šæ€æ€§-rank-1-polymorphism"><a href="#Scala-æœ‰-rank-1-å¤šæ€æ€§-rank-1-polymorphism" class="headerlink" title="Scala æœ‰ rank-1 å¤šæ€æ€§ (rank-1 polymorphism)"></a>Scala æœ‰ rank-1 å¤šæ€æ€§ (rank-1 polymorphism)</h4><p>ç²—ç•¥åœ°è¯´ï¼Œè¿™æ„å‘³ç€åœ¨ Scala ä¸­ï¼Œæœ‰ä¸€äº›ä½ æƒ³è¡¨è¾¾çš„ç±»å‹æ¦‚å¿µâ€œè¿‡äºæ³›åŒ–â€ï¼ˆæ³›åŒ–çš„å±‚çº§å¤§äº 1) ä»¥è‡³äºç¼–è¯‘å™¨æ— æ³•ç†è§£ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">toList</span></span>[<span class="type">A</span>](a: <span class="type">A</span>) = <span class="type">List</span>(a)</span><br></pre></td></tr></table></figure><p>ä½ å¸Œæœ›ç»§ç»­æ³›å‹åœ°ä½¿ç”¨å®ƒï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>[<span class="type">A</span>, <span class="type">B</span>](f: <span class="type">A</span> =&gt; <span class="type">List</span>[<span class="type">A</span>], b: <span class="type">B</span>) = f(b)</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸ºæ‰€æœ‰çš„ç±»å‹å˜é‡åªæœ‰åœ¨è°ƒç”¨ä¸Šä¸‹æ–‡ä¸­æ‰è¢«å›ºå®šã€‚å³ä½¿ä½ â€œé’‰ä½â€äº†ç±»å‹ Bï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>[<span class="type">A</span>](f: <span class="type">A</span> =&gt; <span class="type">List</span>[<span class="type">A</span>], i: <span class="type">Int</span>) = f(i)</span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿä¼šå¾—åˆ°ä¸€ä¸ªç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ã€‚</p><h4 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h4><p>é™æ€ç±»å‹çš„ä¸€ä¸ªä¼ ç»Ÿåå¯¹æ„è§æ˜¯ï¼Œå®ƒæœ‰å¤§é‡çš„è¯­æ³•å¼€é”€ã€‚Scala é€šè¿‡<em>ç±»å‹æ¨æ–­</em>æ¥ç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚</p><p>åœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œç±»å‹æ¨æ–­çš„ç»å…¸æ–¹æ³•æ˜¯ Hindley Milner ç®—æ³•ï¼Œå®ƒæœ€æ—©æ˜¯å®ç°åœ¨ ML ä¸­çš„ã€‚</p><p>Scala ç±»å‹æ¨æ–­ç³»ç»Ÿçš„å®ç°ç¨æœ‰ä¸åŒï¼Œä½†æœ¬è´¨ç±»ä¼¼ï¼š<code>æ¨æ–­çº¦æŸ</code>ï¼Œå¹¶è¯•å›¾ç»Ÿä¸€ç±»å‹ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ Scala ä¸­ä½ æ— æ³•è¿™æ ·åšï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; &#123; x =&gt; x &#125;</span><br><span class="line">&lt;console&gt;:<span class="number">7</span>: error: missing parameter <span class="class"><span class="keyword">type</span></span></span><br><span class="line"><span class="class">       </span>&#123; x =&gt; x &#125;</span><br></pre></td></tr></table></figure><p>è€Œåœ¨ OCaml ä¸­ä½ å¯ä»¥ï¼š</p><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">fun</span> x -&gt; x;;</span><br><span class="line">- : <span class="symbol">'a</span> -&gt; <span class="symbol">'a</span> = &lt;<span class="keyword">fun</span>&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ Scala ä¸­æ‰€æœ‰ç±»å‹æ¨æ–­æ˜¯<code>å±€éƒ¨çš„</code>ã€‚Scala ä¸€æ¬¡åˆ†æä¸€ä¸ªè¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">id</span></span>[<span class="type">T</span>](x: <span class="type">T</span>) = x</span><br><span class="line">id: [<span class="type">T</span>](x: <span class="type">T</span>)<span class="type">T</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> x = id(<span class="number">322</span>)</span><br><span class="line">x: <span class="type">Int</span> = <span class="number">322</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> x = id(<span class="string">"hey"</span>)</span><br><span class="line">x: java.lang.<span class="type">String</span> = hey</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> x = id(<span class="type">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">x: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><p>ç±»å‹ä¿¡æ¯éƒ½ä¿å­˜å®Œå¥½ï¼ŒScala ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬è¿›è¡Œäº†ç±»å‹æ¨æ–­ã€‚è¯·æ³¨æ„æˆ‘ä»¬å¹¶ä¸éœ€è¦æ˜ç¡®æŒ‡å®šè¿”å›ç±»å‹ã€‚</p><h4 id="å˜æ€§-Variance"><a href="#å˜æ€§-Variance" class="headerlink" title="å˜æ€§ (Variance)"></a>å˜æ€§ (Variance)</h4><p>Scala çš„ç±»å‹ç³»ç»Ÿå¿…é¡»åŒæ—¶è§£é‡Šç±»å±‚æ¬¡å’Œå¤šæ€æ€§ã€‚ç±»å±‚æ¬¡ç»“æ„å¯ä»¥è¡¨è¾¾å­ç±»å…³ç³»ã€‚åœ¨æ··åˆ OO å’Œå¤šæ€æ€§æ—¶ï¼Œä¸€ä¸ªæ ¸å¿ƒé—®é¢˜æ˜¯ï¼šå¦‚æœ Tâ€™æ˜¯ T ä¸€ä¸ªå­ç±»ï¼ŒContainer[Tâ€™] åº”è¯¥è¢«çœ‹åšæ˜¯ Container[T] çš„å­ç±»å—ï¼Ÿå˜æ€§ï¼ˆVarianceï¼‰æ³¨è§£å…è®¸ä½ è¡¨è¾¾ç±»å±‚æ¬¡ç»“æ„å’Œå¤šæ€ç±»å‹ä¹‹é—´çš„å…³ç³»ã€‚</p><table><thead><tr><th></th><th>å«ä¹‰</th><th>Scala æ ‡è®°</th></tr></thead><tbody><tr><td>åå˜ (covariant)</td><td>C[Tâ€™] æ˜¯ C[T] çš„å­ç±»</td><td>[+T]</td></tr><tr><td>é€†å˜ (contravariant)</td><td>C[T] æ˜¯ C[Tâ€™] çš„å­ç±»</td><td>[-T]</td></tr><tr><td>ä¸å˜ (invariant)</td><td>C[T] å’Œ C[Tâ€™] æ— å…³</td><td>[T]</td></tr></tbody></table><blockquote><p>é€†å˜åå˜æ›´å¤šä¿¡æ¯å‚è€ƒ<a href="https://zh.wikipedia.org/wiki/%E5%8D%8F%E5%8F%98%E4%B8%8E%E9%80%86%E5%8F%98" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a></p></blockquote><p>å­ç±»å‹å…³ç³»çš„çœŸæ­£å«ä¹‰ï¼šå¯¹ä¸€ä¸ªç»™å®šçš„ç±»å‹ Tï¼Œå¦‚æœ Tâ€™æ˜¯å…¶å­ç±»å‹ï¼Œä½ èƒ½æ›¿æ¢å®ƒå—ï¼Ÿ</p><h5 id="åå˜"><a href="#åå˜" class="headerlink" title="åå˜"></a>åå˜</h5><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Covariant</span>[+<span class="type">A</span>]</span></span><br><span class="line"><span class="class"><span class="title">defined</span> <span class="title">class</span> <span class="title">Covariant</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">cv</span></span>: <span class="type">Covariant</span>[<span class="type">AnyRef</span>] = <span class="keyword">new</span> <span class="type">Covariant</span>[<span class="type">String</span>]</span><br><span class="line">cv: <span class="type">Covariant</span>[<span class="type">AnyRef</span>] = <span class="type">Covariant</span>@<span class="number">4035</span>acf6</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> cv: <span class="type">Covariant</span>[<span class="type">String</span>] = <span class="keyword">new</span> <span class="type">Covariant</span>[<span class="type">AnyRef</span>]</span><br><span class="line">&lt;console&gt;:<span class="number">6</span>: error: <span class="class"><span class="keyword">type</span> <span class="title">mismatch</span></span>;</span><br><span class="line"> found   : <span class="type">Covariant</span>[<span class="type">AnyRef</span>]</span><br><span class="line"> required: <span class="type">Covariant</span>[<span class="type">String</span>]</span><br><span class="line">       <span class="keyword">val</span> cv: <span class="type">Covariant</span>[<span class="type">String</span>] = <span class="keyword">new</span> <span class="type">Covariant</span>[<span class="type">AnyRef</span>]</span><br><span class="line">                                   ^</span><br></pre></td></tr></table></figure><h5 id="é€†å˜"><a href="#é€†å˜" class="headerlink" title="é€†å˜"></a>é€†å˜</h5><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Contravariant</span>[-<span class="type">A</span>]</span></span><br><span class="line"><span class="class"><span class="title">defined</span> <span class="title">class</span> <span class="title">Contravariant</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">cv</span></span>: <span class="type">Contravariant</span>[<span class="type">String</span>] = <span class="keyword">new</span> <span class="type">Contravariant</span>[<span class="type">AnyRef</span>]</span><br><span class="line">cv: <span class="type">Contravariant</span>[<span class="type">AnyRef</span>] = <span class="type">Contravariant</span>@<span class="number">49</span>fa7ba</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> fail: <span class="type">Contravariant</span>[<span class="type">AnyRef</span>] = <span class="keyword">new</span> <span class="type">Contravariant</span>[<span class="type">String</span>]</span><br><span class="line">&lt;console&gt;:<span class="number">6</span>: error: <span class="class"><span class="keyword">type</span> <span class="title">mismatch</span></span>;</span><br><span class="line"> found   : <span class="type">Contravariant</span>[<span class="type">String</span>]</span><br><span class="line"> required: <span class="type">Contravariant</span>[<span class="type">AnyRef</span>]</span><br><span class="line">       <span class="keyword">val</span> fail: <span class="type">Contravariant</span>[<span class="type">AnyRef</span>] = <span class="keyword">new</span> <span class="type">Contravariant</span>[<span class="type">String</span>]</span><br><span class="line">                                     ^</span><br></pre></td></tr></table></figure><p>é€†å˜ä¼¼ä¹å¾ˆå¥‡æ€ªã€‚ä»€ä¹ˆæ—¶å€™æ‰ä¼šç”¨åˆ°å®ƒå‘¢ï¼Ÿä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå‡½æ•°ç‰¹è´¨çš„å®šä¹‰å°±ä½¿ç”¨äº†å®ƒï¼</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Function1</span> [-<span class="type">T1</span>, +<span class="type">R</span>] <span class="keyword">extends</span> <span class="title">AnyRef</span></span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä»”ç»†ä»æ›¿æ¢çš„è§’åº¦æ€è€ƒä¸€ä¸‹ï¼Œä¼šå‘ç°å®ƒæ˜¯éå¸¸åˆç†çš„ã€‚è®©æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„ç±»å±‚æ¬¡ç»“æ„ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123; <span class="keyword">val</span> sound = <span class="string">"rustle"</span> &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123; <span class="keyword">override</span> <span class="keyword">val</span> sound = <span class="string">"call"</span> &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Bird</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">class</span> <span class="title">Chicken</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123; <span class="keyword">override</span> <span class="keyword">val</span> sound = <span class="string">"cluck"</span> &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Chicken</span></span></span><br></pre></td></tr></table></figure><p>å‡è®¾ä½ éœ€è¦ä¸€ä¸ªä»¥ Bird ä¸ºå‚æ•°çš„å‡½æ•°ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> getTweet: (<span class="type">Bird</span> =&gt; <span class="type">String</span>) = <span class="comment">// TODO</span></span><br></pre></td></tr></table></figure><p>æ ‡å‡†åŠ¨ç‰©åº“æœ‰ä¸€ä¸ªå‡½æ•°æ»¡è¶³äº†ä½ çš„éœ€æ±‚ï¼Œä½†å®ƒçš„å‚æ•°æ˜¯ Animalã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœä½ è¯´â€œæˆ‘éœ€è¦ä¸€ä¸ª<strong><em>ï¼Œæˆ‘æœ‰ä¸€ä¸ª</em></strong>çš„å­ç±»â€æ˜¯å¯ä»¥çš„ã€‚ä½†æ˜¯ï¼Œåœ¨å‡½æ•°å‚æ•°è¿™é‡Œæ˜¯<code>é€†å˜</code>çš„ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ¥å—å‚æ•°ç±»å‹ Bird çš„å‡½æ•°å˜é‡ï¼Œä½†å´å°†è¿™ä¸ªå˜é‡æŒ‡å‘äº†æ¥å—å‚æ•°ç±»å‹ä¸º Chicken çš„å‡½æ•°ï¼Œé‚£ä¹ˆç»™å®ƒä¼ å…¥ä¸€ä¸ª Duck æ—¶å°±ä¼šå‡ºé”™ã€‚ç„¶è€Œï¼Œå¦‚æœå°†è¯¥å˜é‡æŒ‡å‘ä¸€ä¸ªæ¥å—å‚æ•°ç±»å‹ä¸º Animal çš„å‡½æ•°å°±ä¸ä¼šæœ‰è¿™ç§é—®é¢˜ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> getTweet: (<span class="type">Bird</span> =&gt; <span class="type">String</span>) = ((a: <span class="type">Animal</span>) =&gt; a.sound )</span><br><span class="line">getTweet: <span class="type">Bird</span> =&gt; <span class="type">String</span> = &lt;function1&gt;</span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„è¿”å›å€¼ç±»å‹æ˜¯åå˜çš„ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªè¿”å› Bird çš„å‡½æ•°ï¼Œä½†æŒ‡å‘çš„å‡½æ•°è¿”å›ç±»å‹æ˜¯ Chickenï¼Œè¿™å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> hatch: (() =&gt; <span class="type">Bird</span>) = (() =&gt; <span class="keyword">new</span> <span class="type">Chicken</span> )</span><br><span class="line">hatch: () =&gt; <span class="type">Bird</span> = &lt;function0&gt;</span><br></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥å¯¹äº Scala ä¸­çš„å‡½æ•°è€Œè¨€ï¼Œåœ¨å…¥å‚é€†å˜ï¼Œè¿”å›å€¼åå˜çš„åŸºç¡€ä¸Šä¸€åˆ‡éƒ½ä¼šå˜å¾—çµæ´»è€Œä¸¥è°¨ã€‚</p></blockquote><h4 id="è¾¹ç•Œ"><a href="#è¾¹ç•Œ" class="headerlink" title="è¾¹ç•Œ"></a>è¾¹ç•Œ</h4><p>Scala å…è®¸ä½ é€šè¿‡<code>è¾¹ç•Œ</code>æ¥é™åˆ¶å¤šæ€å˜é‡ã€‚è¿™äº›è¾¹ç•Œè¡¨è¾¾äº†å­ç±»å‹å…³ç³»ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">cacophony</span></span>[<span class="type">T</span>](things: <span class="type">Seq</span>[<span class="type">T</span>]) = things map (_.sound)</span><br><span class="line">&lt;console&gt;:<span class="number">7</span>: error: value sound is not a member of <span class="class"><span class="keyword">type</span> <span class="title">parameter</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">       <span class="title">def</span> <span class="title">cacophony</span>[<span class="type">T</span>](<span class="params">things: <span class="type">Seq</span>[<span class="type">T</span>]</span>) </span>= things map (_.sound)</span><br><span class="line">                                                        ^</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">biophony</span></span>[<span class="type">T</span> &lt;: <span class="type">Animal</span>](things: <span class="type">Seq</span>[<span class="type">T</span>]) = things map (_.sound)</span><br><span class="line">biophony: [<span class="type">T</span> &lt;: <span class="type">Animal</span>](things: <span class="type">Seq</span>[<span class="type">T</span>])<span class="type">Seq</span>[java.lang.<span class="type">String</span>]</span><br><span class="line"></span><br><span class="line">scala&gt; biophony(<span class="type">Seq</span>(<span class="keyword">new</span> <span class="type">Chicken</span>, <span class="keyword">new</span> <span class="type">Bird</span>))</span><br><span class="line">res5: <span class="type">Seq</span>[java.lang.<span class="type">String</span>] = <span class="type">List</span>(cluck, call)</span><br></pre></td></tr></table></figure><p>ç±»å‹ä¸‹ç•Œä¹Ÿæ˜¯æ”¯æŒçš„ï¼Œè¿™è®©é€†å˜å’Œå·§å¦™åå˜çš„å¼•å…¥å¾—å¿ƒåº”æ‰‹ã€‚List[+T] æ˜¯åå˜çš„ï¼›ä¸€ä¸ª Bird çš„åˆ—è¡¨ä¹Ÿæ˜¯ Animal çš„åˆ—è¡¨ã€‚List å®šä¹‰ä¸€ä¸ªæ“ä½œ <code>::</code> (elem T) è¿”å›ä¸€ä¸ªåŠ å…¥äº† elem çš„æ–°çš„ Listã€‚æ–°çš„ List å’ŒåŸæ¥çš„åˆ—è¡¨å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> flock = <span class="type">List</span>(<span class="keyword">new</span> <span class="type">Bird</span>, <span class="keyword">new</span> <span class="type">Bird</span>)</span><br><span class="line">flock: <span class="type">List</span>[<span class="type">Bird</span>] = <span class="type">List</span>(<span class="type">Bird</span>@<span class="number">7e1</span>ec70e, <span class="type">Bird</span>@<span class="number">169</span>ea8d2)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">new</span> <span class="type">Chicken</span> :: flock</span><br><span class="line">res53: <span class="type">List</span>[<span class="type">Bird</span>] = <span class="type">List</span>(<span class="type">Chicken</span>@<span class="number">56</span>fbda05, <span class="type">Bird</span>@<span class="number">7e1</span>ec70e, <span class="type">Bird</span>@<span class="number">169</span>ea8d2)</span><br></pre></td></tr></table></figure><p>List åŒæ · å®šä¹‰äº† <code>::</code> [B &gt;: T](x: B) æ¥è¿”å›ä¸€ä¸ª List[B]ã€‚è¯·æ³¨æ„ B &gt;: Tï¼Œè¿™æŒ‡æ˜äº†ç±»å‹ B ä¸ºç±»å‹ T çš„è¶…ç±»ã€‚è¿™ä¸ªæ–¹æ³•è®©æˆ‘ä»¬èƒ½å¤Ÿåšæ­£ç¡®åœ°å¤„ç†åœ¨ä¸€ä¸ª List[Bird] å‰é¢åŠ ä¸€ä¸ª Animal çš„æ“ä½œï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">new</span> <span class="type">Animal</span> :: flock</span><br><span class="line">res59: <span class="type">List</span>[<span class="type">Animal</span>] = <span class="type">List</span>(<span class="type">Animal</span>@<span class="number">11</span>f8d3a8, <span class="type">Bird</span>@<span class="number">7e1</span>ec70e, <span class="type">Bird</span>@<span class="number">169</span>ea8d2)</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿”å›ç±»å‹æ˜¯ Animalã€‚</p><h4 id="é‡åŒ–"><a href="#é‡åŒ–" class="headerlink" title="é‡åŒ–"></a>é‡åŒ–</h4><p>æœ‰æ—¶å€™ï¼Œä½ å¹¶ä¸å…³å¿ƒæ˜¯å¦èƒ½å¤Ÿå‘½åä¸€ä¸ªç±»å‹å˜é‡ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">count</span></span>[<span class="type">A</span>](l: <span class="type">List</span>[<span class="type">A</span>]) = l.size</span><br><span class="line">count: [<span class="type">A</span>](<span class="type">List</span>[<span class="type">A</span>])<span class="type">Int</span></span><br></pre></td></tr></table></figure><p>è¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ <code>_</code> å–è€Œä»£ä¹‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">count</span></span>(l: <span class="type">List</span>[_]) = l.size</span><br><span class="line">count: (<span class="type">List</span>[_])<span class="type">Int</span></span><br></pre></td></tr></table></figure><p>è¿™ç›¸å½“äºæ˜¯ä¸‹é¢ä»£ç çš„ç®€å†™ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">count</span></span>(l: <span class="type">List</span>[<span class="type">T</span> <span class="keyword">forSome</span> &#123; <span class="class"><span class="keyword">type</span> <span class="title">T</span> &#125;]) </span>= l.size</span><br><span class="line">count: (<span class="type">List</span>[<span class="type">T</span> <span class="keyword">forSome</span> &#123; <span class="class"><span class="keyword">type</span> <span class="title">T</span> &#125;])<span class="title">Int</span></span></span><br></pre></td></tr></table></figure><p>æ³¨æ„é‡åŒ–ä¼šçš„ç»“æœä¼šå˜å¾—éå¸¸éš¾ä»¥ç†è§£ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">drop1</span></span>(l: <span class="type">List</span>[_]) = l.tail</span><br><span class="line">drop1: (<span class="type">List</span>[_])<span class="type">List</span>[<span class="type">Any</span>]</span><br></pre></td></tr></table></figure><p>çªç„¶ï¼Œæˆ‘ä»¬å¤±å»äº†ç±»å‹ä¿¡æ¯ï¼è®©æˆ‘ä»¬ç»†åŒ–ä»£ç çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">drop1</span></span>(l: <span class="type">List</span>[<span class="type">T</span> <span class="keyword">forSome</span> &#123; <span class="class"><span class="keyword">type</span> <span class="title">T</span> &#125;]) </span>= l.tail</span><br><span class="line">drop1: (<span class="type">List</span>[<span class="type">T</span> <span class="keyword">forSome</span> &#123; <span class="class"><span class="keyword">type</span> <span class="title">T</span> &#125;])<span class="title">List</span>[<span class="type">T</span> forSome &#123; type <span class="type">T</span> &#125;]</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ T å› ä¸ºç±»å‹ä¸å…è®¸è¿™æ ·åšã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ä¸ºé€šé…ç¬¦ç±»å‹å˜é‡åº”ç”¨è¾¹ç•Œï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">hashcodes</span></span>(l: <span class="type">Seq</span>[_ &lt;: <span class="type">AnyRef</span>]) = l map (_.hashCode)</span><br><span class="line">hashcodes: (<span class="type">Seq</span>[_ &lt;: <span class="type">AnyRef</span>])<span class="type">Seq</span>[<span class="type">Int</span>]</span><br><span class="line"></span><br><span class="line">scala&gt; hashcodes(<span class="type">Seq</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">&lt;console&gt;:<span class="number">7</span>: error: <span class="class"><span class="keyword">type</span> <span class="title">mismatch</span></span>;</span><br><span class="line"> found   : <span class="type">Int</span>(<span class="number">1</span>)</span><br><span class="line"> required: <span class="type">AnyRef</span></span><br><span class="line"><span class="type">Note</span>: primitive types are not implicitly converted to <span class="type">AnyRef</span>.</span><br><span class="line"><span class="type">You</span> can safely force boxing by casting x.asInstanceOf[<span class="type">AnyRef</span>].</span><br><span class="line">       hashcodes(<span class="type">Seq</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">                     ^</span><br><span class="line"></span><br><span class="line">scala&gt; hashcodes(<span class="type">Seq</span>(<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>))</span><br><span class="line">res1: <span class="type">Seq</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">110182</span>, <span class="number">115276</span>, <span class="number">110339486</span>)</span><br></pre></td></tr></table></figure><p>å‚è€ƒ <a href="https://www.drmaciver.com/2008/03/existential-types-in-scala/" target="_blank" rel="noopener">D. R. MacIver å†™çš„ Scala ä¸­çš„å­˜åœ¨ç±»å‹</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯é™æ€ç±»å‹ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;æŒ‰
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æ¨¡å¼åŒ¹é…ä¸å‡½æ•°ç»„åˆ</title>
    <link href="https://razertory.me/2019/12/01/scala-school-pattern-matching-and-functional-composition/"/>
    <id>https://razertory.me/2019/12/01/scala-school-pattern-matching-and-functional-composition/</id>
    <published>2019-12-01T02:28:36.000Z</published>
    <updated>2020-05-04T07:03:11.841Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‡½æ•°ç»„åˆ"><a href="#å‡½æ•°ç»„åˆ" class="headerlink" title="å‡½æ•°ç»„åˆ"></a>å‡½æ•°ç»„åˆ</h3><p>è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå‡½æ•°ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">f</span></span>(s: <span class="type">String</span>) = <span class="string">"f("</span> + s + <span class="string">")"</span></span><br><span class="line">f: (<span class="type">String</span>)java.lang.<span class="type">String</span></span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">g</span></span>(s: <span class="type">String</span>) = <span class="string">"g("</span> + s + <span class="string">")"</span></span><br><span class="line">g: (<span class="type">String</span>)java.lang.<span class="type">String</span></span><br></pre></td></tr></table></figure><h4 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h4><p><code>compose</code> ç»„åˆå…¶ä»–å‡½æ•°å½¢æˆä¸€ä¸ªæ–°çš„å‡½æ•° <code>f(g(x))</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> fComposeG = f _ compose g _</span><br><span class="line">fComposeG: (<span class="type">String</span>) =&gt; java.lang.<span class="type">String</span> = &lt;function&gt;</span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; fComposeG(<span class="string">"yay"</span>)</span><br><span class="line">res0: java.lang.<span class="type">String</span> = f(g(yay))</span><br></pre></td></tr></table></figure><h4 id="andThen"><a href="#andThen" class="headerlink" title="andThen"></a>andThen</h4><p><code>andThen</code> å’Œ <code>compose</code> å¾ˆåƒï¼Œä½†æ˜¯è°ƒç”¨é¡ºåºæ˜¯å…ˆè°ƒç”¨ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åè°ƒç”¨ç¬¬äºŒä¸ªï¼Œå³ <code>g(f(x))</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> fAndThenG = f _ andThen g _</span><br><span class="line">fAndThenG: (<span class="type">String</span>) =&gt; java.lang.<span class="type">String</span> = &lt;function&gt;</span><br><span class="line">scala&gt; fAndThenG(<span class="string">"yay"</span>)</span><br><span class="line">res1: java.lang.<span class="type">String</span> = g(f(yay))</span><br></pre></td></tr></table></figure><h3 id="æŸ¯é‡ŒåŒ–-Curried-vs-éƒ¨åˆ†åº”ç”¨-Partial-Application"><a href="#æŸ¯é‡ŒåŒ–-Curried-vs-éƒ¨åˆ†åº”ç”¨-Partial-Application" class="headerlink" title="æŸ¯é‡ŒåŒ–(Curried) vs éƒ¨åˆ†åº”ç”¨(Partial Application)"></a>æŸ¯é‡ŒåŒ–(Curried) vs éƒ¨åˆ†åº”ç”¨(Partial Application)</h3><h4 id="case-è¯­å¥"><a href="#case-è¯­å¥" class="headerlink" title="case è¯­å¥"></a>case è¯­å¥</h4><ul><li><p>é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ case è¯­å¥ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªåä¸º <code>PartialFunction</code> çš„å‡½æ•°çš„å­ç±»ã€‚</p></li><li><p>å¤šä¸ª case è¯­å¥çš„é›†åˆæ˜¯ä»€ä¹ˆï¼Ÿ ä»–ä»¬æ˜¯å…±åŒç»„åˆåœ¨ä¸€èµ·çš„å¤šä¸ª <code>PartialFunction</code>ã€‚</p></li></ul><blockquote><p>ps: PartialFunction è¯¦è§ <a href="https://www.scala-lang.org/api/2.12.9/scala/PartialFunction.html" target="_blank" rel="noopener">https://www.scala-lang.org/api/2.12.9/scala/PartialFunction.html</a></p></blockquote><h4 id="å‡½æ•°-vs-åå‡½æ•°-PartialFunction"><a href="#å‡½æ•°-vs-åå‡½æ•°-PartialFunction" class="headerlink" title="å‡½æ•° vs åå‡½æ•° (PartialFunction)"></a>å‡½æ•° vs åå‡½æ•° (PartialFunction)</h4><p><strong>å‡½æ•°</strong>: å¯¹ç»™å®šçš„è¾“å…¥å‚æ•°ç±»å‹ï¼Œå‡½æ•°å¯æ¥å—è¯¥ç±»å‹çš„ä»»ä½•å€¼ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª (Int) =&gt; String çš„å‡½æ•°å¯ä»¥æ¥æ”¶ä»»æ„ Int å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><strong>åå‡½æ•°</strong>: å¯¹ç»™å®šçš„è¾“å…¥å‚æ•°ç±»å‹ï¼Œ<code>åå‡½æ•°</code>åªèƒ½æ¥å—è¯¥ç±»å‹çš„æŸäº›ç‰¹å®šçš„å€¼ã€‚ä¸€ä¸ªå®šä¹‰ä¸º (Int) =&gt; String çš„<code>åå‡½æ•°</code>å¯èƒ½ä¸èƒ½æ¥å—æ‰€æœ‰ Int å€¼ä¸ºè¾“å…¥ã€‚<code>isDefinedAt</code> æ˜¯åå‡½æ•°çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ç¡®å®šæ˜¯å¦èƒ½æ¥å—ä¸€ä¸ªç»™å®šçš„å‚æ•°ã€‚æ³¨æ„åå‡½æ•°å’Œæˆ‘ä»¬å‰é¢æåˆ°çš„<code>éƒ¨åˆ†åº”ç”¨</code>å‡½æ•°æ˜¯æ— å…³çš„ã€‚</p><p>å‚è€ƒ Effective Scala å¯¹ <a href="https://twitter.github.com/effectivescala/#Functional%20programming-Partial%20functions" target="_blank" rel="noopener">PartialFunction</a> çš„æ„è§ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> one: <span class="type">PartialFunction</span>[<span class="type">Int</span>, <span class="type">String</span>] = &#123; <span class="keyword">case</span> <span class="number">1</span> =&gt; <span class="string">"one"</span> &#125;</span><br><span class="line">one: <span class="type">PartialFunction</span>[<span class="type">Int</span>,<span class="type">String</span>] = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `isDefinedAt` æ˜¯`åå‡½æ•°`çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ç¡®å®šæ˜¯å¦èƒ½æ¥å—ä¸€ä¸ªç»™å®šçš„å‚æ•°</span></span><br><span class="line">scala&gt; one.isDefinedAt(<span class="number">1</span>)</span><br><span class="line">res0: <span class="type">Boolean</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">scala&gt; one.isDefinedAt(<span class="number">2</span>)</span><br><span class="line">res1: <span class="type">Boolean</span> = <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>æ‚¨å¯ä»¥è°ƒç”¨ä¸€ä¸ªåå‡½æ•°ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; one(<span class="number">1</span>)</span><br><span class="line">res2: <span class="type">String</span> = one</span><br></pre></td></tr></table></figure><p>åå‡½æ•°å¯ä»¥ä½¿ç”¨ <code>orElse</code> ç»„æˆæ–°çš„å‡½æ•°ï¼Œå¾—åˆ°çš„åå‡½æ•°åæ˜ äº†æ˜¯å¦å¯¹ç»™å®šå‚æ•°è¿›è¡Œäº†å®šä¹‰ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> two: <span class="type">PartialFunction</span>[<span class="type">Int</span>, <span class="type">String</span>] = &#123; <span class="keyword">case</span> <span class="number">2</span> =&gt; <span class="string">"two"</span> &#125;</span><br><span class="line">two: <span class="type">PartialFunction</span>[<span class="type">Int</span>,<span class="type">String</span>] = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> three: <span class="type">PartialFunction</span>[<span class="type">Int</span>, <span class="type">String</span>] = &#123; <span class="keyword">case</span> <span class="number">3</span> =&gt; <span class="string">"three"</span> &#125;</span><br><span class="line">three: <span class="type">PartialFunction</span>[<span class="type">Int</span>,<span class="type">String</span>] = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> wildcard: <span class="type">PartialFunction</span>[<span class="type">Int</span>, <span class="type">String</span>] = &#123; <span class="keyword">case</span> _ =&gt; <span class="string">"something else"</span> &#125;</span><br><span class="line">wildcard: <span class="type">PartialFunction</span>[<span class="type">Int</span>,<span class="type">String</span>] = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> partial = one orElse two orElse three orElse wildcard</span><br><span class="line">partial: <span class="type">PartialFunction</span>[<span class="type">Int</span>,<span class="type">String</span>] = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; partial(<span class="number">5</span>)</span><br><span class="line">res24: <span class="type">String</span> = something <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">scala&gt; partial(<span class="number">3</span>)</span><br><span class="line">res25: <span class="type">String</span> = three</span><br><span class="line"></span><br><span class="line">scala&gt; partial(<span class="number">2</span>)</span><br><span class="line">res26: <span class="type">String</span> = two</span><br><span class="line"></span><br><span class="line">scala&gt; partial(<span class="number">1</span>)</span><br><span class="line">res27: <span class="type">String</span> = one</span><br><span class="line"></span><br><span class="line">scala&gt; partial(<span class="number">0</span>)</span><br><span class="line">res28: <span class="type">String</span> = something <span class="keyword">else</span></span><br></pre></td></tr></table></figure><h4 id="case-ä¹‹è°œ"><a href="#case-ä¹‹è°œ" class="headerlink" title="case ä¹‹è°œ"></a>case ä¹‹è°œ</h4><p><a href="/2019/12/01/scala-school-collections/#drop-amp-dropWhile">ä¸Šä¸€ç¯‡</a> æˆ‘ä»¬çœ‹åˆ°ä¸€äº›æ–°å¥‡çš„ä¸œè¥¿ã€‚æˆ‘ä»¬åœ¨é€šå¸¸åº”è¯¥ä½¿ç”¨å‡½æ•°çš„åœ°æ–¹çœ‹åˆ°äº†ä¸€ä¸ª case è¯­å¥ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneExt</span>(<span class="params">name: <span class="type">String</span>, ext: <span class="type">Int</span></span>)</span></span><br><span class="line"><span class="class"><span class="title">defined</span> <span class="title">class</span> <span class="title">PhoneExt</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">extensions</span> </span>= <span class="type">List</span>(<span class="type">PhoneExt</span>(<span class="string">"steve"</span>, <span class="number">100</span>), <span class="type">PhoneExt</span>(<span class="string">"robey"</span>, <span class="number">200</span>))</span><br><span class="line">extensions: <span class="type">List</span>[<span class="type">PhoneExt</span>] = <span class="type">List</span>(<span class="type">PhoneExt</span>(steve,<span class="number">100</span>), <span class="type">PhoneExt</span>(robey,<span class="number">200</span>))</span><br><span class="line"></span><br><span class="line">scala&gt; extensions.filter &#123; <span class="keyword">case</span> <span class="type">PhoneExt</span>(name, extension) =&gt; extension &lt; <span class="number">200</span> &#125;</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">PhoneExt</span>] = <span class="type">List</span>(<span class="type">PhoneExt</span>(steve,<span class="number">100</span>))</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™æ®µä»£ç å¯ä»¥å·¥ä½œï¼Ÿ</p><p>filter ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ä¸€ä¸ª<code>è°“è¯å‡½æ•°</code>(PhoneExt) =&gt; Booleanã€‚(è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°é€šå¸¸è¢«ç§°ä¸º<code>è°“è¯å‡½æ•°</code>)</p><p>åå‡½æ•° PartialFunction æ˜¯ Function çš„<code>å­ç±»å‹</code>ï¼Œæ‰€ä»¥ filter ä¹Ÿå¯ä»¥ä½¿ç”¨ PartialFunctionã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;å‡½æ•°ç»„åˆ&quot;&gt;&lt;a href=&quot;#å‡½æ•°ç»„åˆ&quot; class=&quot;headerlink&quot; title=&quot;å‡½æ•°ç»„åˆ&quot;&gt;&lt;/a&gt;å‡½æ•°ç»„åˆ&lt;/h3&gt;&lt;p&gt;è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå‡½æ•°ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight scala&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td 
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Scala è¯¾å ‚ - é›†åˆ</title>
    <link href="https://razertory.me/2019/12/01/scala-school-collections/"/>
    <id>https://razertory.me/2019/12/01/scala-school-collections/</id>
    <published>2019-12-01T01:10:36.000Z</published>
    <updated>2020-05-04T07:02:42.386Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸºæœ¬æ•°æ®ç»“æ„"><a href="#åŸºæœ¬æ•°æ®ç»“æ„" class="headerlink" title="åŸºæœ¬æ•°æ®ç»“æ„"></a>åŸºæœ¬æ•°æ®ç»“æ„</h2><p>Scala æä¾›äº†ä¸€äº›ä¸é”™çš„é›†åˆã€‚</p><p>å‚è€ƒ Effective Scala å¯¹æ€æ ·ä½¿ç”¨é›†åˆçš„è§‚ç‚¹ã€‚</p><h3 id="æ•°ç»„-Array"><a href="#æ•°ç»„-Array" class="headerlink" title="æ•°ç»„ (Array)"></a>æ•°ç»„ (Array)</h3><p>æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥åŒ…å«é‡å¤é¡¹ï¼Œå¹¶ä¸”å¯å˜ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">numbers: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numbers(<span class="number">3</span>) = <span class="number">10</span></span><br><span class="line">scala&gt; numbers</span><br><span class="line">numbers: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><h3 id="åˆ—è¡¨-List"><a href="#åˆ—è¡¨-List" class="headerlink" title="åˆ—è¡¨ (List)"></a>åˆ—è¡¨ (List)</h3><p>åˆ—è¡¨æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥åŒ…å«é‡å¤é¡¹ï¼Œä¸å¯å˜ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">numbers: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numbers(<span class="number">3</span>) = <span class="number">10</span></span><br><span class="line">&lt;console&gt;:<span class="number">9</span>: error: value update is not a member of <span class="type">List</span>[<span class="type">Int</span>]</span><br><span class="line">              numbers(<span class="number">3</span>) = <span class="number">10</span></span><br></pre></td></tr></table></figure><h3 id="é›†åˆ-Set"><a href="#é›†åˆ-Set" class="headerlink" title="é›†åˆ (Set)"></a>é›†åˆ (Set)</h3><p>é›†åˆæ— åºä¸”ä¸å¯åŒ…å«é‡å¤é¡¹ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">Set</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">numbers: scala.collection.immutable.<span class="type">Set</span>[<span class="type">Int</span>] = <span class="type">Set</span>(<span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><h3 id="å…ƒç»„-Tuple"><a href="#å…ƒç»„-Tuple" class="headerlink" title="å…ƒç»„ (Tuple)"></a>å…ƒç»„ (Tuple)</h3><p>å…ƒç»„åœ¨ä¸ä½¿ç”¨ç±»çš„æƒ…å†µä¸‹ï¼Œå°†å…ƒç´ ç»„åˆèµ·æ¥å½¢æˆç®€å•çš„é€»è¾‘é›†åˆã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> hostPort = (<span class="string">"localhost"</span>, <span class="number">80</span>)</span><br><span class="line">hostPort: (<span class="type">String</span>, <span class="type">Int</span>) = (localhost, <span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>ä¸æ ·æœ¬ç±»ä¸åŒï¼Œå…ƒç»„ä¸èƒ½é€šè¿‡åç§°è·å–å­—æ®µï¼Œè€Œæ˜¯ä½¿ç”¨ä½ç½®ä¸‹æ ‡æ¥è¯»å–å¯¹è±¡ï¼›è€Œä¸”è¿™ä¸ªä¸‹æ ‡åŸºäº <code>1</code>ï¼Œè€Œä¸æ˜¯åŸºäº 0ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; hostPort._1</span><br><span class="line">res0: <span class="type">String</span> = localhost</span><br><span class="line"></span><br><span class="line">scala&gt; hostPort._2</span><br><span class="line">res1: <span class="type">Int</span> = <span class="number">80</span></span><br></pre></td></tr></table></figure><p>å…ƒç»„å¯ä»¥å¾ˆå¥½å¾—ä¸æ¨¡å¼åŒ¹é…ç›¸ç»“åˆã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hostPort <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> (<span class="string">"localhost"</span>, port) =&gt; ...</span><br><span class="line">  <span class="keyword">case</span> (host, port) =&gt; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºä¸¤ä¸ªå…ƒç´ çš„å…ƒç»„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šè¯­æ³•ï¼š<code>-&gt;</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="number">1</span> -&gt; <span class="number">2</span></span><br><span class="line">res0: (<span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>å‚è€ƒ Effective Scala å¯¹ <a href="https://twitter.github.com/effectivescala/#Functional%20programming-Destructuring%20bindings" target="_blank" rel="noopener">è§£æ„ç»‘å®š</a>ï¼ˆâ€œæ‹†è§£â€ä¸€ä¸ªå…ƒç»„ï¼‰çš„è§‚ç‚¹ã€‚</p><h3 id="æ˜ å°„-Map"><a href="#æ˜ å°„-Map" class="headerlink" title="æ˜ å°„ (Map)"></a>æ˜ å°„ (Map)</h3><p>å®ƒå¯ä»¥æŒæœ‰åŸºæœ¬æ•°æ®ç±»å‹ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Map</span>(<span class="number">1</span> -&gt; <span class="number">2</span>)</span><br><span class="line"><span class="type">Map</span>(<span class="string">"foo"</span> -&gt; <span class="string">"bar"</span>)</span><br></pre></td></tr></table></figure><p>è¿™çœ‹èµ·æ¥åƒæ˜¯ç‰¹æ®Šçš„è¯­æ³•ï¼Œä¸è¿‡ä¸è¦å¿˜äº†ä¸Šæ–‡è®¨è®ºçš„ <code>-&gt;</code> å¯ä»¥ç”¨æ¥åˆ›å»ºäºŒå…ƒç»„ã€‚</p><p>Map() æ–¹æ³•ä¹Ÿä½¿ç”¨äº†ä»ç¬¬ä¸€èŠ‚è¯¾å­¦åˆ°çš„å˜å‚åˆ—è¡¨ï¼šMap(1 -&gt; â€œoneâ€, 2 -&gt; â€œtwoâ€) å°†å˜ä¸º Map((1, â€œoneâ€), (2, â€œtwoâ€))ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ˜ å°„çš„é”®ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯æ˜ å°„çš„å€¼ã€‚</p><p>æ˜ å°„çš„å€¼å¯ä»¥æ˜¯æ˜ å°„ç”šè‡³æ˜¯<code>å‡½æ•°</code>ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Map</span>(<span class="number">1</span> -&gt; <span class="type">Map</span>(<span class="string">"foo"</span> -&gt; <span class="string">"bar"</span>))</span><br><span class="line"><span class="type">Map</span>(<span class="string">"timesTwo"</span> -&gt; &#123; timesTwo(_) &#125;)</span><br></pre></td></tr></table></figure><h3 id="é€‰é¡¹-Option"><a href="#é€‰é¡¹-Option" class="headerlink" title="é€‰é¡¹ (Option)"></a>é€‰é¡¹ (Option)</h3><p>Option æ˜¯ä¸€ä¸ªè¡¨ç¤ºæœ‰å¯èƒ½åŒ…å«å€¼çš„å®¹å™¨ã€‚</p><p>Option åŸºæœ¬çš„æ¥å£æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Option</span>[<span class="type">T</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isDefined</span></span>: <span class="type">Boolean</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>: <span class="type">T</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">getOrElse</span></span>(t: <span class="type">T</span>): <span class="type">T</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Option æœ¬èº«æ˜¯æ³›å‹çš„ï¼Œå¹¶ä¸”æœ‰ä¸¤ä¸ªå­ç±»ï¼š <code>Some[T]</code> æˆ– <code>None</code></p><p>æˆ‘ä»¬çœ‹ä¸€ä¸ªä½¿ç”¨ Option çš„ä¾‹å­ï¼š</p><p><code>Map.get</code> ä½¿ç”¨ Option ä½œä¸ºå…¶è¿”å›å€¼ï¼Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•ä¹Ÿè®¸ä¸ä¼šè¿”å›ä½ è¯·æ±‚çš„å€¼ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">Map</span>(<span class="string">"one"</span> -&gt; <span class="number">1</span>, <span class="string">"two"</span> -&gt; <span class="number">2</span>)</span><br><span class="line">numbers: scala.collection.immutable.<span class="type">Map</span>[java.lang.<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>(one -&gt; <span class="number">1</span>, two -&gt; <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numbers.get(<span class="string">"two"</span>)</span><br><span class="line">res0: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">Some</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numbers.get(<span class="string">"three"</span>)</span><br><span class="line">res1: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">None</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬çš„æ•°æ®ä¼¼ä¹é™·åœ¨ Option ä¸­äº†ï¼Œæˆ‘ä»¬æ€æ ·è·å–è¿™ä¸ªæ•°æ®å‘¢ï¼Ÿ</p><p>ç›´è§‰ä¸Šæƒ³åˆ°çš„å¯èƒ½æ˜¯åŸºäº <code>isDefined</code> æ–¹æ³•è¿›è¡Œæ¡ä»¶åˆ¤æ–­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// We want to multiply the number by two, otherwise return 0.</span></span><br><span class="line"><span class="keyword">val</span> result = <span class="keyword">if</span> (res1.isDefined) &#123;</span><br><span class="line">  res1.get * <span class="number">2</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å»ºè®®ä½¿ç”¨ <code>getOrElse</code> æˆ–æ¨¡å¼åŒ¹é…å¤„ç†è¿™ä¸ªç»“æœã€‚</p><p><code>getOrElse</code> è®©ä½ è½»æ¾åœ°å®šä¹‰ä¸€ä¸ªé»˜è®¤å€¼ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result = res1.getOrElse(<span class="number">0</span>) * <span class="number">2</span></span><br><span class="line">æ¨¡å¼åŒ¹é…èƒ½è‡ªç„¶åœ°é…åˆ <span class="type">Option</span> ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> result = res1 <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="type">Some</span>(n) =&gt; n * <span class="number">2</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">None</span> =&gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒ Effective Scala å¯¹ä½¿ç”¨ <a href="https://twitter.github.com/effectivescala/#Functional%20programming-Options" target="_blank" rel="noopener">Options</a> çš„æ„è§ã€‚</p><h2 id="å‡½æ•°ç»„åˆå­ï¼ˆFunctional-Combinatorsï¼‰"><a href="#å‡½æ•°ç»„åˆå­ï¼ˆFunctional-Combinatorsï¼‰" class="headerlink" title="å‡½æ•°ç»„åˆå­ï¼ˆFunctional Combinatorsï¼‰"></a>å‡½æ•°ç»„åˆå­ï¼ˆFunctional Combinatorsï¼‰</h2><p>List(1, 2, 3) map squared å¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½åº”ç”¨äº† squared å¹³æ–¹å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨ List(1, 4, 9)ã€‚æˆ‘ä»¬æŠŠç±»ä¼¼äº map çš„æ“ä½œç§°ä½œç»„åˆå­ã€‚ ï¼ˆå¦‚æœæƒ³è¦æ›´å¥½çš„å®šä¹‰ï¼Œä½ å¯ä»¥çœ‹çœ‹ Stackoverflow ä¸Šå¯¹ <a href="https://stackoverflow.com/questions/7533837/explanation-of-combinators-for-the-working-man" target="_blank" rel="noopener">ç»„åˆå­</a> çš„è¯´æ˜ã€‚ï¼‰ä»–ä»¬å¸¸è¢«ç”¨åœ¨æ ‡å‡†çš„æ•°æ®ç»“æ„ä¸Šã€‚</p><h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p><code>map</code> å¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›åº”ç”¨åçš„å…ƒç´ æ‰€ç»„æˆçš„åˆ—è¡¨ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">numbers: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numbers.map((i: <span class="type">Int</span>) =&gt; i * <span class="number">2</span>)</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><p>æˆ–ä¼ å…¥ä¸€ä¸ªå‡½æ•° (Scala ç¼–è¯‘å™¨è‡ªåŠ¨æŠŠæˆ‘ä»¬çš„æ–¹æ³•è½¬æ¢ä¸ºå‡½æ•°ï¼‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">timesTwo</span></span>(i: <span class="type">Int</span>): <span class="type">Int</span> = i * <span class="number">2</span></span><br><span class="line">timesTwo: (i: <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line">scala&gt; numbers.map(timesTwo)</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><h3 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h3><p><code>foreach</code> å¾ˆåƒ mapï¼Œä½†<code>æ²¡æœ‰è¿”å›å€¼</code>ã€‚foreach ä»…ç”¨äºæœ‰å‰¯ä½œç”¨ <code>side-effects</code> çš„å‡½æ•°ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.foreach((i: <span class="type">Int</span>) =&gt; i * <span class="number">2</span>)</span><br><span class="line"><span class="comment">// ä»€ä¹ˆä¹Ÿæ²¡æœ‰è¿”å›ã€‚</span></span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥å°è¯•å­˜å‚¨è¿”å›å€¼ï¼Œä½†å®ƒä¼šæ˜¯ <code>Unit</code> ç±»å‹ï¼ˆå³ voidï¼‰</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> doubled = numbers.foreach((i: <span class="type">Int</span>) =&gt; i * <span class="number">2</span>)</span><br><span class="line">doubled: <span class="type">Unit</span> = ()</span><br></pre></td></tr></table></figure><h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p><code>filter</code> ç§»é™¤ä»»ä½•å¯¹ä¼ å…¥å‡½æ•°è®¡ç®—ç»“æœä¸º <code>false</code> çš„å…ƒç´ ã€‚è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°é€šå¸¸è¢«ç§°ä¸º<code>è°“è¯å‡½æ•°</code> ï¼ˆæˆ–åˆ¤å®šå‡½æ•°ï¼‰ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.filter((i: <span class="type">Int</span>) =&gt; i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">isEven</span></span>(i: <span class="type">Int</span>): <span class="type">Boolean</span> = i % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line">isEven: (i: <span class="type">Int</span>)<span class="type">Boolean</span></span><br><span class="line"></span><br><span class="line">scala&gt; numbers.filter(isEven)</span><br><span class="line">res2: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p><code>zip</code> å°†ä¸¤ä¸ªåˆ—è¡¨çš„å†…å®¹èšåˆåˆ°ä¸€ä¸ª<code>å¯¹å¶åˆ—è¡¨</code>ä¸­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).zip(<span class="type">List</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>))</span><br><span class="line">res0: <span class="type">List</span>[(<span class="type">Int</span>, <span class="type">String</span>)] = <span class="type">List</span>((<span class="number">1</span>,a), (<span class="number">2</span>,b), (<span class="number">3</span>,c))</span><br></pre></td></tr></table></figure><h3 id="partition"><a href="#partition" class="headerlink" title="partition"></a>partition</h3><p><code>partition</code> å°†ä½¿ç”¨ç»™å®šçš„è°“è¯å‡½æ•°åˆ†å‰²åˆ—è¡¨ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numbers = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br><span class="line">scala&gt; numbers.partition(_ % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">res0: (<span class="type">List</span>[<span class="type">Int</span>], <span class="type">List</span>[<span class="type">Int</span>]) = (<span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>),<span class="type">List</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>))</span><br></pre></td></tr></table></figure><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p><code>find</code> è¿”å›é›†åˆä¸­ç¬¬ä¸€ä¸ªåŒ¹é…è°“è¯å‡½æ•°çš„å…ƒç´ ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.find((i: <span class="type">Int</span>) =&gt; i &gt; <span class="number">5</span>)</span><br><span class="line">res0: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">Some</span>(<span class="number">6</span>)</span><br></pre></td></tr></table></figure><h3 id="drop-amp-dropWhile"><a href="#drop-amp-dropWhile" class="headerlink" title="drop &amp; dropWhile"></a>drop &amp; dropWhile</h3><p><code>drop</code> å°†åˆ é™¤<code>å‰ i</code> ä¸ªå…ƒç´ </p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.drop(<span class="number">5</span>)</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><code>dropWhile</code> å°†åˆ é™¤åŒ¹é…è°“è¯å‡½æ•°çš„<code>ç¬¬ä¸€ä¸ª</code>å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ numbers åˆ—è¡¨ä¸Šä½¿ç”¨ dropWhile å‡½æ•°æ¥å»é™¤å¥‡æ•°ï¼Œ1 å°†è¢«ä¸¢å¼ƒï¼ˆä½† 3 ä¸ä¼šè¢«ä¸¢å¼ƒï¼Œå› ä¸ºä»–è¢« 2 ä¿æŠ¤äº†ï¼‰ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.dropWhile(_ % <span class="number">2</span> != <span class="number">0</span>)</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="foldLeft"><a href="#foldLeft" class="headerlink" title="foldLeft"></a>foldLeft</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.foldLeft(<span class="number">0</span>)((m: <span class="type">Int</span>, n: <span class="type">Int</span>) =&gt; m + n)</span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">55</span></span><br></pre></td></tr></table></figure><p>0 ä¸ºåˆå§‹å€¼ï¼ˆè®°ä½ numbers æ˜¯ List[Int] ç±»å‹ï¼‰ï¼Œm ä½œä¸ºä¸€ä¸ªç´¯åŠ å™¨ã€‚åœ¨æ ‡å‡†åº“çš„å®ç°ä¸ºï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foldLeft</span></span>[<span class="type">B</span>](z: <span class="type">B</span>)(op: (<span class="type">B</span>, <span class="type">A</span>) =&gt; <span class="type">B</span>): <span class="type">B</span> = &#123;</span><br><span class="line">    <span class="keyword">var</span> result = z</span><br><span class="line">    <span class="keyword">this</span>.seq foreach (x =&gt; result = op(result, x))</span><br><span class="line">    result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯è§†åŒ–è§‚å¯Ÿè¿è¡Œè¿‡ç¨‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.foldLeft(<span class="number">0</span>) &#123; (m: <span class="type">Int</span>, n: <span class="type">Int</span>) =&gt; println(<span class="string">"m: "</span> + m + <span class="string">" n: "</span> + n); m + n &#125;</span><br><span class="line">m: <span class="number">0</span> n: <span class="number">1</span></span><br><span class="line">m: <span class="number">1</span> n: <span class="number">2</span></span><br><span class="line">m: <span class="number">3</span> n: <span class="number">3</span></span><br><span class="line">m: <span class="number">6</span> n: <span class="number">4</span></span><br><span class="line">m: <span class="number">10</span> n: <span class="number">5</span></span><br><span class="line">m: <span class="number">15</span> n: <span class="number">6</span></span><br><span class="line">m: <span class="number">21</span> n: <span class="number">7</span></span><br><span class="line">m: <span class="number">28</span> n: <span class="number">8</span></span><br><span class="line">m: <span class="number">36</span> n: <span class="number">9</span></span><br><span class="line">m: <span class="number">45</span> n: <span class="number">10</span></span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">55</span></span><br></pre></td></tr></table></figure><h3 id="foldRight"><a href="#foldRight" class="headerlink" title="foldRight"></a>foldRight</h3><p>å’Œ foldLeft ä¸€æ ·ï¼Œåªæ˜¯è¿è¡Œè¿‡ç¨‹ç›¸åã€‚åœ¨æ ‡å‡†åº“çš„å®ç°ä¸ºï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foldRight</span></span>[<span class="type">B</span>](z: <span class="type">B</span>)(op: (<span class="type">A</span>, <span class="type">B</span>) =&gt; <span class="type">B</span>): <span class="type">B</span> =</span><br><span class="line">    reversed.foldLeft(z)((x, y) =&gt; op(y, x))</span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; numbers.foldRight(<span class="number">0</span>) &#123; (m: <span class="type">Int</span>, n: <span class="type">Int</span>) =&gt; println(<span class="string">"m: "</span> + m + <span class="string">" n: "</span> + n); m + n &#125;</span><br><span class="line">m: <span class="number">10</span> n: <span class="number">0</span></span><br><span class="line">m: <span class="number">9</span> n: <span class="number">10</span></span><br><span class="line">m: <span class="number">8</span> n: <span class="number">19</span></span><br><span class="line">m: <span class="number">7</span> n: <span class="number">27</span></span><br><span class="line">m: <span class="number">6</span> n: <span class="number">34</span></span><br><span class="line">m: <span class="number">5</span> n: <span class="number">40</span></span><br><span class="line">m: <span class="number">4</span> n: <span class="number">45</span></span><br><span class="line">m: <span class="number">3</span> n: <span class="number">49</span></span><br><span class="line">m: <span class="number">2</span> n: <span class="number">52</span></span><br><span class="line">m: <span class="number">1</span> n: <span class="number">54</span></span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">55</span></span><br></pre></td></tr></table></figure><h3 id="flatten"><a href="#flatten" class="headerlink" title="flatten"></a>flatten</h3><p><code>flatten</code> å°†åµŒå¥—ç»“æ„æ‰å¹³åŒ–ä¸€ä¸ªå±‚çº§ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="type">List</span>(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="type">List</span>(<span class="number">3</span>, <span class="number">4</span>)).flatten</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p><code>flatMap</code> æ˜¯ä¸€ç§å¸¸ç”¨çš„ç»„åˆå­ï¼Œç»“åˆæ˜ å°„ <code>mapping</code> å’Œæ‰å¹³åŒ– <code>flattening</code>ã€‚ <code>flatMap</code> éœ€è¦ä¸€ä¸ªå¤„ç†åµŒå¥—åˆ—è¡¨çš„å‡½æ•°ï¼Œç„¶åå°†ç»“æœä¸²è¿èµ·æ¥ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> nestedNumbers = <span class="type">List</span>(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="type">List</span>(<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">nestedNumbers: <span class="type">List</span>[<span class="type">List</span>[<span class="type">Int</span>]] = <span class="type">List</span>(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>), <span class="type">List</span>(<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">scala&gt; nestedNumbers.flatMap(x =&gt; x.map(_ * <span class="number">2</span>))</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯â€œå…ˆæ˜ å°„åæ‰å¹³åŒ–â€çš„å¿«æ·æ“ä½œï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; nestedNumbers.map((x: <span class="type">List</span>[<span class="type">Int</span>]) =&gt; x.map(_ * <span class="number">2</span>)).flatten</span><br><span class="line">res1: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å…ˆè°ƒç”¨ <code>map</code>ï¼Œç„¶åè°ƒç”¨ <code>flatten</code>ï¼Œè¿™å°±æ˜¯ <code>ç»„åˆå­</code> çš„ç‰¹å¾ï¼Œä¹Ÿæ˜¯è¿™äº›å‡½æ•°çš„æœ¬è´¨ã€‚</p><p>å‚è€ƒ Effective Scala å¯¹ <a href="https://twitter.github.com/effectivescala/#Functional%20programming-%60flatMap%60" target="_blank" rel="noopener">flatMap</a> çš„æ„è§ã€‚</p><h2 id="æ‰©å±•å‡½æ•°ç»„åˆå­"><a href="#æ‰©å±•å‡½æ•°ç»„åˆå­" class="headerlink" title="æ‰©å±•å‡½æ•°ç»„åˆå­"></a>æ‰©å±•å‡½æ•°ç»„åˆå­</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å­¦è¿‡é›†åˆä¸Šçš„ä¸€äº›å‡½æ•°ã€‚</p><p>æˆ‘ä»¬å°†å°è¯•å†™è‡ªå·±çš„å‡½æ•°ç»„åˆå­ã€‚</p><p>æœ‰è¶£çš„æ˜¯ï¼Œä¸Šé¢æ‰€å±•ç¤ºçš„æ¯ä¸€ä¸ªå‡½æ•°ç»„åˆå­éƒ½å¯ä»¥ç”¨ fold æ–¹æ³•å®ç°ã€‚è®©æˆ‘ä»¬çœ‹ä¸€äº›ä¾‹å­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ourMap</span></span>(numbers: <span class="type">List</span>[<span class="type">Int</span>], fn: <span class="type">Int</span> =&gt; <span class="type">Int</span>): <span class="type">List</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">  numbers.foldRight(<span class="type">List</span>[<span class="type">Int</span>]()) &#123; (x: <span class="type">Int</span>, xs: <span class="type">List</span>[<span class="type">Int</span>]) =&gt;</span><br><span class="line">    fn(x) :: xs <span class="comment">// ä¸¤ä¸ªå†’å·è¡¨ç¤ºæ™®é€šå…ƒç´ ä¸ List çš„è¿æ¥æ“ä½œ</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scala&gt; ourMap(numbers, timesTwo(_))</span><br><span class="line">res0: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">20</span>)</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆæ˜¯ <code>List[Int]()</code>ï¼ŸScala æ²¡æœ‰èªæ˜åˆ°ç†è§£ä½ çš„ç›®çš„æ˜¯å°†ç»“æœç§¯èšåœ¨ä¸€ä¸ªç©ºçš„ Int ç±»å‹çš„åˆ—è¡¨ä¸­ã€‚</p><h3 id="Map"><a href="#Map" class="headerlink" title="Map?"></a>Map?</h3><p>æ‰€æœ‰å±•ç¤ºçš„å‡½æ•°ç»„åˆå­éƒ½å¯ä»¥åœ¨ Map ä¸Šä½¿ç”¨ã€‚Map å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªäºŒå…ƒç»„çš„åˆ—è¡¨ï¼Œæ‰€ä»¥ä½ å†™çš„å‡½æ•°è¦å¤„ç†ä¸€ä¸ªé”®å’Œå€¼çš„äºŒå…ƒç»„ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> extensions = <span class="type">Map</span>(<span class="string">"steve"</span> -&gt; <span class="number">100</span>, <span class="string">"bob"</span> -&gt; <span class="number">101</span>, <span class="string">"joe"</span> -&gt; <span class="number">201</span>)</span><br><span class="line">extensions: scala.collection.immutable.<span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>((steve,<span class="number">100</span>), (bob,<span class="number">101</span>), (joe,<span class="number">201</span>))</span><br></pre></td></tr></table></figure><p>ç°åœ¨ç­›é€‰å‡ºç”µè¯åˆ†æœºå·ç ä½äº 200 çš„æ¡ç›®ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; extensions.filter((namePhone: (<span class="type">String</span>, <span class="type">Int</span>)) =&gt; namePhone._2 &lt; <span class="number">200</span>)</span><br><span class="line">res0: scala.collection.immutable.<span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>((steve,<span class="number">100</span>), (bob,<span class="number">101</span>))</span><br></pre></td></tr></table></figure><p>å› ä¸ºå‚æ•°æ˜¯å…ƒç»„ï¼Œæ‰€ä»¥ä½ å¿…é¡»ä½¿ç”¨ä½ç½®è·å–å™¨æ¥è¯»å–å®ƒä»¬çš„é”®å’Œå€¼ã€‚å‘ƒï¼</p><p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ›´ä¼˜é›…åœ°æå–é”®å’Œå€¼ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; extensions.filter(&#123;<span class="keyword">case</span> (name, extension) =&gt; extension &lt; <span class="number">200</span>&#125;)</span><br><span class="line">res0: scala.collection.immutable.<span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>((steve,<span class="number">100</span>), (bob,<span class="number">101</span>))</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™ä¸ªä»£ç å¯ä»¥å·¥ä½œï¼Ÿä¸ºä»€ä¹ˆä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªéƒ¨åˆ†æ¨¡å¼åŒ¹é…ï¼Ÿ<a href="/2019/12/01/scala-school-pattern-matching-and-functional-composition/">ä¸‹ä¸€ç« </a>å°†æ­æ™“ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;åŸºæœ¬æ•°æ®ç»“æ„&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ•°æ®ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬æ•°æ®ç»“æ„&quot;&gt;&lt;/a&gt;åŸºæœ¬æ•°æ®ç»“æ„&lt;/h2&gt;&lt;p&gt;Scala æä¾›äº†ä¸€äº›ä¸é”™çš„é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;å‚è€ƒ Effective Scala å¯¹æ€æ ·ä½¿ç”¨é›†åˆçš„è§‚ç‚¹
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Scala è¯¾å ‚ - åŸºç¡€ï¼ˆç»­ï¼‰</title>
    <link href="https://razertory.me/2019/11/30/scala-school-bascis2/"/>
    <id>https://razertory.me/2019/11/30/scala-school-bascis2/</id>
    <published>2019-11-30T14:20:10.000Z</published>
    <updated>2020-05-04T07:02:32.099Z</updated>
    
    <content type="html"><![CDATA[<h3 id="apply-æ–¹æ³•"><a href="#apply-æ–¹æ³•" class="headerlink" title="apply æ–¹æ³•"></a>apply æ–¹æ³•</h3><p>å½“ç±»æˆ–å¯¹è±¡æœ‰ä¸€ä¸ªä¸»è¦ç”¨é€”çš„æ—¶å€™ï¼Œ<code>apply</code> æ–¹æ³•ä¸ºä½ æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è¯­æ³•ç³–ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;&#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">object</span> <span class="title">FooMaker</span> </span>&#123;</span><br><span class="line">     |   <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>() = <span class="keyword">new</span> <span class="type">Foo</span></span><br><span class="line">     | &#125;</span><br><span class="line">defined module <span class="type">FooMaker</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> newFoo = <span class="type">FooMaker</span>()</span><br><span class="line">newFoo: <span class="type">Foo</span> = <span class="type">Foo</span>@<span class="number">5</span>b83f762</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">     |   <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>() = <span class="number">0</span></span><br><span class="line">     | &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">Bar</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">bar</span> </span>= <span class="keyword">new</span> <span class="type">Bar</span></span><br><span class="line">bar: <span class="type">Bar</span> = <span class="type">Bar</span>@<span class="number">47711479</span></span><br><span class="line"></span><br><span class="line">scala&gt; bar()</span><br><span class="line">res8: <span class="type">Int</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®ä¾‹åŒ–å¯¹è±¡çœ‹èµ·æ¥åƒæ˜¯åœ¨è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ã€‚ä»¥åä¼šæœ‰æ›´å¤šä»‹ç»ï¼</p><h3 id="å•ä¾‹å¯¹è±¡-object"><a href="#å•ä¾‹å¯¹è±¡-object" class="headerlink" title="å•ä¾‹å¯¹è±¡ (object)"></a>å•ä¾‹å¯¹è±¡ (object)</h3><p>å•ä¾‹å¯¹è±¡ç”¨äºæŒæœ‰ä¸€ä¸ªç±»çš„å”¯ä¸€å®ä¾‹ã€‚é€šå¸¸ç”¨äº <a href="https://www.runoob.com/design-pattern/factory-pattern.html" target="_blank" rel="noopener">å·¥å‚æ¨¡å¼</a>ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Timer</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">currentCount</span></span>(): <span class="type">Long</span> = &#123;</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    count</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="type">Timer</span>.currentCount()</span><br><span class="line">res0: <span class="type">Long</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å•ä¾‹å¯¹è±¡å¯ä»¥å’Œç±»å…·æœ‰ç›¸åŒçš„åç§°ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡ä¹Ÿè¢«ç§°ä¸º<code>ä¼´ç”Ÿå¯¹è±¡</code>ã€‚æˆ‘ä»¬é€šå¸¸å°†ä¼´ç”Ÿå¯¹è±¡ä½œä¸ºå·¥å‚ä½¿ç”¨ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¯ä»¥ä¸éœ€è¦ä½¿ç”¨ <code>new</code> æ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹äº†ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span>(<span class="params">foo: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">object</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(foo: <span class="type">String</span>) = <span class="keyword">new</span> <span class="type">Bar</span>(foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°å³å¯¹è±¡"><a href="#å‡½æ•°å³å¯¹è±¡" class="headerlink" title="å‡½æ•°å³å¯¹è±¡"></a>å‡½æ•°å³å¯¹è±¡</h3><p> Scala ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è°ˆè®ºå¯¹è±¡çš„å‡½æ•°å¼ç¼–ç¨‹ã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿåˆ°åº•ä»€ä¹ˆæ˜¯å‡½æ•°å‘¢ï¼Ÿ</p><p>å‡½æ•°æ˜¯ä¸€äº›ç‰¹è´¨çš„é›†åˆã€‚å…·ä½“æ¥è¯´ï¼Œå…·æœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°æ˜¯ Function1 trait çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™ä¸ª trait å®šä¹‰äº† <code>apply</code> è¯­æ³•ç³–ï¼Œè®©ä½ è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶å°±åƒä½ åœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚ï¼ˆå…³äº Function1 trait åœ¨ Scala API doc ä¸­æœ‰è¯¦ç»†ä»‹ç»  <a href="https://www.scala-lang.org/api/2.7.5/scala/Function1.html" target="_blank" rel="noopener">https://www.scala-lang.org/api/2.7.5/scala/Function1.html</a> )</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">object</span> <span class="title">addOne</span> <span class="keyword">extends</span> <span class="title">Function1</span>[<span class="type">Int</span>, <span class="type">Int</span>] </span>&#123;</span><br><span class="line">     |   <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(m: <span class="type">Int</span>): <span class="type">Int</span> = m + <span class="number">1</span></span><br><span class="line">     | &#125;</span><br><span class="line">defined module addOne</span><br><span class="line"></span><br><span class="line">scala&gt; addOne(<span class="number">1</span>)</span><br><span class="line">res2: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ª Function trait é›†åˆä¸‹æ ‡ä» 0 å¼€å§‹ä¸€ç›´åˆ° 22ã€‚ä¸ºä»€ä¹ˆæ˜¯ 22ï¼Ÿè¿™æ˜¯ä¸€ä¸ªä¸»è§‚çš„é­”å¹»æ•°å­— (magic number)ã€‚æˆ‘ä»æ¥æ²¡æœ‰ä½¿ç”¨è¿‡å¤šäº 22 ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªæ•°å­—ä¼¼ä¹æ˜¯åˆç†çš„ã€‚ï¼ˆåœ¨ Scala )</p><p><code>apply</code> è¯­æ³•ç³–æœ‰åŠ©äºç»Ÿä¸€å¯¹è±¡å’Œå‡½æ•°å¼ç¼–ç¨‹çš„äºŒé‡æ€§ã€‚ä½ å¯ä»¥ä¼ é€’ç±»ï¼Œå¹¶æŠŠå®ƒä»¬å½“åšå‡½æ•°ä½¿ç”¨ï¼Œè€Œå‡½æ•°æœ¬è´¨ä¸Šæ˜¯ç±»çš„å®ä¾‹ã€‚</p><p>è¿™æ˜¯å¦æ„å‘³ç€ï¼Œå½“ä½ åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå¾—åˆ°çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ª Function *çš„å®ä¾‹ï¼Ÿä¸æ˜¯çš„ï¼Œåœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•æ˜¯æ–¹æ³•è€Œä¸æ˜¯å‡½æ•°ã€‚åœ¨ repl ä¸­ç‹¬ç«‹å®šä¹‰çš„æ–¹æ³•æ˜¯ Function *çš„å®ä¾‹ã€‚</p><p>ç±»ä¹Ÿå¯ä»¥æ‰©å±• Functionï¼Œè¿™äº›ç±»çš„å®ä¾‹å¯ä»¥ä½¿ç”¨ <code>()</code> è°ƒç”¨ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">class</span> <span class="title">AddOne</span> <span class="keyword">extends</span> <span class="title">Function1</span>[<span class="type">Int</span>, <span class="type">Int</span>] </span>&#123;</span><br><span class="line">     |   <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(m: <span class="type">Int</span>): <span class="type">Int</span> = m + <span class="number">1</span></span><br><span class="line">     | &#125;</span><br><span class="line">defined <span class="class"><span class="keyword">class</span> <span class="title">AddOne</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">plusOne</span> </span>= <span class="keyword">new</span> <span class="type">AddOne</span>()</span><br><span class="line">plusOne: <span class="type">AddOne</span> = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; plusOne(<span class="number">1</span>)</span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨æ›´ç›´è§‚å¿«æ·çš„ <code>extends (Int =&gt; Int)</code> ä»£æ›¿ extends Function1[Int, Int]</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddOne</span> <span class="keyword">extends</span> (<span class="params"><span class="type">Int</span> =&gt; <span class="type">Int</span></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(m: <span class="type">Int</span>): <span class="type">Int</span> = m + <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒ…-package"><a href="#åŒ…-package" class="headerlink" title="åŒ… (package)"></a>åŒ… (package)</h3><p>ä½ å¯ä»¥å°†ä»£ç ç»„ç»‡åœ¨åŒ…é‡Œã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.twitter.example</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶å¤´éƒ¨å®šä¹‰åŒ…ï¼Œä¼šå°†æ–‡ä»¶ä¸­æ‰€æœ‰çš„ä»£ç å£°æ˜åœ¨é‚£ä¸ªåŒ…ä¸­ã€‚</p><p>å€¼å’Œå‡½æ•°ä¸èƒ½åœ¨ç±»æˆ–å•ä¾‹å¯¹è±¡ä¹‹å¤–å®šä¹‰ã€‚å•ä¾‹å¯¹è±¡æ˜¯ç»„ç»‡é™æ€å‡½æ•° <code>static function</code> çš„æœ‰æ•ˆå·¥å…·ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.twitter.example</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">colorHolder</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> <span class="type">BLUE</span> = <span class="string">"Blue"</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">RED</span> = <span class="string">"Red"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ä½ å¯ä»¥ç›´æ¥è®¿é—®è¿™äº›æˆå‘˜</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">println(<span class="string">"the color is: "</span> + com.twitter.example.colorHolder.<span class="type">BLUE</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„åœ¨ä½ å®šä¹‰è¿™ä¸ªå¯¹è±¡æ—¶ Scala è§£é‡Šå™¨çš„è¿”å›ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="class"><span class="keyword">object</span> <span class="title">colorHolder</span> </span>&#123;</span><br><span class="line">     |   <span class="keyword">val</span> <span class="type">Blue</span> = <span class="string">"Blue"</span></span><br><span class="line">     |   <span class="keyword">val</span> <span class="type">Red</span> = <span class="string">"Red"</span></span><br><span class="line">     | &#125;</span><br><span class="line">defined module colorHolder</span><br></pre></td></tr></table></figure><p>è¿™æš—ç¤ºäº† Scala çš„è®¾è®¡è€…æ˜¯æŠŠå¯¹è±¡ä½œä¸º Scala çš„<a href="https://www.scala-lang.org/docu/files/skeb-slides.pdf" target="_blank" rel="noopener">æ¨¡å—ç³»ç»Ÿ</a>çš„ä¸€éƒ¨åˆ†è¿›è¡Œè®¾è®¡çš„ã€‚</p><h3 id="æ¨¡å¼åŒ¹é…"><a href="#æ¨¡å¼åŒ¹é…" class="headerlink" title="æ¨¡å¼åŒ¹é…"></a>æ¨¡å¼åŒ¹é…</h3><p>è¿™æ˜¯ Scala ä¸­æœ€æœ‰ç”¨çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚</p><p>åŒ¹é…å€¼</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> times = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">times <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span> =&gt; <span class="string">"one"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span> =&gt; <span class="string">"two"</span></span><br><span class="line">  <span class="keyword">case</span> _ =&gt; <span class="string">"some other number"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å®ˆå«è¿›è¡ŒåŒ¹é…</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">times <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> i <span class="keyword">if</span> i == <span class="number">1</span> =&gt; <span class="string">"one"</span></span><br><span class="line">  <span class="keyword">case</span> i <span class="keyword">if</span> i == <span class="number">2</span> =&gt; <span class="string">"two"</span></span><br><span class="line">  <span class="keyword">case</span> _ =&gt; <span class="string">"some other number"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„æˆ‘ä»¬æ˜¯æ€æ ·è·å–å˜é‡ <code>i</code> çš„å€¼çš„ã€‚</p><p>åœ¨æœ€åä¸€è¡ŒæŒ‡ä»¤ä¸­çš„<code>_</code>æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼›å®ƒä¿è¯äº†æˆ‘ä»¬å¯ä»¥å¤„ç†æ‰€æœ‰çš„æƒ…å†µã€‚ (æ³¨æ„ç¬¬ä¸€ç« æåˆ°çš„ <code>_</code> åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­æœ‰ä¸åŒå«ä¹‰)<br>å¦åˆ™å½“ä¼ è¿›ä¸€ä¸ªä¸èƒ½è¢«åŒ¹é…çš„æ•°å­—çš„æ—¶å€™ï¼Œä½ å°†è·å¾—ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚æˆ‘ä»¬ä»¥åä¼šç»§ç»­è®¨è®ºè¿™ä¸ªè¯é¢˜çš„ã€‚</p><p>å‚è€ƒ Effective Scala å¯¹<a href="https://twitter.github.com/effectivescala/#Functional%20programming-Pattern%20matching" target="_blank" rel="noopener">ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¨¡å¼åŒ¹é…</a>å’Œ<a href="https://twitter.github.com/effectivescala/#Formatting-Pattern%20matching" target="_blank" rel="noopener">æ¨¡å¼åŒ¹é…æ ¼å¼åŒ–çš„å»ºè®®</a>ã€‚A Tour of Scala ä¹Ÿæè¿°äº†<a href="https://www.scala-lang.org/node/120" target="_blank" rel="noopener">æ¨¡å¼åŒ¹é…</a></p><h3 id="åŒ¹é…ç±»å‹"><a href="#åŒ¹é…ç±»å‹" class="headerlink" title="åŒ¹é…ç±»å‹"></a>åŒ¹é…ç±»å‹</h3><p>ä½ å¯ä»¥ä½¿ç”¨ <code>match</code> æ¥åˆ†åˆ«å¤„ç†ä¸åŒç±»å‹çš„å€¼ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bigger</span></span>(o: <span class="type">Any</span>): <span class="type">Any</span> = &#123;</span><br><span class="line">  o <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> i: <span class="type">Int</span> <span class="keyword">if</span> i &lt; <span class="number">0</span> =&gt; i - <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> i: <span class="type">Int</span> =&gt; i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> d: <span class="type">Double</span> <span class="keyword">if</span> d &lt; <span class="number">0.0</span> =&gt; d - <span class="number">0.1</span></span><br><span class="line">    <span class="keyword">case</span> d: <span class="type">Double</span> =&gt; d + <span class="number">0.1</span></span><br><span class="line">    <span class="keyword">case</span> text: <span class="type">String</span> =&gt; text + <span class="string">"s"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒ¹é…ç±»æˆå‘˜"><a href="#åŒ¹é…ç±»æˆå‘˜" class="headerlink" title="åŒ¹é…ç±»æˆå‘˜"></a>åŒ¹é…ç±»æˆå‘˜</h3><p>è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰çš„è®¡ç®—å™¨å—ã€‚</p><p>è®©æˆ‘ä»¬é€šè¿‡ç±»å‹å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ã€‚</p><p>ä¸€å¼€å§‹ä¼šå¾ˆç—›è‹¦ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcType</span></span>(calc: <span class="type">Calculator</span>) = calc <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> _ <span class="keyword">if</span> calc.brand == <span class="string">"HP"</span> &amp;&amp; calc.model == <span class="string">"20B"</span> =&gt; <span class="string">"financial"</span></span><br><span class="line">  <span class="keyword">case</span> _ <span class="keyword">if</span> calc.brand == <span class="string">"HP"</span> &amp;&amp; calc.model == <span class="string">"48G"</span> =&gt; <span class="string">"scientific"</span></span><br><span class="line">  <span class="keyword">case</span> _ <span class="keyword">if</span> calc.brand == <span class="string">"HP"</span> &amp;&amp; calc.model == <span class="string">"30B"</span> =&gt; <span class="string">"business"</span></span><br><span class="line">  <span class="keyword">case</span> _ =&gt; <span class="string">"unknown"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(âŠ™oâŠ™) å“¦ï¼Œå¤ªç—›è‹¦äº†ã€‚å¹¸å¥½ Scala æä¾›äº†ä¸€äº›åº”å¯¹è¿™ç§æƒ…å†µçš„æœ‰æ•ˆå·¥å…·ã€‚</p><p><strong>æ ·æœ¬ç±» (Case Classes)</strong><br>ä½¿ç”¨æ ·æœ¬ç±»å¯ä»¥æ–¹ä¾¿æå‰å‡†å¤‡å¥½éœ€è¦è¿›è¡ŒåŒ¹é…ç±»å†…å®¹ï¼Œå¹¶ä¸”ä¸ç”¨ new å…³é”®å­—å°±å¯ä»¥åˆ›å»ºå®ƒä»¬ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Calculator</span>(<span class="params">brand: <span class="type">String</span>, model: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"><span class="title">defined</span> <span class="title">class</span> <span class="title">Calculator</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">scala&gt;</span> <span class="title">val</span> <span class="title">hp20b</span> </span>= <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20b"</span>)</span><br><span class="line">hp20b: <span class="type">Calculator</span> = <span class="type">Calculator</span>(hp,<span class="number">20</span>b)</span><br></pre></td></tr></table></figure><p>æ ·æœ¬ç±»åŸºäºæ„é€ å‡½æ•°çš„å‚æ•°ï¼Œè‡ªåŠ¨åœ°å®ç°äº†ç›¸ç­‰æ€§å’Œæ˜“è¯»çš„ toString æ–¹æ³•ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> hp20b = <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20b"</span>)</span><br><span class="line">hp20b: <span class="type">Calculator</span> = <span class="type">Calculator</span>(hp,<span class="number">20</span>b)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> hp20B = <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20b"</span>)</span><br><span class="line">hp20B: <span class="type">Calculator</span> = <span class="type">Calculator</span>(hp,<span class="number">20</span>b)</span><br><span class="line"></span><br><span class="line">scala&gt; hp20b == hp20B</span><br><span class="line">res6: <span class="type">Boolean</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æ ·æœ¬ç±»ä¹Ÿå¯ä»¥åƒæ™®é€šç±»é‚£æ ·æ‹¥æœ‰æ–¹æ³•ã€‚</p><p>ä½¿ç”¨æ ·æœ¬ç±»è¿›è¡Œæ¨¡å¼åŒ¹é…<br>æ ·æœ¬ç±»å°±æ˜¯è¢«è®¾è®¡ç”¨åœ¨æ¨¡å¼åŒ¹é…ä¸­çš„ã€‚è®©æˆ‘ä»¬ç®€åŒ–ä¹‹å‰çš„è®¡ç®—å™¨åˆ†ç±»å™¨çš„ä¾‹å­ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> hp20b = <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20B"</span>)</span><br><span class="line"><span class="keyword">val</span> hp30b = <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"30B"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcType</span></span>(calc: <span class="type">Calculator</span>) = calc <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20B"</span>) =&gt; <span class="string">"financial"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"48G"</span>) =&gt; <span class="string">"scientific"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"30B"</span>) =&gt; <span class="string">"business"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(ourBrand, ourModel) =&gt; <span class="string">"Calculator: %s %s is of unknown type"</span>.format(ourBrand, ourModel)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åä¸€å¥ä¹Ÿå¯ä»¥è¿™æ ·å†™</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="type">Calculator</span>(_, _) =&gt; <span class="string">"Calculator of unknown type"</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…æˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸å°†åŒ¹é…å¯¹è±¡æŒ‡å®šä¸º Calculator ç±»å‹</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> _ =&gt; <span class="string">"Calculator of unknown type"</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†åŒ¹é…çš„å€¼é‡æ–°å‘½åã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> c<span class="meta">@Calculator</span>(_, _) =&gt; <span class="string">"Calculator: %s of unknown type"</span>.format(c)</span><br></pre></td></tr></table></figure><h3 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h3><p>Scala ä¸­çš„å¼‚å¸¸å¯ä»¥åœ¨ <code>try-catch-finally</code> è¯­æ³•ä¸­é€šè¿‡æ¨¡å¼åŒ¹é…ä½¿ç”¨ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  remoteCalculatorService.add(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> e: <span class="type">ServerIsDownException</span> =&gt; log.error(e, <span class="string">"the remote calculator service is unavailable. should have kept your trusty HP."</span>)</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  remoteCalculatorService.close()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// try ä¹Ÿæ˜¯é¢å‘è¡¨è¾¾å¼çš„</span></span><br><span class="line"><span class="keyword">val</span> result: <span class="type">Int</span> = <span class="keyword">try</span> &#123;</span><br><span class="line">  remoteCalculatorService.add(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> e: <span class="type">ServerIsDownException</span> =&gt; &#123;</span><br><span class="line">    log.error(e, <span class="string">"the remote calculator service is unavailable. should have kept your trusty HP."</span>)</span><br><span class="line">    <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  remoteCalculatorService.close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œç¾ç¼–ç¨‹é£æ ¼çš„å±•ç¤ºï¼Œè€Œåªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œç”¨æ¥è¯´æ˜ <code>try-catch-finally</code> å’Œ Scala ä¸­å…¶ä»–å¤§éƒ¨åˆ†äº‹ç‰©ä¸€æ ·æ˜¯è¡¨è¾¾å¼ã€‚</p><p>å½“ä¸€ä¸ªå¼‚å¸¸è¢«æ•è·å¤„ç†äº†ï¼Œ<code>finally</code> å—å°†è¢«è°ƒç”¨ï¼›å®ƒä¸æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;apply-æ–¹æ³•&quot;&gt;&lt;a href=&quot;#apply-æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;apply æ–¹æ³•&quot;&gt;&lt;/a&gt;apply æ–¹æ³•&lt;/h3&gt;&lt;p&gt;å½“ç±»æˆ–å¯¹è±¡æœ‰ä¸€ä¸ªä¸»è¦ç”¨é€”çš„æ—¶å€™ï¼Œ&lt;code&gt;apply&lt;/code&gt; æ–¹æ³•ä¸ºä½ æä¾›äº†ä¸€ä¸ªå¾ˆå¥½
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Scala æ€»è§ˆ</title>
    <link href="https://razertory.me/2019/11/30/scala-overview/"/>
    <id>https://razertory.me/2019/11/30/scala-overview/</id>
    <published>2019-11-30T13:26:36.000Z</published>
    <updated>2020-05-04T07:02:57.428Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Why-Scala"><a href="#Why-Scala" class="headerlink" title="Why Scala"></a>Why Scala</h3><ul><li>JVM ç”Ÿæ€</li><li>ç®€æ´</li><li>ç±»å‹æ¨æ–­</li><li>å‡½æ•°å¼</li><li>å¤šèŒƒå¼</li><li>Actor</li></ul><blockquote><p>ä¸‹é¢çš„æ‰€æœ‰æ“ä½œéƒ½åœ¨ Scala REPL ä¸­è¿›è¡Œ</p></blockquote><h3 id="è¡¨è¾¾å¼"><a href="#è¡¨è¾¾å¼" class="headerlink" title="è¡¨è¾¾å¼"></a>è¡¨è¾¾å¼</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="number">1</span> + <span class="number">1</span></span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>res0 æ˜¯è§£é‡Šå™¨è‡ªåŠ¨åˆ›å»ºçš„å˜é‡åç§°ï¼Œç”¨æ¥æŒ‡ä»£è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœã€‚å®ƒæ˜¯ Int ç±»å‹ï¼Œå€¼ä¸º 2ã€‚æ„å‘³ç€ä½ å¯ä»¥ç»§ç»­ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; res0 + <span class="number">1</span></span><br><span class="line">res1: <span class="type">Int</span> = <span class="number">3</span></span><br></pre></td></tr></table></figure><p>Scala ä¸­ï¼ˆå‡ ä¹ï¼‰ä¸€åˆ‡éƒ½æ˜¯è¡¨è¾¾å¼ã€‚</p><h3 id="å€¼-val-å’Œå˜é‡-var"><a href="#å€¼-val-å’Œå˜é‡-var" class="headerlink" title="å€¼ (val) å’Œå˜é‡ (var)"></a>å€¼ (val) å’Œå˜é‡ (var)</h3><p>ä½ å¯ä»¥ç»™ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æœèµ·ä¸ªåå­—èµ‹æˆä¸€ä¸ªä¸å˜é‡ï¼ˆvalï¼‰ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> two = <span class="number">1</span> + <span class="number">1</span></span><br><span class="line">two: <span class="type">Int</span> = <span class="number">2</span></span><br><span class="line">scala&gt; two = <span class="number">3</span></span><br><span class="line">           ^</span><br><span class="line">       error: reassignment to <span class="keyword">val</span></span><br></pre></td></tr></table></figure><p>ä½ ä¸èƒ½æ”¹å˜è¿™ä¸ªä¸å˜é‡çš„å€¼ï¼Œä½†å¦‚æœæ˜¯ var å£°æ˜çš„å°±å¯ä»¥æ”¹å˜ã€‚</p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p><strong>ä½ å¯ä»¥ä½¿ç”¨ <code>def</code> åˆ›å»ºå‡½æ•°ã€‚</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">addOne</span></span>(m: <span class="type">Int</span>): <span class="type">Int</span> = m + <span class="number">1</span></span><br><span class="line">addOne: (m: <span class="type">Int</span>)<span class="type">Int</span></span><br></pre></td></tr></table></figure><p><strong>ä½ å¯ä»¥åˆ›å»ºåŒ¿åå‡½æ•°ã€‚</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; (x: <span class="type">Int</span>) =&gt; x + <span class="number">1</span></span><br><span class="line">res2: (<span class="type">Int</span>) =&gt; <span class="type">Int</span> = &lt;function1&gt;</span><br></pre></td></tr></table></figure><p><strong>ä½ å¯ä»¥æŠŠåŒ¿åå‡½æ•°èµ‹å€¼ç»™ valã€‚</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> addOne = (x: <span class="type">Int</span>) =&gt; x + <span class="number">1</span></span><br><span class="line">addOne: (<span class="type">Int</span>) =&gt; <span class="type">Int</span> = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; addOne(<span class="number">1</span>)</span><br><span class="line">res4: <span class="type">Int</span> = <span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>ä½ å¯ä»¥éƒ¨åˆ†åº”ç”¨ä¸€ä¸ªå‡½æ•°</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">adder</span></span>(m: <span class="type">Int</span>, n: <span class="type">Int</span>) = m + n</span><br><span class="line">adder: (m: <span class="type">Int</span>,n: <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ å¯ä»¥ã€Œéƒ¨åˆ†åº”ç”¨ã€å‚æ•°åˆ—è¡¨ä¸­çš„ä»»æ„å‚æ•°ï¼Œè€Œä¸ä»…ä»…æ˜¯æœ€åä¸€ä¸ªã€‚</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> add2 = adder(<span class="number">2</span>, _:<span class="type">Int</span>) </span><br><span class="line">add2: (<span class="type">Int</span>) =&gt; <span class="type">Int</span> = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; add2(<span class="number">3</span>)</span><br><span class="line">res50: <span class="type">Int</span> = <span class="number">5</span></span><br></pre></td></tr></table></figure><p><strong>ä½ å¯ä»¥æŸ¯é‡ŒåŒ–å‡½æ•° (Currying Function)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="function"><span class="keyword">def</span> <span class="title">multiply</span></span>(m: <span class="type">Int</span>)(n: <span class="type">Int</span>): <span class="type">Int</span> = m * n</span><br><span class="line">multiply: (m: <span class="type">Int</span>)(n: <span class="type">Int</span>)<span class="type">Int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½ å¯ä»¥ç›´æ¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ã€‚</span></span><br><span class="line">scala&gt; multiply(<span class="number">2</span>)(<span class="number">3</span>)</span><br><span class="line">res0: <span class="type">Int</span> = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½ å¯ä»¥å¡«ä¸Šç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸”éƒ¨åˆ†åº”ç”¨ç¬¬äºŒä¸ªå‚æ•°ã€‚</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> timesTwo = multiply(<span class="number">2</span>) _</span><br><span class="line">timesTwo: (<span class="type">Int</span>) =&gt; <span class="type">Int</span> = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line">scala&gt; timesTwo(<span class="number">3</span>)</span><br><span class="line">res1: <span class="type">Int</span> = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ å¯ä»¥å¯¹ä»»ä½•å¤šå‚æ•°å‡½æ•°æ‰§è¡ŒæŸ¯é‡ŒåŒ– (`.curried`)</span></span><br><span class="line">scala&gt; (adder _).curried</span><br><span class="line">res1: (<span class="type">Int</span>) =&gt; (<span class="type">Int</span>) =&gt; <span class="type">Int</span> = &lt;function1&gt;</span><br></pre></td></tr></table></figure><p><strong>ä½ å¯ä»¥å‚æ•°å¯å˜å‚æ•°å‡½æ•°</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">capitalizeAll</span></span>(args: <span class="type">String</span>*) = &#123;</span><br><span class="line">  args.map &#123; arg =&gt;</span><br><span class="line">    arg.capitalize</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scala&gt; capitalizeAll(<span class="string">"rarity"</span>, <span class="string">"applejack"</span>)</span><br><span class="line">res2: <span class="type">Seq</span>[<span class="type">String</span>] = <span class="type">ArrayBuffer</span>(<span class="type">Rarity</span>, <span class="type">Applejack</span>)</span><br></pre></td></tr></table></figure><h3 id="OOP"><a href="#OOP" class="headerlink" title="OOP"></a>OOP</h3><p>ç±»ã€ç»§æ‰¿å’Œ Java æ¯”è¾ƒç±»ä¼¼ã€‚é¢å¤–çš„ Scala è¿˜å¼•å…¥äº†</p><ul><li>traitã€‚å®ç°ç±»ä¼¼äº Rubyã€Python è¿™æ ·çš„åŠ¨æ€è¯­è¨€çš„ mix-in</li><li>object å…³é”®å­— å’Œ apply() æ–¹æ³•ã€‚æ–¹ä¾¿å®ç° single instance</li><li>case classã€‚ä¸ºæ–¹ä¾¿å­˜æ”¾å€¼å’Œæ¨¡å¼åŒ¹é…å¼•å…¥äº† </li></ul><p><strong>Trait</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// trait æ˜¯ä¸€äº›å­—æ®µå’Œè¡Œä¸ºçš„é›†åˆï¼Œå¯ä»¥æ‰©å±•æˆ–æ··å…¥ï¼ˆ`mixin`ï¼‰ä½ çš„ç±»ä¸­ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> brand: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Shiny</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> shineRefraction: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BMW</span> <span class="keyword">extends</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> brand = <span class="string">"BMW"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡ with å…³é”®å­—ï¼Œä¸€ä¸ªç±»å¯ä»¥æ‰©å±•å¤šä¸ª traitï¼š</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BMW</span> <span class="keyword">extends</span> <span class="title">Car</span> <span class="keyword">with</span> <span class="title">Shiny</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> brand = <span class="string">"BMW"</span></span><br><span class="line">  <span class="keyword">val</span> shineRefraction = <span class="number">12</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>object</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// object å®ç° single instance</span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Timer</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">currentCount</span></span>(): <span class="type">Long</span> = &#123;</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    count</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸å¿…å†ç”¨ new å…³é”®å­—</span></span><br><span class="line">scala&gt; <span class="type">Timer</span>.currentCount()</span><br><span class="line">res0: <span class="type">Long</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Companion Objec ä¼´ç”Ÿå¯¹è±¡ï¼Œç”¨æ¥ç»™ object åˆå§‹åŒ–å€¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span>(<span class="params">foo: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"><span class="title">object</span> <span class="title">Bar</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(foo: <span class="type">String</span>) = <span class="keyword">new</span> <span class="type">Bar</span>(foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>case class</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Calculator</span>(<span class="params">brand: <span class="type">String</span>, model: <span class="type">String</span></span>)</span></span><br><span class="line"><span class="class"><span class="title">def</span> <span class="title">calcType</span>(<span class="params">calc: <span class="type">Calculator</span></span>) </span>= calc <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"20B"</span>) =&gt; <span class="string">"financial"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"48G"</span>) =&gt; <span class="string">"scientific"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(<span class="string">"HP"</span>, <span class="string">"30B"</span>) =&gt; <span class="string">"business"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Calculator</span>(_, _) =&gt; <span class="string">"Calculator: %s %s is of unknown type"</span>.format(ourBrand, ourModel)</span><br><span class="line">  <span class="keyword">case</span> _ =&gt; <span class="string">"Not a calculator"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Why-Scala&quot;&gt;&lt;a href=&quot;#Why-Scala&quot; class=&quot;headerlink&quot; title=&quot;Why Scala&quot;&gt;&lt;/a&gt;Why Scala&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;JVM ç”Ÿæ€&lt;/li&gt;
&lt;li&gt;ç®€æ´&lt;/li&gt;
&lt;li&gt;ç±»å‹æ¨æ–­&lt;/li
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å®Œç¾çš„äºŒåˆ†æœç´¢</title>
    <link href="https://razertory.me/2019/11/28/binary-search/"/>
    <id>https://razertory.me/2019/11/28/binary-search/</id>
    <published>2019-11-28T14:45:06.000Z</published>
    <updated>2020-03-28T13:02:10.014Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‡è®¾ç»™ä¸€ä¸ªæœ‰åºçš„ int ç±»å‹çš„æ•°ç»„ arrï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œæ‰¾åˆ°è¿™ä¸ªç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚å¦‚æœæ•°ç»„ä¸­æ²¡æœ‰<br>target è¿”å› -1ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> start = <span class="number">0</span>, end = arr.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (start &lt;= end) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = start + (end - start) / <span class="number">2</span>; <span class="comment">// éœ€è¦æ³¨æ„ç”¨ (start + end) / 2 åœ¨æ•°å­¦ä¸Šæ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯è€ƒè™‘åˆ° start + end å¯èƒ½ä¼šæº¢å‡ºã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (target == arr[mid]) </span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (target &lt; arr[mid])</span><br><span class="line">            end = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            start + mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‡è®¾ç»™ä¸€ä¸ªæœ‰åºçš„ int ç±»å‹çš„æ•°ç»„ arrï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œæ‰¾åˆ°è¿™ä¸ªç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚å¦‚æœæ•°ç»„ä¸­æ²¡æœ‰&lt;br&gt;target è¿”å› -1ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight java
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æ±‰æ˜è·ç¦»</title>
    <link href="https://razertory.me/2019/11/17/hamming-distance/"/>
    <id>https://razertory.me/2019/11/17/hamming-distance/</id>
    <published>2019-11-17T02:46:03.000Z</published>
    <updated>2020-03-28T13:02:10.013Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„æ±‰æ˜è·ç¦»æŒ‡çš„æ˜¯è¿™ä¸¤ä¸ªæ•°å­—å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®çš„æ•°ç›®ã€‚ç»™å‡ºä¸¤ä¸ªæ•´æ•° x å’Œ yï¼Œè®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ±‰æ˜è·ç¦»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br></pre></td></tr></table></figure><p>å¯¹äº x, å’Œ y å…ˆè¿›è¡Œå¼‚æˆ–ï¼Œç„¶åå†è®¡ç®—ç»“æœä¸­çš„ 1 çš„ä¸ªæ•°å³å¯ã€‚ï¼ˆå…¶ä¸­ count ç®—æ³•æ¥è‡ª <a href="/2019/11/14/count-of-one/">äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°</a>ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hammingDistance</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = x ^ y;</span><br><span class="line">    <span class="keyword">return</span> count(n); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„æ±‰æ˜è·ç¦»æŒ‡çš„æ˜¯è¿™ä¸¤ä¸ªæ•°å­—å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®çš„æ•°ç›®ã€‚ç»™å‡ºä¸¤ä¸ªæ•´æ•° x å’Œ yï¼Œè®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ±‰æ˜è·ç¦»ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span c
      
    
    </summary>
    
    
  </entry>
  
</feed>
